<!doctype html><html itemscope itemtype=http://schema.org/WebPage lang=en class=no-js><head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><meta name=robots content="index, follow"><link rel="shortcut icon" href=/favicons/favicon.ico><link rel=apple-touch-icon href=/favicons/apple-touch-icon-180x180.png sizes=180x180><link rel=icon type=image/png href=/favicons/favicon-16x16.png sizes=16x16><link rel=icon type=image/png href=/favicons/favicon-32x32.png sizes=32x32><link rel=icon type=image/png href=/favicons/android-36x36.png sizes=36x36><link rel=icon type=image/png href=/favicons/android-48x48.png sizes=48x48><link rel=icon type=image/png href=/favicons/android-72x72.png sizes=72x72><link rel=icon type=image/png href=/favicons/android-96x96.png sizes=96x96><link rel=icon type=image/png href=/favicons/android-144x144.png sizes=144x144><link rel=icon type=image/png href=/favicons/android-192x192.png sizes=192x192><title>Upgrading | </title><meta name=description content="Upgrading to 4.1.0 Upgrading Servers to 4.1.0 from any version 3.3.x through 4.0.x Notable changes in 4.1.0 Apache Kafka 4.1 ships with a preview of Queues for Kafka (KIP-932). This feature introduces a new kind of group called share groups, as an alternative to consumer groups. Consumers in a share group cooperatively consume records from topics, without assigning each partition to just one consumer. Share groups also introduce per-record acknowledgement and counting of delivery attempts."><meta property="og:title" content="Upgrading"><meta property="og:description" content="Upgrading to 4.1.0 Upgrading Servers to 4.1.0 from any version 3.3.x through 4.0.x Notable changes in 4.1.0 Apache Kafka 4.1 ships with a preview of Queues for Kafka (KIP-932). This feature introduces a new kind of group called share groups, as an alternative to consumer groups. Consumers in a share group cooperatively consume records from topics, without assigning each partition to just one consumer. Share groups also introduce per-record acknowledgement and counting of delivery attempts."><meta property="og:type" content="article"><meta property="og:url" content="https://example.kafka-site-md.dev/41/getting-started/upgrade/"><meta property="article:section" content="41"><meta property="article:modified_time" content="2025-09-27T17:39:54-07:00"><meta itemprop=name content="Upgrading"><meta itemprop=description content="Upgrading to 4.1.0 Upgrading Servers to 4.1.0 from any version 3.3.x through 4.0.x Notable changes in 4.1.0 Apache Kafka 4.1 ships with a preview of Queues for Kafka (KIP-932). This feature introduces a new kind of group called share groups, as an alternative to consumer groups. Consumers in a share group cooperatively consume records from topics, without assigning each partition to just one consumer. Share groups also introduce per-record acknowledgement and counting of delivery attempts."><meta itemprop=dateModified content="2025-09-27T17:39:54-07:00"><meta itemprop=wordCount content="2702"><meta itemprop=keywords content="kafka,docs,"><meta name=twitter:card content="summary"><meta name=twitter:title content="Upgrading"><meta name=twitter:description content="Upgrading to 4.1.0 Upgrading Servers to 4.1.0 from any version 3.3.x through 4.0.x Notable changes in 4.1.0 Apache Kafka 4.1 ships with a preview of Queues for Kafka (KIP-932). This feature introduces a new kind of group called share groups, as an alternative to consumer groups. Consumers in a share group cooperatively consume records from topics, without assigning each partition to just one consumer. Share groups also introduce per-record acknowledgement and counting of delivery attempts."><link rel=preload href=/scss/main.min.7ed0eb3fc68a0678ca492e0db9c00f8e8d5b776bbb2fb833732191f6bbf02877.css as=style integrity="sha256-ftDrP8aKBnjKSS4NucAPjo1bd2u7L7gzcyGR9rvwKHc=" crossorigin=anonymous><link href=/scss/main.min.7ed0eb3fc68a0678ca492e0db9c00f8e8d5b776bbb2fb833732191f6bbf02877.css rel=stylesheet integrity="sha256-ftDrP8aKBnjKSS4NucAPjo1bd2u7L7gzcyGR9rvwKHc=" crossorigin=anonymous><script src=https://code.jquery.com/jquery-3.7.1.min.js integrity="sha512-v2CJ7UaYy4JwqLDIrZUI/4hqeoQieOmAZNXBeQyjo21dadnwR+8ZaIJVT8EE2iyI61OV8e6M8PP2/4hpQINQ/g==" crossorigin=anonymous></script><script defer src=https://unpkg.com/lunr@2.3.9/lunr.min.js integrity=sha384-203J0SNzyqHby3iU6hzvzltrWi/M41wOP5Gu+BiJMz5nwKykbkUx8Kp7iti0Lpli crossorigin=anonymous></script></head><body class=td-page><header><nav class="td-navbar js-navbar-scroll" data-bs-theme=dark><div class="container-fluid flex-column flex-md-row"><a class=navbar-brand href=/><span class="navbar-brand__logo navbar-logo"><svg width="154" height="250" viewBox="0 0 256 416" xmlns="http://www.w3.org/2000/svg" preserveAspectRatio="xMidYMid"><path d="M201.816 230.216c-16.186.0-30.697 7.171-40.634 18.461l-25.463-18.026c2.703-7.442 4.255-15.433 4.255-23.797.0-8.219-1.498-16.076-4.112-23.408l25.406-17.835c9.936 11.233 24.409 18.365 40.548 18.365 29.875.0 54.184-24.305 54.184-54.184.0-29.879-24.309-54.184-54.184-54.184s-54.184 24.305-54.184 54.184c0 5.348.808 10.505 2.258 15.389l-25.423 17.844c-10.62-13.175-25.911-22.374-43.333-25.182v-30.64c24.544-5.155 43.037-26.962 43.037-53.019C124.171 24.305 99.862.0 69.987.0 40.112.0 15.803 24.305 15.803 54.184c0 25.708 18.014 47.246 42.067 52.769v31.038C25.044 143.753.0 172.401.0 206.854c0 34.621 25.292 63.374 58.355 68.94v32.774c-24.299 5.341-42.552 27.011-42.552 52.894.0 29.879 24.309 54.184 54.184 54.184s54.184-24.305 54.184-54.184c0-25.883-18.253-47.553-42.552-52.894v-32.775a69.965 69.965.0 0042.6-24.776l25.633 18.143c-1.423 4.84-2.22 9.946-2.22 15.24.0 29.879 24.309 54.184 54.184 54.184S256 314.279 256 284.4c0-29.879-24.309-54.184-54.184-54.184zm0-126.695c14.487.0 26.27 11.788 26.27 26.271s-11.783 26.27-26.27 26.27-26.27-11.787-26.27-26.27 11.783-26.271 26.27-26.271zm-158.1-49.337c0-14.483 11.784-26.27 26.271-26.27s26.27 11.787 26.27 26.27c0 14.483-11.783 26.27-26.27 26.27s-26.271-11.787-26.271-26.27zm52.541 307.278c0 14.483-11.783 26.27-26.27 26.27s-26.271-11.787-26.271-26.27 11.784-26.27 26.271-26.27 26.27 11.787 26.27 26.27zm-26.272-117.97c-20.205.0-36.642-16.434-36.642-36.638.0-20.205 16.437-36.642 36.642-36.642 20.204.0 36.641 16.437 36.641 36.642.0 20.204-16.437 36.638-36.641 36.638zm131.831 67.179c-14.487.0-26.27-11.788-26.27-26.271s11.783-26.27 26.27-26.27 26.27 11.787 26.27 26.27-11.783 26.271-26.27 26.271z" style="fill:#231f20"/></svg></span><span class=navbar-brand__name></span></a><div class="td-navbar-nav-scroll ms-md-auto" id=main_navbar><ul class=navbar-nav><li class=nav-item><a class=nav-link href=/41/><span>Documentation</span></a></li><li class=nav-item><a class=nav-link href=/blog/><span>Blog</span></a></li><li class=nav-item><a class=nav-link href=/community/><span>Community</span></a></li><li class=nav-item><a class=nav-link href=/testimonials/><span>Testimonials</span></a></li><li class=nav-item><a class=nav-link href=/community/downloads/><span>Download Kafka</span></a></li><li class="nav-item dropdown d-none d-lg-block"><div class=dropdown><a class="nav-link dropdown-toggle" href=# role=button data-bs-toggle=dropdown aria-haspopup=true aria-expanded=false>Releases</a><ul class=dropdown-menu><li><a class=dropdown-item href=/41/>4.1</a></li><li><a class=dropdown-item href=/40/>4.0</a></li><li><a class=dropdown-item href=/39/>3.9</a></li><li><a class=dropdown-item href=/38/>3.8</a></li><li><a class=dropdown-item href=/37/>3.7</a></li><li><a class=dropdown-item href=/36/>3.6</a></li><li><a class=dropdown-item href=/35/>3.5</a></li><li><a class=dropdown-item href=/34/>3.4</a></li><li><a class=dropdown-item href=/33/>3.3</a></li><li><a class=dropdown-item href=/32/>3.2</a></li><li><a class=dropdown-item href=/31/>3.1</a></li><li><a class=dropdown-item href=/30/>3.0</a></li><li><a class=dropdown-item href=/28/>2.8</a></li><li><a class=dropdown-item href=/27/>2.7</a></li><li><a class=dropdown-item href=/26/>2.6</a></li><li><a class=dropdown-item href=/25/>2.5</a></li><li><a class=dropdown-item href=/24/>2.4</a></li><li><a class=dropdown-item href=/23/>2.3</a></li><li><a class=dropdown-item href=/22/>2.2</a></li><li><a class=dropdown-item href=/21/>2.1</a></li><li><a class=dropdown-item href=/20/>2.0</a></li><li><a class=dropdown-item href=/11/>1.1</a></li><li><a class=dropdown-item href=/10/>1.0</a></li><li><a class=dropdown-item href=/0110/>0.11.0</a></li><li><a class=dropdown-item href=/0102/>0.10.2</a></li><li><a class=dropdown-item href=/0101/>0.10.1</a></li><li><a class=dropdown-item href=/0100/>0.10.0</a></li><li><a class=dropdown-item href=/090/>0.9.0</a></li><li><a class=dropdown-item href=/082/>0.8.2</a></li><li><a class=dropdown-item href=/081/>0.8.1</a></li><li><a class=dropdown-item href=/080/>0.8.0</a></li><li><a class=dropdown-item href=/07/>0.7</a></li></ul></div></li></ul></div><div class="d-none d-lg-block"><div class="td-search td-search--offline"><div class=td-search__icon></div><input type=search class="td-search__input form-control" placeholder="Search this site…" aria-label="Search this site…" autocomplete=off data-offline-search-index-json-src=/offline-search-index.a770465805a0cb46ff1e57a8f55b44bc.json data-offline-search-base-href=/ data-offline-search-max-results=10></div></div></div></nav></header><div class="container-fluid td-outer"><div class=td-main><div class="row flex-xl-nowrap"><aside class="col-12 col-md-3 col-xl-2 td-sidebar d-print-none"><div id=td-sidebar-menu class=td-sidebar__inner><div id=content-mobile><form class="td-sidebar__search d-flex align-items-center"><div class="td-search td-search--offline"><div class=td-search__icon></div><input type=search class="td-search__input form-control" placeholder="Search this site…" aria-label="Search this site…" autocomplete=off data-offline-search-index-json-src=/offline-search-index.a770465805a0cb46ff1e57a8f55b44bc.json data-offline-search-base-href=/ data-offline-search-max-results=10></div><button class="btn btn-link td-sidebar__toggle d-md-none p-0 ms-3 fas fa-bars" type=button data-bs-toggle=collapse data-bs-target=#td-section-nav aria-controls=td-section-nav aria-expanded=false aria-label="Toggle section navigation"></button></form></div><div id=content-desktop></div><nav class="td-sidebar-nav collapse td-sidebar-nav--search-disabled foldable-nav" id=td-section-nav><ul class="td-sidebar-nav__section pe-md-3 ul-0"><li class="td-sidebar-nav__section-title td-sidebar-nav__section with-child active-path" id=m-41-li><a href=/41/ class="align-left ps-0 td-sidebar-link td-sidebar-link__section tree-root" id=m-41><span>AK 4.1.X</span></a><ul class=ul-1><li class="td-sidebar-nav__section-title td-sidebar-nav__section with-child active-path" id=m-41getting-started-li><input type=checkbox id=m-41getting-started-check checked>
<label for=m-41getting-started-check><a href=/41/getting-started/ class="align-left ps-0 td-sidebar-link td-sidebar-link__section" id=m-41getting-started><span>Getting Started</span></a></label><ul class="ul-2 foldable"><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-41getting-startedintroduction-li><input type=checkbox id=m-41getting-startedintroduction-check>
<label for=m-41getting-startedintroduction-check><a href=/41/getting-started/introduction/ class="align-left ps-0 td-sidebar-link td-sidebar-link__page" id=m-41getting-startedintroduction><span>Introduction</span></a></label></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-41getting-starteduses-li><input type=checkbox id=m-41getting-starteduses-check>
<label for=m-41getting-starteduses-check><a href=/41/getting-started/uses/ class="align-left ps-0 td-sidebar-link td-sidebar-link__page" id=m-41getting-starteduses><span>Use Cases</span></a></label></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-41getting-startedquickstart-li><input type=checkbox id=m-41getting-startedquickstart-check>
<label for=m-41getting-startedquickstart-check><a href=/41/getting-started/quickstart/ class="align-left ps-0 td-sidebar-link td-sidebar-link__page" id=m-41getting-startedquickstart><span>Quick Start</span></a></label></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-41getting-startedecosystem-li><input type=checkbox id=m-41getting-startedecosystem-check>
<label for=m-41getting-startedecosystem-check><a href=/41/getting-started/ecosystem/ class="align-left ps-0 td-sidebar-link td-sidebar-link__page" id=m-41getting-startedecosystem><span>Ecosystem</span></a></label></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child active-path" id=m-41getting-startedupgrade-li><input type=checkbox id=m-41getting-startedupgrade-check checked>
<label for=m-41getting-startedupgrade-check><a href=/41/getting-started/upgrade/ class="align-left ps-0 active td-sidebar-link td-sidebar-link__page" id=m-41getting-startedupgrade><span class=td-sidebar-nav-active-item>Upgrading</span></a></label></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-41getting-startedzk2kraft-li><input type=checkbox id=m-41getting-startedzk2kraft-check>
<label for=m-41getting-startedzk2kraft-check><a href=/41/getting-started/zk2kraft/ class="align-left ps-0 td-sidebar-link td-sidebar-link__page" id=m-41getting-startedzk2kraft><span>KRaft vs ZooKeeper</span></a></label></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-41getting-startedcompatibility-li><input type=checkbox id=m-41getting-startedcompatibility-check>
<label for=m-41getting-startedcompatibility-check><a href=/41/getting-started/compatibility/ class="align-left ps-0 td-sidebar-link td-sidebar-link__page" id=m-41getting-startedcompatibility><span>Compatibility</span></a></label></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-41getting-starteddocker-li><input type=checkbox id=m-41getting-starteddocker-check>
<label for=m-41getting-starteddocker-check><a href=/41/getting-started/docker/ class="align-left ps-0 td-sidebar-link td-sidebar-link__page" id=m-41getting-starteddocker><span>Docker</span></a></label></li></ul></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section with-child" id=m-41apis-li><input type=checkbox id=m-41apis-check>
<label for=m-41apis-check><a href=/41/apis/ class="align-left ps-0 td-sidebar-link td-sidebar-link__section" id=m-41apis><span>APIs</span></a></label><ul class="ul-2 foldable"><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-41apisapi-li><input type=checkbox id=m-41apisapi-check>
<label for=m-41apisapi-check><a href=/41/apis/api/ class="align-left ps-0 td-sidebar-link td-sidebar-link__page" id=m-41apisapi><span>API</span></a></label></li></ul></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section with-child" id=m-41configuration-li><input type=checkbox id=m-41configuration-check>
<label for=m-41configuration-check><a href=/41/configuration/ class="align-left ps-0 td-sidebar-link td-sidebar-link__section" id=m-41configuration><span>Configuration</span></a></label><ul class="ul-2 foldable"><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-41configurationconfiguration-li><input type=checkbox id=m-41configurationconfiguration-check>
<label for=m-41configurationconfiguration-check><a href=/41/configuration/configuration/ class="align-left ps-0 td-sidebar-link td-sidebar-link__page" id=m-41configurationconfiguration><span>Configuration</span></a></label></li></ul></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section with-child" id=m-41design-li><input type=checkbox id=m-41design-check>
<label for=m-41design-check><a href=/41/design/ class="align-left ps-0 td-sidebar-link td-sidebar-link__section" id=m-41design><span>Design</span></a></label><ul class="ul-2 foldable"><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-41designdesign-li><input type=checkbox id=m-41designdesign-check>
<label for=m-41designdesign-check><a href=/41/design/design/ class="align-left ps-0 td-sidebar-link td-sidebar-link__page" id=m-41designdesign><span>Design</span></a></label></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-41designprotocol-li><input type=checkbox id=m-41designprotocol-check>
<label for=m-41designprotocol-check><a href=/41/design/protocol/ class="align-left ps-0 td-sidebar-link td-sidebar-link__page" id=m-41designprotocol><span>Protocol</span></a></label></li></ul></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section with-child" id=m-41implementation-li><input type=checkbox id=m-41implementation-check>
<label for=m-41implementation-check><a href=/41/implementation/ class="align-left ps-0 td-sidebar-link td-sidebar-link__section" id=m-41implementation><span>Implementation</span></a></label><ul class="ul-2 foldable"><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-41implementationnetwork-layer-li><input type=checkbox id=m-41implementationnetwork-layer-check>
<label for=m-41implementationnetwork-layer-check><a href=/41/implementation/network-layer/ class="align-left ps-0 td-sidebar-link td-sidebar-link__page" id=m-41implementationnetwork-layer><span>Network Layer</span></a></label></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-41implementationmessages-li><input type=checkbox id=m-41implementationmessages-check>
<label for=m-41implementationmessages-check><a href=/41/implementation/messages/ class="align-left ps-0 td-sidebar-link td-sidebar-link__page" id=m-41implementationmessages><span>Messages</span></a></label></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-41implementationmessage-format-li><input type=checkbox id=m-41implementationmessage-format-check>
<label for=m-41implementationmessage-format-check><a href=/41/implementation/message-format/ class="align-left ps-0 td-sidebar-link td-sidebar-link__page" id=m-41implementationmessage-format><span>Message Format</span></a></label></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-41implementationlog-li><input type=checkbox id=m-41implementationlog-check>
<label for=m-41implementationlog-check><a href=/41/implementation/log/ class="align-left ps-0 td-sidebar-link td-sidebar-link__page" id=m-41implementationlog><span>Log</span></a></label></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-41implementationdistribution-li><input type=checkbox id=m-41implementationdistribution-check>
<label for=m-41implementationdistribution-check><a href=/41/implementation/distribution/ class="align-left ps-0 td-sidebar-link td-sidebar-link__page" id=m-41implementationdistribution><span>Distribution</span></a></label></li></ul></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section with-child" id=m-41operations-li><input type=checkbox id=m-41operations-check>
<label for=m-41operations-check><a href=/41/operations/ class="align-left ps-0 td-sidebar-link td-sidebar-link__section" id=m-41operations><span>Operations</span></a></label><ul class="ul-2 foldable"><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-41operationsbasic-kafka-operations-li><input type=checkbox id=m-41operationsbasic-kafka-operations-check>
<label for=m-41operationsbasic-kafka-operations-check><a href=/41/operations/basic-kafka-operations/ class="align-left ps-0 td-sidebar-link td-sidebar-link__page" id=m-41operationsbasic-kafka-operations><span>Basic Kafka Operations</span></a></label></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-41operationsdatacenters-li><input type=checkbox id=m-41operationsdatacenters-check>
<label for=m-41operationsdatacenters-check><a href=/41/operations/datacenters/ class="align-left ps-0 td-sidebar-link td-sidebar-link__page" id=m-41operationsdatacenters><span>Datacenters</span></a></label></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-41operationsgeo-replication-cross-cluster-data-mirroring-li><input type=checkbox id=m-41operationsgeo-replication-cross-cluster-data-mirroring-check>
<label for=m-41operationsgeo-replication-cross-cluster-data-mirroring-check><a href=/41/operations/geo-replication-cross-cluster-data-mirroring/ class="align-left ps-0 td-sidebar-link td-sidebar-link__page" id=m-41operationsgeo-replication-cross-cluster-data-mirroring><span>Geo-Replication (Cross-Cluster Data Mirroring)</span></a></label></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-41operationsmulti-tenancy-li><input type=checkbox id=m-41operationsmulti-tenancy-check>
<label for=m-41operationsmulti-tenancy-check><a href=/41/operations/multi-tenancy/ class="align-left ps-0 td-sidebar-link td-sidebar-link__page" id=m-41operationsmulti-tenancy><span>Multi-Tenancy</span></a></label></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-41operationsjava-version-li><input type=checkbox id=m-41operationsjava-version-check>
<label for=m-41operationsjava-version-check><a href=/41/operations/java-version/ class="align-left ps-0 td-sidebar-link td-sidebar-link__page" id=m-41operationsjava-version><span>Java Version</span></a></label></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-41operationshardware-and-os-li><input type=checkbox id=m-41operationshardware-and-os-check>
<label for=m-41operationshardware-and-os-check><a href=/41/operations/hardware-and-os/ class="align-left ps-0 td-sidebar-link td-sidebar-link__page" id=m-41operationshardware-and-os><span>Hardware and OS</span></a></label></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-41operationsmonitoring-li><input type=checkbox id=m-41operationsmonitoring-check>
<label for=m-41operationsmonitoring-check><a href=/41/operations/monitoring/ class="align-left ps-0 td-sidebar-link td-sidebar-link__page" id=m-41operationsmonitoring><span>Monitoring</span></a></label></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-41operationskraft-li><input type=checkbox id=m-41operationskraft-check>
<label for=m-41operationskraft-check><a href=/41/operations/kraft/ class="align-left ps-0 td-sidebar-link td-sidebar-link__page" id=m-41operationskraft><span>KRaft</span></a></label></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-41operationstiered-storage-li><input type=checkbox id=m-41operationstiered-storage-check>
<label for=m-41operationstiered-storage-check><a href=/41/operations/tiered-storage/ class="align-left ps-0 td-sidebar-link td-sidebar-link__page" id=m-41operationstiered-storage><span>Tiered Storage</span></a></label></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-41operationsconsumer-rebalance-protocol-li><input type=checkbox id=m-41operationsconsumer-rebalance-protocol-check>
<label for=m-41operationsconsumer-rebalance-protocol-check><a href=/41/operations/consumer-rebalance-protocol/ class="align-left ps-0 td-sidebar-link td-sidebar-link__page" id=m-41operationsconsumer-rebalance-protocol><span>Consumer Rebalance Protocol</span></a></label></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-41operationstransaction-protocol-li><input type=checkbox id=m-41operationstransaction-protocol-check>
<label for=m-41operationstransaction-protocol-check><a href=/41/operations/transaction-protocol/ class="align-left ps-0 td-sidebar-link td-sidebar-link__page" id=m-41operationstransaction-protocol><span>Transaction Protocol</span></a></label></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-41operationseligible-leader-replicas-li><input type=checkbox id=m-41operationseligible-leader-replicas-check>
<label for=m-41operationseligible-leader-replicas-check><a href=/41/operations/eligible-leader-replicas/ class="align-left ps-0 td-sidebar-link td-sidebar-link__page" id=m-41operationseligible-leader-replicas><span>Eligible Leader Replicas</span></a></label></li></ul></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section with-child" id=m-41security-li><input type=checkbox id=m-41security-check>
<label for=m-41security-check><a href=/41/security/ class="align-left ps-0 td-sidebar-link td-sidebar-link__section" id=m-41security><span>Security</span></a></label><ul class="ul-2 foldable"><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-41securitysecurity-overview-li><input type=checkbox id=m-41securitysecurity-overview-check>
<label for=m-41securitysecurity-overview-check><a href=/41/security/security-overview/ class="align-left ps-0 td-sidebar-link td-sidebar-link__page" id=m-41securitysecurity-overview><span>Security Overview</span></a></label></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-41securitylistener-configuration-li><input type=checkbox id=m-41securitylistener-configuration-check>
<label for=m-41securitylistener-configuration-check><a href=/41/security/listener-configuration/ class="align-left ps-0 td-sidebar-link td-sidebar-link__page" id=m-41securitylistener-configuration><span>Listener Configuration</span></a></label></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-41securityencryption-and-authentication-using-ssl-li><input type=checkbox id=m-41securityencryption-and-authentication-using-ssl-check>
<label for=m-41securityencryption-and-authentication-using-ssl-check><a href=/41/security/encryption-and-authentication-using-ssl/ class="align-left ps-0 td-sidebar-link td-sidebar-link__page" id=m-41securityencryption-and-authentication-using-ssl><span>Encryption and Authentication using SSL</span></a></label></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-41securityauthentication-using-sasl-li><input type=checkbox id=m-41securityauthentication-using-sasl-check>
<label for=m-41securityauthentication-using-sasl-check><a href=/41/security/authentication-using-sasl/ class="align-left ps-0 td-sidebar-link td-sidebar-link__page" id=m-41securityauthentication-using-sasl><span>Authentication using SASL</span></a></label></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-41securityauthorization-and-acls-li><input type=checkbox id=m-41securityauthorization-and-acls-check>
<label for=m-41securityauthorization-and-acls-check><a href=/41/security/authorization-and-acls/ class="align-left ps-0 td-sidebar-link td-sidebar-link__page" id=m-41securityauthorization-and-acls><span>Authorization and ACLs</span></a></label></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-41securityincorporating-security-features-in-a-running-cluster-li><input type=checkbox id=m-41securityincorporating-security-features-in-a-running-cluster-check>
<label for=m-41securityincorporating-security-features-in-a-running-cluster-check><a href=/41/security/incorporating-security-features-in-a-running-cluster/ class="align-left ps-0 td-sidebar-link td-sidebar-link__page" id=m-41securityincorporating-security-features-in-a-running-cluster><span>Incorporating Security Features in a Running Cluster</span></a></label></li></ul></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section with-child" id=m-41kafka-connect-li><input type=checkbox id=m-41kafka-connect-check>
<label for=m-41kafka-connect-check><a href=/41/kafka-connect/ class="align-left ps-0 td-sidebar-link td-sidebar-link__section" id=m-41kafka-connect><span>Kafka Connect</span></a></label><ul class="ul-2 foldable"><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-41kafka-connectoverview-li><input type=checkbox id=m-41kafka-connectoverview-check>
<label for=m-41kafka-connectoverview-check><a href=/41/kafka-connect/overview/ class="align-left ps-0 td-sidebar-link td-sidebar-link__page" id=m-41kafka-connectoverview><span>Overview</span></a></label></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-41kafka-connectuser-guide-li><input type=checkbox id=m-41kafka-connectuser-guide-check>
<label for=m-41kafka-connectuser-guide-check><a href=/41/kafka-connect/user-guide/ class="align-left ps-0 td-sidebar-link td-sidebar-link__page" id=m-41kafka-connectuser-guide><span>User Guide</span></a></label></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-41kafka-connectconnector-development-guide-li><input type=checkbox id=m-41kafka-connectconnector-development-guide-check>
<label for=m-41kafka-connectconnector-development-guide-check><a href=/41/kafka-connect/connector-development-guide/ class="align-left ps-0 td-sidebar-link td-sidebar-link__page" id=m-41kafka-connectconnector-development-guide><span>Connector Development Guide</span></a></label></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-41kafka-connectadministration-li><input type=checkbox id=m-41kafka-connectadministration-check>
<label for=m-41kafka-connectadministration-check><a href=/41/kafka-connect/administration/ class="align-left ps-0 td-sidebar-link td-sidebar-link__page" id=m-41kafka-connectadministration><span>Administration</span></a></label></li></ul></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section with-child" id=m-41streams-li><input type=checkbox id=m-41streams-check>
<label for=m-41streams-check><a href=/41/streams/ class="align-left ps-0 td-sidebar-link td-sidebar-link__section" id=m-41streams><span>Kafka Streams</span></a></label><ul class="ul-2 foldable"><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-41streamsintroduction-li><input type=checkbox id=m-41streamsintroduction-check>
<label for=m-41streamsintroduction-check><a href=/41/streams/introduction/ class="align-left ps-0 td-sidebar-link td-sidebar-link__page" id=m-41streamsintroduction><span>Introduction</span></a></label></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-41streamsquickstart-li><input type=checkbox id=m-41streamsquickstart-check>
<label for=m-41streamsquickstart-check><a href=/41/streams/quickstart/ class="align-left ps-0 td-sidebar-link td-sidebar-link__page" id=m-41streamsquickstart><span>Quick Start</span></a></label></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-41streamstutorial-li><input type=checkbox id=m-41streamstutorial-check>
<label for=m-41streamstutorial-check><a href=/41/streams/tutorial/ class="align-left ps-0 td-sidebar-link td-sidebar-link__page" id=m-41streamstutorial><span>Write a streams app</span></a></label></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-41streamscore-concepts-li><input type=checkbox id=m-41streamscore-concepts-check>
<label for=m-41streamscore-concepts-check><a href=/41/streams/core-concepts/ class="align-left ps-0 td-sidebar-link td-sidebar-link__page" id=m-41streamscore-concepts><span>Core Concepts</span></a></label></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-41streamsarchitecture-li><input type=checkbox id=m-41streamsarchitecture-check>
<label for=m-41streamsarchitecture-check><a href=/41/streams/architecture/ class="align-left ps-0 td-sidebar-link td-sidebar-link__page" id=m-41streamsarchitecture><span>Architecture</span></a></label></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-41streamsupgrade-guide-li><input type=checkbox id=m-41streamsupgrade-guide-check>
<label for=m-41streamsupgrade-guide-check><a href=/41/streams/upgrade-guide/ class="align-left ps-0 td-sidebar-link td-sidebar-link__page" id=m-41streamsupgrade-guide><span>Upgrade Guide</span></a></label></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section with-child" id=m-41streamsdeveloper-guide-li><input type=checkbox id=m-41streamsdeveloper-guide-check>
<label for=m-41streamsdeveloper-guide-check><a href=/41/streams/developer-guide/ class="align-left ps-0 td-sidebar-link td-sidebar-link__section" id=m-41streamsdeveloper-guide><span>Streams Developer Guide</span></a></label><ul class="ul-3 foldable"><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-41streamsdeveloper-guidewrite-streams-app-li><input type=checkbox id=m-41streamsdeveloper-guidewrite-streams-app-check>
<label for=m-41streamsdeveloper-guidewrite-streams-app-check><a href=/41/streams/developer-guide/write-streams-app/ class="align-left ps-0 td-sidebar-link td-sidebar-link__page" id=m-41streamsdeveloper-guidewrite-streams-app><span>Writing a Streams Application</span></a></label></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-41streamsdeveloper-guideconfig-streams-li><input type=checkbox id=m-41streamsdeveloper-guideconfig-streams-check>
<label for=m-41streamsdeveloper-guideconfig-streams-check><a href=/41/streams/developer-guide/config-streams/ class="align-left ps-0 td-sidebar-link td-sidebar-link__page" id=m-41streamsdeveloper-guideconfig-streams><span>Configuring a Streams Application</span></a></label></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-41streamsdeveloper-guidedsl-api-li><input type=checkbox id=m-41streamsdeveloper-guidedsl-api-check>
<label for=m-41streamsdeveloper-guidedsl-api-check><a href=/41/streams/developer-guide/dsl-api/ class="align-left ps-0 td-sidebar-link td-sidebar-link__page" id=m-41streamsdeveloper-guidedsl-api><span>Streams DSL</span></a></label></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-41streamsdeveloper-guideprocessor-api-li><input type=checkbox id=m-41streamsdeveloper-guideprocessor-api-check>
<label for=m-41streamsdeveloper-guideprocessor-api-check><a href=/41/streams/developer-guide/processor-api/ class="align-left ps-0 td-sidebar-link td-sidebar-link__page" id=m-41streamsdeveloper-guideprocessor-api><span>Processor API</span></a></label></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-41streamsdeveloper-guidedsl-topology-naming-li><input type=checkbox id=m-41streamsdeveloper-guidedsl-topology-naming-check>
<label for=m-41streamsdeveloper-guidedsl-topology-naming-check><a href=/41/streams/developer-guide/dsl-topology-naming/ class="align-left ps-0 td-sidebar-link td-sidebar-link__page" id=m-41streamsdeveloper-guidedsl-topology-naming><span>Naming Operators in a Streams DSL application</span></a></label></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-41streamsdeveloper-guidedatatypes-li><input type=checkbox id=m-41streamsdeveloper-guidedatatypes-check>
<label for=m-41streamsdeveloper-guidedatatypes-check><a href=/41/streams/developer-guide/datatypes/ class="align-left ps-0 td-sidebar-link td-sidebar-link__page" id=m-41streamsdeveloper-guidedatatypes><span>Data Types and Serialization</span></a></label></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-41streamsdeveloper-guidetesting-li><input type=checkbox id=m-41streamsdeveloper-guidetesting-check>
<label for=m-41streamsdeveloper-guidetesting-check><a href=/41/streams/developer-guide/testing/ class="align-left ps-0 td-sidebar-link td-sidebar-link__page" id=m-41streamsdeveloper-guidetesting><span>Testing a Streams Application</span></a></label></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-41streamsdeveloper-guideinteractive-queries-li><input type=checkbox id=m-41streamsdeveloper-guideinteractive-queries-check>
<label for=m-41streamsdeveloper-guideinteractive-queries-check><a href=/41/streams/developer-guide/interactive-queries/ class="align-left ps-0 td-sidebar-link td-sidebar-link__page" id=m-41streamsdeveloper-guideinteractive-queries><span>Interactive Queries</span></a></label></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-41streamsdeveloper-guidememory-mgmt-li><input type=checkbox id=m-41streamsdeveloper-guidememory-mgmt-check>
<label for=m-41streamsdeveloper-guidememory-mgmt-check><a href=/41/streams/developer-guide/memory-mgmt/ class="align-left ps-0 td-sidebar-link td-sidebar-link__page" id=m-41streamsdeveloper-guidememory-mgmt><span>Memory Management</span></a></label></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-41streamsdeveloper-guiderunning-app-li><input type=checkbox id=m-41streamsdeveloper-guiderunning-app-check>
<label for=m-41streamsdeveloper-guiderunning-app-check><a href=/41/streams/developer-guide/running-app/ class="align-left ps-0 td-sidebar-link td-sidebar-link__page" id=m-41streamsdeveloper-guiderunning-app><span>Running Streams Applications</span></a></label></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-41streamsdeveloper-guidemanage-topics-li><input type=checkbox id=m-41streamsdeveloper-guidemanage-topics-check>
<label for=m-41streamsdeveloper-guidemanage-topics-check><a href=/41/streams/developer-guide/manage-topics/ class="align-left ps-0 td-sidebar-link td-sidebar-link__page" id=m-41streamsdeveloper-guidemanage-topics><span>Managing Streams Application Topics</span></a></label></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-41streamsdeveloper-guidesecurity-li><input type=checkbox id=m-41streamsdeveloper-guidesecurity-check>
<label for=m-41streamsdeveloper-guidesecurity-check><a href=/41/streams/developer-guide/security/ class="align-left ps-0 td-sidebar-link td-sidebar-link__page" id=m-41streamsdeveloper-guidesecurity><span>Streams Security</span></a></label></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-41streamsdeveloper-guideapp-reset-tool-li><input type=checkbox id=m-41streamsdeveloper-guideapp-reset-tool-check>
<label for=m-41streamsdeveloper-guideapp-reset-tool-check><a href=/41/streams/developer-guide/app-reset-tool/ class="align-left ps-0 td-sidebar-link td-sidebar-link__page" id=m-41streamsdeveloper-guideapp-reset-tool><span>Application Reset Tool</span></a></label></li></ul></li></ul></li></ul></li></ul></nav></div></aside><aside class="d-none d-xl-block col-xl-2 td-sidebar-toc d-print-none"><div class="td-page-meta ms-2 pb-1 pt-2 mb-0"><a href=https://github.com/apache/kafka-site//tree/markdown/content/en/41/getting-started/upgrade.md class="td-page-meta--view td-page-meta__view" target=_blank rel=noopener><i class="fa-solid fa-file-lines fa-fw"></i> View page source</a>
<a href=https://github.com/apache/kafka-site//edit/markdown/content/en/41/getting-started/upgrade.md class="td-page-meta--edit td-page-meta__edit" target=_blank rel=noopener><i class="fa-solid fa-pen-to-square fa-fw"></i> Edit this page</a>
<a href="https://github.com/apache/kafka-site//new/markdown/content/en/41/getting-started?filename=change-me.md&amp;value=---%0Atitle%3A+%22Long+Page+Title%22%0AlinkTitle%3A+%22Short+Nav+Title%22%0Aweight%3A+100%0Adescription%3A+%3E-%0A+++++Page+description+for+heading+and+indexes.%0A---%0A%0A%23%23+Heading%0A%0AEdit+this+template+to+create+your+new+page.%0A%0A%2A+Give+it+a+good+name%2C+ending+in+%60.md%60+-+e.g.+%60getting-started.md%60%0A%2A+Edit+the+%22front+matter%22+section+at+the+top+of+the+page+%28weight+controls+how+its+ordered+amongst+other+pages+in+the+same+directory%3B+lowest+number+first%29.%0A%2A+Add+a+good+commit+message+at+the+bottom+of+the+page+%28%3C80+characters%3B+use+the+extended+description+field+for+more+detail%29.%0A%2A+Create+a+new+branch+so+you+can+preview+your+new+file+and+request+a+review+via+Pull+Request.%0A" class="td-page-meta--child td-page-meta__child" target=_blank rel=noopener><i class="fa-solid fa-pen-to-square fa-fw"></i> Create child page</a>
<a href="https://github.com/apache/kafka-site//issues/new?title=Upgrading" class="td-page-meta--issue td-page-meta__issue" target=_blank rel=noopener><i class="fa-solid fa-list-check fa-fw"></i> Create documentation issue</a>
<a id=print href=/41/getting-started/_print/><i class="fa-solid fa-print fa-fw"></i> Print entire section</a></div><div class=td-toc><nav id=TableOfContents><ul><li><a href=#upgrading-to-410>Upgrading to 4.1.0</a><ul><li><a href=#upgrading-servers-to-410-from-any-version-33x-through-40x>Upgrading Servers to 4.1.0 from any version 3.3.x through 4.0.x</a></li><li><a href=#notable-changes-in-410>Notable changes in 4.1.0</a></li></ul></li><li><a href=#upgrading-to-401>Upgrading to 4.0.1</a><ul><li><a href=#upgrading-clients-to-401>Upgrading Clients to 4.0.1</a></li><li><a href=#upgrading-servers-to-401-from-any-version-33x-through-39x>Upgrading Servers to 4.0.1 from any version 3.3.x through 3.9.x</a></li><li><a href=#notable-changes-in-401>Notable changes in 4.0.1</a></li><li><a href=#notable-changes-in-400>Notable changes in 4.0.0</a></li></ul></li><li><a href=#upgrading-to-390-and-older-versions>Upgrading to 3.9.0 and older versions</a></li></ul></nav></div><div class="taxonomy taxonomy-terms-cloud taxo-tags"><h5 class=taxonomy-title>Tag Cloud</h5><ul class=taxonomy-terms><li><a class=taxonomy-term href=https://example.kafka-site-md.dev/tags/apis/ data-taxonomy-term=apis><span class=taxonomy-label>Apis</span><span class=taxonomy-count>32</span></a></li><li><a class=taxonomy-term href=https://example.kafka-site-md.dev/tags/configuration/ data-taxonomy-term=configuration><span class=taxonomy-label>Configuration</span><span class=taxonomy-count>32</span></a></li><li><a class=taxonomy-term href=https://example.kafka-site-md.dev/tags/design/ data-taxonomy-term=design><span class=taxonomy-label>Design</span><span class=taxonomy-count>32</span></a></li><li><a class=taxonomy-term href=https://example.kafka-site-md.dev/tags/developer-guide/ data-taxonomy-term=developer-guide><span class=taxonomy-label>Developer-Guide</span><span class=taxonomy-count>32</span></a></li><li><a class=taxonomy-term href=https://example.kafka-site-md.dev/tags/docs/ data-taxonomy-term=docs><span class=taxonomy-label>Docs</span><span class=taxonomy-count>1781</span></a></li><li><a class=taxonomy-term href=https://example.kafka-site-md.dev/tags/getting-started/ data-taxonomy-term=getting-started><span class=taxonomy-label>Getting-Started</span><span class=taxonomy-count>32</span></a></li><li><a class=taxonomy-term href=https://example.kafka-site-md.dev/tags/implementation/ data-taxonomy-term=implementation><span class=taxonomy-label>Implementation</span><span class=taxonomy-count>32</span></a></li><li><a class=taxonomy-term href=https://example.kafka-site-md.dev/tags/kafka/ data-taxonomy-term=kafka><span class=taxonomy-label>Kafka</span><span class=taxonomy-count>1781</span></a></li><li><a class=taxonomy-term href=https://example.kafka-site-md.dev/tags/ops/ data-taxonomy-term=ops><span class=taxonomy-label>Ops</span><span class=taxonomy-count>32</span></a></li><li><a class=taxonomy-term href=https://example.kafka-site-md.dev/tags/security/ data-taxonomy-term=security><span class=taxonomy-label>Security</span><span class=taxonomy-count>64</span></a></li><li><a class=taxonomy-term href=https://example.kafka-site-md.dev/tags/streams/ data-taxonomy-term=streams><span class=taxonomy-label>Streams</span><span class=taxonomy-count>64</span></a></li></ul></div></aside><main class="col-12 col-md-9 col-xl-8 ps-md-5" role=main><nav aria-label=breadcrumb class=td-breadcrumbs><ol class=breadcrumb><li class=breadcrumb-item><a href=/41/>AK 4.1.X</a></li><li class=breadcrumb-item><a href=/41/getting-started/>Getting Started</a></li><li class="breadcrumb-item active" aria-current=page>Upgrading</li></ol></nav><div class=td-content><h1>Upgrading</h1><header class=article-meta><div class="taxonomy taxonomy-terms-article taxo-tags"><h5 class=taxonomy-title>Tags:</h5><ul class=taxonomy-terms><li><a class=taxonomy-term href=https://example.kafka-site-md.dev/tags/kafka/ data-taxonomy-term=kafka><span class=taxonomy-label>Kafka</span></a></li><li><a class=taxonomy-term href=https://example.kafka-site-md.dev/tags/docs/ data-taxonomy-term=docs><span class=taxonomy-label>Docs</span></a></li></ul></div></header><h2 id=upgrading-to-410>Upgrading to 4.1.0<a class=td-heading-self-link href=#upgrading-to-410 aria-label="Heading self-link"></a></h2><h3 id=upgrading-servers-to-410-from-any-version-33x-through-40x>Upgrading Servers to 4.1.0 from any version 3.3.x through 4.0.x<a class=td-heading-self-link href=#upgrading-servers-to-410-from-any-version-33x-through-40x aria-label="Heading self-link"></a></h3><h3 id=notable-changes-in-410>Notable changes in 4.1.0<a class=td-heading-self-link href=#notable-changes-in-410 aria-label="Heading self-link"></a></h3><ul><li>Apache Kafka 4.1 ships with a preview of Queues for Kafka (<a href=https://cwiki.apache.org/confluence/x/4hA0Dw>KIP-932</a>). This feature introduces a new kind of group called share groups, as an alternative to consumer groups. Consumers in a share group cooperatively consume records from topics, without assigning each partition to just one consumer. Share groups also introduce per-record acknowledgement and counting of delivery attempts. Use share groups in cases where records are processed one at a time, rather than as part of an ordered stream. To enable share groups, use the <code>kafka-features.sh</code> tool to upgrade to <code>share.version=1</code>. For more information, please read the <a href=https://cwiki.apache.org/confluence/x/CIq3FQ>release notes</a>.</li><li><strong>Common</strong><ul><li>The logger class name for LogCleaner has been updated from <code>kafka.log.LogCleaner</code> to <code>org.apache.kafka.storage.internals.log.LogCleaner</code> in the log4j2.yaml configuration file. Added loggers for <code>org.apache.kafka.storage.internals.log.LogCleaner$CleanerThread</code> and <code>org.apache.kafka.storage.internals.log.Cleaner</code> classes to CleanerAppender.</li><li>The filename for rotated <code>state-change.log</code> files has been updated from <code>stage-change.log.[date]</code> to <code>state-change.log.[date]</code> in the log4j2.yaml configuration file.</li></ul></li><li><strong>Broker</strong><ul><li>The configuration <code>log.cleaner.enable</code> is deprecated. Users should no longer set it to <code>false</code> to prepare for future removal. After the removal, <code>log.cleaner.threads</code> will also have a lower bound of 1. For further details, please refer to <a href=https://cwiki.apache.org/confluence/x/XAyWF>KIP-1148</a>.</li><li>The KIP-966 part 1: Eligible Leader Replicas(ELR) will be enabled by default on the new clusters. After the ELR feature enabled, the previously set <code>min.insync.replicas</code> value at the broker-level config will be removed. Please set at the cluster-level if necessary. For further details, please refer to <a href=/41/documentation.html#eligible_leader_replicas>here</a>.</li></ul></li><li><strong>Producer</strong><ul><li>The <code>flush</code> method now detects potential deadlocks and prohibits its use inside a callback. This change prevents unintended blocking behavior, which was a known risk in earlier versions.</li></ul></li><li><strong>Command</strong><ul><li>The <code>force</code> option of <code>ConfigCommand</code> has been removed, as it has been non-operational since version 0.10.1.0.</li></ul></li><li><strong>Admin</strong><ul><li>The <code>listConsumerGroups()</code> and <code>listConsumerGroups(ListConsumerGroupsOptions)</code> methods in <code>Admin</code> are deprecated, and will be removed in the next major version. Use <code>Admin.listGroups(ListGroupsOptions.forConsumerGroups())</code> instead.</li></ul></li><li><strong>Kafka Streams</strong><ul><li>The <code>window.size.ms</code> and <code>window.inner.serde.class</code> in <code>StreamsConfig</code> are deprecated. Use the corresponding string constants defined in <code>TimeWindowedSerializer</code>, <code>TimeWindowedDeserializer</code>, <code>SessionWindowedSerializer</code> and <code>SessionWindowedDeserializer</code> instead.</li></ul></li></ul><h2 id=upgrading-to-401>Upgrading to 4.0.1<a class=td-heading-self-link href=#upgrading-to-401 aria-label="Heading self-link"></a></h2><h3 id=upgrading-clients-to-401>Upgrading Clients to 4.0.1<a class=td-heading-self-link href=#upgrading-clients-to-401 aria-label="Heading self-link"></a></h3><p><strong>For a rolling upgrade:</strong></p><ol><li>Upgrade the clients one at a time: shut down the client, update the code, and restart it.</li><li>Clients (including Streams and Connect) must be on version 2.1 or higher before upgrading to 4.0. Many deprecated APIs were removed in Kafka 4.0. For more information about the compatibility, please refer to the <a href=/41/compatibility.html>compatibility matrix</a> or <a href=https://cwiki.apache.org/confluence/x/y4kgF>KIP-1124</a>.</li></ol><h3 id=upgrading-servers-to-401-from-any-version-33x-through-39x>Upgrading Servers to 4.0.1 from any version 3.3.x through 3.9.x<a class=td-heading-self-link href=#upgrading-servers-to-401-from-any-version-33x-through-39x aria-label="Heading self-link"></a></h3><p>Note: Apache Kafka 4.0 only supports KRaft mode - ZooKeeper mode has been removed. As such, <strong>broker upgrades to 4.0.0 (and higher) require KRaft mode and the software and metadata versions must be at least 3.3.x</strong> (the first version when KRaft mode was deemed production ready). For clusters in KRaft mode with versions older than 3.3.x, we recommend upgrading to 3.9.x before upgrading to 4.0.x. Clusters in ZooKeeper mode have to be <a href=/41/documentation.html#kraft_zk_migration>migrated to KRaft mode</a> before they can be upgraded to 4.0.x.</p><p><strong>For a rolling upgrade:</strong></p><ol><li>Upgrade the brokers one at a time: shut down the broker, update the code, and restart it. Once you have done so, the brokers will be running the latest version and you can verify that the cluster&rsquo;s behavior and performance meet expectations.</li><li>Once the cluster&rsquo;s behavior and performance have been verified, finalize the upgrade by running <code>bin/kafka-features.sh --bootstrap-server localhost:9092 upgrade --release-version 4.0</code></li><li>Note that cluster metadata downgrade is not supported in this version since it has metadata changes. Every <a href=https://github.com/apache/kafka/blob/trunk/server-common/src/main/java/org/apache/kafka/server/common/MetadataVersion.java>MetadataVersion</a> has a boolean parameter that indicates if there are metadata changes (i.e. <code>IBP_4_0_IV1(23, "4.0", "IV1", true)</code> means this version has metadata changes). Given your current and target versions, a downgrade is only possible if there are no metadata changes in the versions between.</li></ol><h3 id=notable-changes-in-401>Notable changes in 4.0.1<a class=td-heading-self-link href=#notable-changes-in-401 aria-label="Heading self-link"></a></h3><ul><li>The filename for rotated <code>state-change.log</code> files has been updated from <code>stage-change.log.[date]</code> to <code>state-change.log.[date]</code> in the log4j2.yaml configuration file. See <a href=https://issues.apache.org/jira/browse/KAFKA-19576>KAFKA-19576</a> for details.</li></ul><h3 id=notable-changes-in-400>Notable changes in 4.0.0<a class=td-heading-self-link href=#notable-changes-in-400 aria-label="Heading self-link"></a></h3><ul><li>Old protocol API versions have been removed. Users should ensure brokers are version 2.1 or higher before upgrading Java clients (including Connect and Kafka Streams which use the clients internally) to 4.0. Similarly, users should ensure their Java clients (including Connect and Kafka Streams) version is 2.1 or higher before upgrading brokers to 4.0. Finally, care also needs to be taken when it comes to kafka clients that are not part of Apache Kafka, please see <a href=https://cwiki.apache.org/confluence/x/K5sODg>KIP-896</a> for the details.</li><li>Apache Kafka 4.0 only supports KRaft mode - ZooKeeper mode has been removed. About version upgrade, check <a href=/41/documentation.html#upgrade_4_0_1>Upgrading to 4.0.1 from any version 3.3.x through 3.9.x</a> for more info.</li><li>Apache Kafka 4.0 ships with a brand-new group coordinator implementation (See <a href=https://cwiki.apache.org/confluence/x/HhD1D>here</a>). Functionally speaking, it implements all the same APIs. There are reasonable defaults, but the behavior of the new group coordinator can be tuned by setting the configurations with prefix <code>group.coordinator</code>.</li><li>The Next Generation of the Consumer Rebalance Protocol (<a href=https://cwiki.apache.org/confluence/x/HhD1D>KIP-848</a>) is now Generally Available (GA) in Apache Kafka 4.0. The protocol is automatically enabled on the server when the upgrade to 4.0 is finalized. Note that once the new protocol is used by consumer groups, the cluster can only be downgraded to version 3.4.1 or newer. For more information check <a href=/41/documentation.html#consumer_rebalance_protocol>here</a>.</li><li>Transactions Server-Side Defense (<a href=https://cwiki.apache.org/confluence/x/B40ODg>KIP-890</a>) brings a strengthened transactional protocol to Apache Kafka 4.0. The new and improved transactional protocol is enabled when the upgrade to 4.0 is finalized. When using 4.0 producer clients, the producer epoch is bumped on every transaction to ensure every transaction includes the intended messages and duplicates are not written as part of the next transaction. Downgrading the protocol is safe. For more information check <a href=/41/documentation.html#transaction_protocol>here</a>.</li><li>Eligible Leader Replicas (<a href=https://cwiki.apache.org/confluence/x/mpOzDw>KIP-966 Part 1</a>) enhances the replication protocol for the Apache Kafka 4.0. Now the KRaft controller keeps track of the data partition replicas that are not included in ISR but are safe to be elected as leader without data loss. Such replicas are stored in the partition metadata as the <code>Eligible Leader Replicas</code>(ELR). For more information check <a href=/41/documentation.html#eligible_leader_replicas>here</a>.</li><li>Since Apache Kafka 4.0.0, we have added a system property (<code>org.apache.kafka.sasl.oauthbearer.allowed.urls</code>) to set the allowed URLs as SASL OAUTHBEARER token or jwks endpoints. By default, the value is an empty list. Users should explicitly set the allowed list if necessary.</li><li>A number of deprecated classes, methods, configurations and tools have been removed.<ul><li><strong>Common</strong><ul><li>The <code>metrics.jmx.blacklist</code> and <code>metrics.jmx.whitelist</code> configurations were removed from the <code>org.apache.kafka.common.metrics.JmxReporter</code> Please use <code>metrics.jmx.exclude</code> and <code>metrics.jmx.include</code> respectively instead.</li><li>The <code>auto.include.jmx.reporter</code> configuration was removed. The <code>metric.reporters</code> configuration is now set to <code>org.apache.kafka.common.metrics.JmxReporter</code> by default.</li><li>The constructor <code>org.apache.kafka.common.metrics.JmxReporter</code> with string argument was removed. See <a href=https://cwiki.apache.org/confluence/x/SxIRCQ>KIP-606</a> for details.</li><li>The <code>bufferpool-wait-time-total</code>, <code>io-waittime-total</code>, and <code>iotime-total</code> metrics were removed. Please use <code>bufferpool-wait-time-ns-total</code>, <code>io-wait-time-ns-total</code>, and <code>io-time-ns-total</code> metrics as replacements, respectively.</li><li>The <code>kafka.common.requests.DescribeLogDirsResponse.LogDirInfo</code> class was removed. Please use the <code>kafka.clients.admin.DescribeLogDirsResult.descriptions()</code> class and <code>kafka.clients.admin.DescribeLogDirsResult.allDescriptions()</code> instead.</li><li>The <code>kafka.common.requests.DescribeLogDirsResponse.ReplicaInfo</code> class was removed. Please use the <code>kafka.clients.admin.DescribeLogDirsResult.descriptions()</code> class and <code>kafka.clients.admin.DescribeLogDirsResult.allDescriptions()</code> instead.</li><li>The <code>org.apache.kafka.common.security.oauthbearer.secured.OAuthBearerLoginCallbackHandler</code> class was removed. Please use the <code>org.apache.kafka.common.security.oauthbearer.OAuthBearerLoginCallbackHandler</code> class instead.</li><li>The <code>org.apache.kafka.common.security.oauthbearer.secured.OAuthBearerValidatorCallbackHandler</code> class was removed. Please use the <code>org.apache.kafka.common.security.oauthbearer.OAuthBearerValidatorCallbackHandler</code> class instead.</li><li>The <code>org.apache.kafka.common.errors.NotLeaderForPartitionException</code> class was removed. The <code>org.apache.kafka.common.errors.NotLeaderOrFollowerException</code> is returned if a request could not be processed because the broker is not the leader or follower for a topic partition.</li><li>The <code>org.apache.kafka.clients.producer.internals.DefaultPartitioner</code> and <code>org.apache.kafka.clients.producer.UniformStickyPartitioner</code> classes were removed.</li><li>The <code>log.message.format.version</code> and <code>message.format.version</code> configs were removed.</li><li>The function <code>onNewBatch</code> in <code>org.apache.kafka.clients.producer.Partitioner</code> class was removed.</li><li>The default properties files for KRaft mode are no longer stored in the separate <code>config/kraft</code> directory since Zookeeper has been removed. These files have been consolidated with other configuration files. Now all configuration files are in <code>config</code> directory.</li><li>The valid format for <code>--bootstrap-server</code> only supports comma-separated value, such as <code>host1:port1,host2:port2,...</code>. Providing other formats, like space-separated bootstrap servers (e.g., <code>host1:port1 host2:port2 host3:port3</code>), will result in an exception, even though this was allowed in Apache Kafka versions prior to 4.0.</li></ul></li><li><strong>Broker</strong><ul><li>The <code>delegation.token.master.key</code> configuration was removed. Please use <code>delegation.token.secret.key</code> instead.</li><li>The <code>offsets.commit.required.acks</code> configuration was removed. See <a href=https://cwiki.apache.org/confluence/x/9YobEg>KIP-1041</a> for details.</li><li>The <code>log.message.timestamp.difference.max.ms</code> configuration was removed. Please use <code>log.message.timestamp.before.max.ms</code> and <code>log.message.timestamp.after.max.ms</code> instead. See <a href=https://cwiki.apache.org/confluence/x/thQ0Dw>KIP-937</a> for details.</li><li>The <code>remote.log.manager.copier.thread.pool.size</code> configuration default value was changed to 10 from -1. Values of -1 are no longer valid; a minimum value of 1 or higher is required. See <a href=https://cwiki.apache.org/confluence/x/FAqpEQ>KIP-1030</a></li><li>The <code>remote.log.manager.expiration.thread.pool.size</code> configuration default value was changed to 10 from -1. Values of -1 are no longer valid; a minimum value of 1 or higher is required. See <a href=https://cwiki.apache.org/confluence/x/FAqpEQ>KIP-1030</a></li><li>The <code>remote.log.manager.thread.pool.size</code> configuration default value was changed to 2 from 10. See <a href=https://cwiki.apache.org/confluence/x/FAqpEQ>KIP-1030</a></li><li>The minimum <code>segment.bytes/log.segment.bytes</code> has changed from 14 bytes to 1MB. See <a href=https://cwiki.apache.org/confluence/x/FAqpEQ>KIP-1030</a></li></ul></li><li><strong>MirrorMaker</strong><ul><li>The original MirrorMaker (MM1) and related classes were removed. Please use the Connect-based MirrorMaker (MM2), as described in the <a href=/41/#georeplication>Geo-Replication section.</a>.</li><li>The <code>use.incremental.alter.configs</code> configuration was removed from <code>MirrorSourceConnector</code>. The modified behavior is now identical to the previous <code>required</code> configuration, therefore users should ensure that brokers in the target cluster are at least running 2.3.0.</li><li>The <code>add.source.alias.to.metrics</code> configuration was removed from <code>MirrorSourceConnector</code>. The source cluster alias is now always added to the metrics.</li><li>The <code>config.properties.blacklist</code> was removed from the <code>org.apache.kafka.connect.mirror.MirrorSourceConfig</code> Please use <code>config.properties.exclude</code> instead.</li><li>The <code>topics.blacklist</code> was removed from the <code>org.apache.kafka.connect.mirror.MirrorSourceConfig</code> Please use <code>topics.exclude</code> instead.</li><li>The <code>groups.blacklist</code> was removed from the <code>org.apache.kafka.connect.mirror.MirrorSourceConfig</code> Please use <code>groups.exclude</code> instead.</li></ul></li><li><strong>Tools</strong><ul><li>The <code>kafka.common.MessageReader</code> class was removed. Please use the <a href=/41/javadoc/org/apache/kafka/tools/api/RecordReader.html><code>org.apache.kafka.tools.api.RecordReader</code></a> interface to build custom readers for the <code>kafka-console-producer</code> tool.</li><li>The <code>kafka.tools.DefaultMessageFormatter</code> class was removed. Please use the <code>org.apache.kafka.tools.consumer.DefaultMessageFormatter</code> class instead.</li><li>The <code>kafka.tools.LoggingMessageFormatter</code> class was removed. Please use the <code>org.apache.kafka.tools.consumer.LoggingMessageFormatter</code> class instead.</li><li>The <code>kafka.tools.NoOpMessageFormatter</code> class was removed. Please use the <code>org.apache.kafka.tools.consumer.NoOpMessageFormatter</code> class instead.</li><li>The <code>--whitelist</code> option was removed from the <code>kafka-console-consumer</code> command line tool. Please use <code>--include</code> instead.</li><li>Redirections from the old tools packages have been removed: <code>kafka.admin.FeatureCommand</code>, <code>kafka.tools.ClusterTool</code>, <code>kafka.tools.EndToEndLatency</code>, <code>kafka.tools.StateChangeLogMerger</code>, <code>kafka.tools.StreamsResetter</code>, <code>kafka.tools.JmxTool</code>.</li><li>The <code>--authorizer</code>, <code>--authorizer-properties</code>, and <code>--zk-tls-config-file</code> options were removed from the <code>kafka-acls</code> command line tool. Please use <code>--bootstrap-server</code> or <code>--bootstrap-controller</code> instead.</li><li>The <code>kafka.serializer.Decoder</code> trait was removed, please use the <a href=/41/javadoc/org/apache/kafka/tools/api/Decoder.html><code>org.apache.kafka.tools.api.Decoder</code></a> interface to build custom decoders for the <code>kafka-dump-log</code> tool.</li><li>The <code>kafka.coordinator.group.OffsetsMessageFormatter</code> class was removed. Please use the <code>org.apache.kafka.tools.consumer.OffsetsMessageFormatter</code> class instead.</li><li>The <code>kafka.coordinator.group.GroupMetadataMessageFormatter</code> class was removed. Please use the <code>org.apache.kafka.tools.consumer.GroupMetadataMessageFormatter</code> class instead.</li><li>The <code>kafka.coordinator.transaction.TransactionLogMessageFormatter</code> class was removed. Please use the <code>org.apache.kafka.tools.consumer.TransactionLogMessageFormatter</code> class instead.</li><li>The <code>--topic-white-list</code> option was removed from the <code>kafka-replica-verification</code> command line tool. Please use <code>--topics-include</code> instead.</li><li>The <code>--broker-list</code> option was removed from the <code>kafka-verifiable-consumer</code> command line tool. Please use <code>--bootstrap-server</code> instead.</li><li><code>kafka-configs.sh</code> now uses incrementalAlterConfigs API to alter broker configurations instead of the deprecated alterConfigs API, and it will fall directly if the broker doesn&rsquo;t support incrementalAlterConfigs API, which means the broker version is prior to 2.3.x. See <a href=https://cwiki.apache.org/confluence/x/wIn5E>KIP-1011</a> for more details.</li><li>The <code>kafka.admin.ZkSecurityMigrator</code> tool was removed.</li></ul></li><li><strong>Connect</strong><ul><li>The <code>whitelist</code> and <code>blacklist</code> configurations were removed from the <code>org.apache.kafka.connect.transforms.ReplaceField</code> transformation. Please use <code>include</code> and <code>exclude</code> respectively instead.</li><li>The <code>onPartitionsRevoked(Collection&lt;TopicPartition>)</code> and <code>onPartitionsAssigned(Collection&lt;TopicPartition>)</code> methods were removed from <code>SinkTask</code>.</li><li>The <code>commitRecord(SourceRecord)</code> method was removed from <code>SourceTask</code>.</li></ul></li><li><strong>Consumer</strong><ul><li>The <code>poll(long)</code> method was removed from the consumer. Please use <code>poll(Duration)</code> instead. Note that there is a difference in behavior between the two methods. The <code>poll(Duration)</code> method does not block beyond the timeout awaiting partition assignment, whereas the earlier <code>poll(long)</code> method used to wait beyond the timeout.</li><li>The <code>committed(TopicPartition)</code> and <code>committed(TopicPartition, Duration)</code> methods were removed from the consumer. Please use <code>committed(Set&lt;TopicPartition>)</code> and <code>committed(Set&lt;TopicPartition>, Duration)</code> instead.</li><li>The <code>setException(KafkaException)</code> method was removed from the <code>org.apache.kafka.clients.consumer.MockConsumer</code>. Please use <code>setPollException(KafkaException)</code> instead.</li></ul></li><li><strong>Producer</strong><ul><li>The <code>enable.idempotence</code> configuration will no longer automatically fall back when the <code>max.in.flight.requests.per.connection</code> value exceeds 5.</li><li>The deprecated <code>sendOffsetsToTransaction(Map&lt;TopicPartition, OffsetAndMetadata>, String)</code> method has been removed from the Producer API.</li><li>The default <code>linger.ms</code> changed from 0 to 5 in Apache Kafka 4.0 as the efficiency gains from larger batches typically result in similar or lower producer latency despite the increased linger.</li></ul></li><li><strong>Admin client</strong><ul><li>The <code>alterConfigs</code> method was removed from the <code>org.apache.kafka.clients.admin.Admin</code>. Please use <code>incrementalAlterConfigs</code> instead.</li><li>The <code>org.apache.kafka.common.ConsumerGroupState</code> enumeration and related methods have been deprecated. Please use <code>GroupState</code> instead which applies to all types of group.</li><li>The <code>Admin.describeConsumerGroups</code> method used to return a <code>ConsumerGroupDescription</code> in state <code>DEAD</code> if the group ID was not found. In Apache Kafka 4.0, the <code>GroupIdNotFoundException</code> is thrown instead as part of the support for new types of group.</li><li>The <code>org.apache.kafka.clients.admin.DeleteTopicsResult.values()</code> method was removed. Please use <code>org.apache.kafka.clients.admin.DeleteTopicsResult.topicNameValues()</code> instead.</li><li>The <code>org.apache.kafka.clients.admin.TopicListing.TopicListing(String, boolean)</code> method was removed. Please use <code>org.apache.kafka.clients.admin.TopicListing.TopicListing(String, Uuid, boolean)</code> instead.</li><li>The <code>org.apache.kafka.clients.admin.ListConsumerGroupOffsetsOptions.topicPartitions(List&lt;TopicPartition>)</code> method was removed. Please use <code>org.apache.kafka.clients.admin.Admin.listConsumerGroupOffsets(Map&lt;String, ListConsumerGroupOffsetsSpec>, ListConsumerGroupOffsetsOptions)</code> instead.</li><li>The deprecated <code>dryRun</code> methods were removed from the <code>org.apache.kafka.clients.admin.UpdateFeaturesOptions</code>. Please use <code>validateOnly</code> instead.</li><li>The constructor <code>org.apache.kafka.clients.admin.FeatureUpdate</code> with short and boolean arguments was removed. Please use the constructor that accepts short and the specified <code>UpgradeType</code> enum instead.</li><li>The <code>allowDowngrade</code> method was removed from the <code>org.apache.kafka.clients.admin.FeatureUpdate</code>.</li><li>The <code>org.apache.kafka.clients.admin.DescribeTopicsResult.DescribeTopicsResult(Map&lt;String, KafkaFuture&lt;TopicDescription>>)</code> method was removed. Please use <code>org.apache.kafka.clients.admin.DescribeTopicsResult.DescribeTopicsResult(Map&lt;Uuid, KafkaFuture&lt;TopicDescription>>, Map&lt;String, KafkaFuture&lt;TopicDescription>>)</code> instead.</li><li>The <code>values()</code> method was removed from the <code>org.apache.kafka.clients.admin.DescribeTopicsResult</code>. Please use <code>topicNameValues()</code> instead.</li><li>The <code>all()</code> method was removed from the <code>org.apache.kafka.clients.admin.DescribeTopicsResult</code>. Please use <code>allTopicNames()</code> instead.</li></ul></li><li><strong>Kafka Streams</strong><ul><li>All public APIs, deprecated in Apache Kafka 3.6 or an earlier release, have been removed, with the exception of <code>JoinWindows.of()</code> and <code>JoinWindows#grace()</code>. See <a href=https://issues.apache.org/jira/browse/KAFKA-17531>KAFKA-17531</a> for details.</li><li>The most important changes are highlighted in the <a href=/41/streams/upgrade-guide/#streams_api_changes_400>Kafka Streams upgrade guide</a>.</li><li>For a full list of changes, see <a href=https://issues.apache.org/jira/browse/KAFKA-12822>KAFKA-12822</a>.</li><li>If you are using <code>KStream#transformValues()</code> which was removed with Apache Kafka 4.0.0 release, and you need to rewrite your program to use <code>KStreams#processValues()</code> instead, pay close attention to the <a href=/41/streams/developer-guide/dsl-api/#transformers-removal-and-migration-to-processors>migration guide</a>.</li></ul></li></ul></li><li>Other changes:<ul><li>The minimum Java version required by clients and Kafka Streams applications has been increased from Java 8 to Java 11 while brokers, connect and tools now require Java 17. See <a href=https://cwiki.apache.org/confluence/x/P4vOCg>KIP-750</a> and <a href=https://cwiki.apache.org/confluence/x/Bov5E>KIP-1013</a> for more details.</li><li>Java 23 support has been added in Apache Kafka 4.0.</li><li>Scala 2.12 support has been removed in Apache Kafka 4.0. See <a href=https://cwiki.apache.org/confluence/x/OovOCg>KIP-751</a> for more details</li><li>Logging framework has been migrated from Log4j to Log4j2. Users can use the log4j-transform-cli tool to automatically convert their existing Log4j configuration files to Log4j2 format. See <a href=https://logging.staged.apache.org/log4j/transform/cli.html#log4j-transform-cli>log4j-transform-cli</a> for more details. Log4j2 provides limited compatibility for Log4j configurations. See <a href=https://logging.apache.org/log4j/2.x/migrate-from-log4j1.html#ConfigurationCompatibility>Use Log4j 1 to Log4j 2 bridge</a> for more information,</li><li>KafkaLog4jAppender has been removed, users should migrate to the log4j2 appender See <a href=https://logging.apache.org/log4j/2.x/manual/appenders.html#KafkaAppender>KafkaAppender</a> for more details</li><li>The <code>--delete-config</code> option in the <code>kafka-topics</code> command line tool has been deprecated.</li><li>For implementors of RemoteLogMetadataManager (RLMM), a new API <code>nextSegmentWithTxnIndex</code> is introduced in RLMM to allow the implementation to return the next segment metadata with a transaction index. This API is used when the consumers are enabled with isolation level as READ_COMMITTED. See <a href=https://cwiki.apache.org/confluence/x/BwuTEg>KIP-1058</a> for more details.</li><li>The criteria for identifying internal topics in ReplicationPolicy and DefaultReplicationPolicy have been updated to enable the replication of topics that appear to be internal but aren&rsquo;t truly internal to Kafka and Mirror Maker 2. See <a href=https://cwiki.apache.org/confluence/x/jA3OEg>KIP-1074</a> for more details.</li><li><a href=https://cwiki.apache.org/confluence/x/2xRRCg>KIP-714</a> is now enabled for Kafka Streams via <a href=https://cwiki.apache.org/confluence/x/XA-OEg>KIP-1076</a>. This allows to not only collect the metric of the internally used clients of a Kafka Streams application via a broker-side plugin, but also to collect the <a href=/41/#kafka_streams_monitoring>metrics</a> of the Kafka Streams runtime itself.</li><li>The default value of <code>num.recovery.threads.per.data.dir</code> has been changed from 1 to 2. The impact of this is faster recovery post unclean shutdown at the expense of extra IO cycles. See <a href=https://cwiki.apache.org/confluence/x/FAqpEQ>KIP-1030</a></li><li>The default value of <code>message.timestamp.after.max.ms</code> has been changed from Long.Max to 1 hour. The impact of this messages with a timestamp of more than 1 hour in the future will be rejected when message.timestamp.type=CreateTime is set. See <a href=https://cwiki.apache.org/confluence/x/FAqpEQ>KIP-1030</a></li><li>Introduced in <a href=https://cwiki.apache.org/confluence/x/B40ODg>KIP-890</a>, the <code>TransactionAbortableException</code> enhances error handling within transactional operations by clearly indicating scenarios where transactions should be aborted due to errors. It is important for applications to properly manage both <code>TimeoutException</code> and <code>TransactionAbortableException</code> when working with transaction producers.<ul><li><strong>TimeoutException:</strong> This exception indicates that a transactional operation has timed out. Given the risk of message duplication that can arise from retrying operations after a timeout (potentially violating exactly-once semantics), applications should treat timeouts as reasons to abort the ongoing transaction.</li><li><strong>TransactionAbortableException:</strong> Specifically introduced to signal errors that should lead to transaction abortion, ensuring this exception is properly handled is critical for maintaining the integrity of transactional processing.</li><li>To ensure seamless operation and compatibility with future Kafka versions, developers are encouraged to update their error-handling logic to treat both exceptions as triggers for aborting transactions. This approach is pivotal for preserving exactly-once semantics.</li><li>See <a href=https://cwiki.apache.org/confluence/x/B40ODg>KIP-890</a> and <a href=https://cwiki.apache.org/confluence/x/8ItyEg>KIP-1050</a> for more details</li></ul></li><li>The filename for rotated <code>state-change.log</code> files incorrectly rotates to <code>stage-change.log.[date]</code> (changing state to stage). This issue is corrected in 4.0.1. See <a href=https://issues.apache.org/jira/browse/KAFKA-19576>KAFKA-19576</a> for details.</li></ul></li></ul><h2 id=upgrading-to-390-and-older-versions>Upgrading to 3.9.0 and older versions<a class=td-heading-self-link href=#upgrading-to-390-and-older-versions aria-label="Heading self-link"></a></h2><p>See <a href=/39/#upgrade>Upgrading From Previous Versions</a> in the 3.9 documentation.</p><style>.feedback--answer{display:inline-block}.feedback--answer-no{margin-left:1em}.feedback--response{display:none;margin-top:1em}.feedback--response__visible{display:block}</style><div class=d-print-none><h2 class=feedback--title>Feedback</h2><p class=feedback--question>Was this page helpful?</p><button class="btn btn-primary mb-4 feedback--answer feedback--answer-yes">Yes</button>
<button class="btn btn-primary mb-4 feedback--answer feedback--answer-no">No</button><p class="feedback--response feedback--response-yes">Glad to hear it! Please <a href=https://github.com/USERNAME/REPOSITORY/issues/new>tell us how we can improve</a>.</p><p class="feedback--response feedback--response-no">Sorry to hear that. Please <a href=https://github.com/USERNAME/REPOSITORY/issues/new>tell us how we can improve</a>.</p></div><script>const yesButton=document.querySelector(".feedback--answer-yes"),noButton=document.querySelector(".feedback--answer-no"),yesResponse=document.querySelector(".feedback--response-yes"),noResponse=document.querySelector(".feedback--response-no"),disableButtons=()=>{yesButton.disabled=!0,noButton.disabled=!0},sendFeedback=e=>{if(typeof gtag!="function")return;gtag("event","page_helpful",{event_category:"Helpful",event_label:window.location.pathname,value:e})};yesButton.addEventListener("click",()=>{yesResponse.classList.add("feedback--response__visible"),disableButtons(),sendFeedback(100)}),noButton.addEventListener("click",()=>{noResponse.classList.add("feedback--response__visible"),disableButtons(),sendFeedback(0)})</script><br><div class=td-page-meta__lastmod>Last modified September 27, 2025: <a href=https://github.com/apache/kafka-site//commit/4eb043b0262c56d07519e6178a7b317dee4d09e2>AK 4.1 updates (4eb043b0)</a></div></div></main></div></div><footer class="td-footer row d-print-none"><div class=container-fluid><div class="row mx-md-2"><div class="td-footer__left col-6 col-sm-4 order-sm-1"><ul class=td-footer__links-list><li class=td-footer__links-item data-bs-toggle=tooltip title=Contact aria-label=Contact><a target=_blank rel=noopener href=/community/contact/ aria-label=Contact><i class="fa fa-envelope"></i></a></li><li class=td-footer__links-item data-bs-toggle=tooltip title=Twitter aria-label=Twitter><a target=_blank rel=noopener href=https://twitter.com/apachekafka aria-label=Twitter><i class="fab fa-twitter"></i></a></li><li class=td-footer__links-item data-bs-toggle=tooltip title="Stack Overflow" aria-label="Stack Overflow"><a target=_blank rel=noopener href=https://stackoverflow.com/questions/tagged/apache-kafka aria-label="Stack Overflow"><i class="fab fa-stack-overflow"></i></a></li></ul></div><div class="td-footer__right col-6 col-sm-4 order-sm-3"><ul class=td-footer__links-list><li class=td-footer__links-item data-bs-toggle=tooltip title=GitHub aria-label=GitHub><a target=_blank rel=noopener href=https://github.com/apache/kafka aria-label=GitHub><i class="fab fa-github"></i></a></li><li class=td-footer__links-item data-bs-toggle=tooltip title="Developer mailing list" aria-label="Developer mailing list"><a target=_blank rel=noopener href=mailto:dev@kafka.apache.org aria-label="Developer mailing list"><i class="fa fa-envelope"></i></a></li></ul></div><div class="td-footer__center col-12 col-sm-4 py-2 order-sm-2"><span class=td-footer__copyright>&copy;
2014&ndash;2025
<span class=td-footer__authors>By <a href=https://www.apache.org/>Apache Software Foundation</a> under the terms of the <a href=https://www.apache.org/licenses/LICENSE-2.0>Apache License v2</a></span></span><span class=td-footer__all_rights_reserved>All Rights Reserved</span><span class=ms-2><a href=https://privacy.apache.org/policies/privacy-policy-public.html target=_blank rel=noopener>Privacy Policy</a></span></div></div></div></footer></div><script src=/js/main.min.dc2c0119076a0df855e55a8044ce0de74b7b9033c20e853e22d7ec7e9bdde965.js integrity="sha256-3CwBGQdqDfhV5VqARM4N50t7kDPCDoU+Itfsfpvd6WU=" crossorigin=anonymous></script><script defer src=/js/click-to-copy.min.73478a7d4807698aed7e355eb23f9890ca18fea3158604c8471746d046702bad.js integrity="sha256-c0eKfUgHaYrtfjVesj+YkMoY/qMVhgTIRxdG0EZwK60=" crossorigin=anonymous></script><script src=/js/tabpane-persist.js></script></body></html>
<!doctype html><html itemscope itemtype=http://schema.org/WebPage lang=en class=no-js><head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><link rel=canonical type=text/html href=https://example.kafka-site-md.dev/081/getting-started/><link rel=alternate type=application/rss+xml href=https://example.kafka-site-md.dev/081/getting-started/index.xml><meta name=robots content="noindex, nofollow"><link rel="shortcut icon" href=/favicons/favicon.ico><link rel=apple-touch-icon href=/favicons/apple-touch-icon-180x180.png sizes=180x180><link rel=icon type=image/png href=/favicons/favicon-16x16.png sizes=16x16><link rel=icon type=image/png href=/favicons/favicon-32x32.png sizes=32x32><link rel=icon type=image/png href=/favicons/android-36x36.png sizes=36x36><link rel=icon type=image/png href=/favicons/android-48x48.png sizes=48x48><link rel=icon type=image/png href=/favicons/android-72x72.png sizes=72x72><link rel=icon type=image/png href=/favicons/android-96x96.png sizes=96x96><link rel=icon type=image/png href=/favicons/android-144x144.png sizes=144x144><link rel=icon type=image/png href=/favicons/android-192x192.png sizes=192x192><title>Getting Started | </title><meta name=description content="This section provides an overview of what Kafka is, why it is useful, and how to get started using it."><meta property="og:title" content="Getting Started"><meta property="og:description" content="This section provides an overview of what Kafka is, why it is useful, and how to get started using it."><meta property="og:type" content="website"><meta property="og:url" content="https://example.kafka-site-md.dev/081/getting-started/"><meta itemprop=name content="Getting Started"><meta itemprop=description content="This section provides an overview of what Kafka is, why it is useful, and how to get started using it."><meta name=twitter:card content="summary"><meta name=twitter:title content="Getting Started"><meta name=twitter:description content="This section provides an overview of what Kafka is, why it is useful, and how to get started using it."><link rel=preload href=/scss/main.min.7ed0eb3fc68a0678ca492e0db9c00f8e8d5b776bbb2fb833732191f6bbf02877.css as=style integrity="sha256-ftDrP8aKBnjKSS4NucAPjo1bd2u7L7gzcyGR9rvwKHc=" crossorigin=anonymous><link href=/scss/main.min.7ed0eb3fc68a0678ca492e0db9c00f8e8d5b776bbb2fb833732191f6bbf02877.css rel=stylesheet integrity="sha256-ftDrP8aKBnjKSS4NucAPjo1bd2u7L7gzcyGR9rvwKHc=" crossorigin=anonymous><script src=https://code.jquery.com/jquery-3.7.1.min.js integrity="sha512-v2CJ7UaYy4JwqLDIrZUI/4hqeoQieOmAZNXBeQyjo21dadnwR+8ZaIJVT8EE2iyI61OV8e6M8PP2/4hpQINQ/g==" crossorigin=anonymous></script><script defer src=https://unpkg.com/lunr@2.3.9/lunr.min.js integrity=sha384-203J0SNzyqHby3iU6hzvzltrWi/M41wOP5Gu+BiJMz5nwKykbkUx8Kp7iti0Lpli crossorigin=anonymous></script></head><body class=td-section><header><nav class="td-navbar js-navbar-scroll" data-bs-theme=dark><div class="container-fluid flex-column flex-md-row"><a class=navbar-brand href=/><span class="navbar-brand__logo navbar-logo"><svg width="154" height="250" viewBox="0 0 256 416" xmlns="http://www.w3.org/2000/svg" preserveAspectRatio="xMidYMid"><path d="M201.816 230.216c-16.186.0-30.697 7.171-40.634 18.461l-25.463-18.026c2.703-7.442 4.255-15.433 4.255-23.797.0-8.219-1.498-16.076-4.112-23.408l25.406-17.835c9.936 11.233 24.409 18.365 40.548 18.365 29.875.0 54.184-24.305 54.184-54.184.0-29.879-24.309-54.184-54.184-54.184s-54.184 24.305-54.184 54.184c0 5.348.808 10.505 2.258 15.389l-25.423 17.844c-10.62-13.175-25.911-22.374-43.333-25.182v-30.64c24.544-5.155 43.037-26.962 43.037-53.019C124.171 24.305 99.862.0 69.987.0 40.112.0 15.803 24.305 15.803 54.184c0 25.708 18.014 47.246 42.067 52.769v31.038C25.044 143.753.0 172.401.0 206.854c0 34.621 25.292 63.374 58.355 68.94v32.774c-24.299 5.341-42.552 27.011-42.552 52.894.0 29.879 24.309 54.184 54.184 54.184s54.184-24.305 54.184-54.184c0-25.883-18.253-47.553-42.552-52.894v-32.775a69.965 69.965.0 0042.6-24.776l25.633 18.143c-1.423 4.84-2.22 9.946-2.22 15.24.0 29.879 24.309 54.184 54.184 54.184S256 314.279 256 284.4c0-29.879-24.309-54.184-54.184-54.184zm0-126.695c14.487.0 26.27 11.788 26.27 26.271s-11.783 26.27-26.27 26.27-26.27-11.787-26.27-26.27 11.783-26.271 26.27-26.271zm-158.1-49.337c0-14.483 11.784-26.27 26.271-26.27s26.27 11.787 26.27 26.27c0 14.483-11.783 26.27-26.27 26.27s-26.271-11.787-26.271-26.27zm52.541 307.278c0 14.483-11.783 26.27-26.27 26.27s-26.271-11.787-26.271-26.27 11.784-26.27 26.271-26.27 26.27 11.787 26.27 26.27zm-26.272-117.97c-20.205.0-36.642-16.434-36.642-36.638.0-20.205 16.437-36.642 36.642-36.642 20.204.0 36.641 16.437 36.641 36.642.0 20.204-16.437 36.638-36.641 36.638zm131.831 67.179c-14.487.0-26.27-11.788-26.27-26.271s11.783-26.27 26.27-26.27 26.27 11.787 26.27 26.27-11.783 26.271-26.27 26.271z" style="fill:#231f20"/></svg></span><span class=navbar-brand__name></span></a><div class="td-navbar-nav-scroll ms-md-auto" id=main_navbar><ul class=navbar-nav><li class=nav-item><a class=nav-link href=/40/><span>Documentation</span></a></li><li class=nav-item><a class=nav-link href=/blog/><span>Blog</span></a></li><li class=nav-item><a class=nav-link href=/community/><span>Community</span></a></li><li class=nav-item><a class=nav-link href=/testimonials/><span>Testimonials</span></a></li><li class=nav-item><a class=nav-link href=/community/downloads/><span>Download Kafka</span></a></li><li class="nav-item dropdown d-none d-lg-block"><div class=dropdown><a class="nav-link dropdown-toggle" href=# role=button data-bs-toggle=dropdown aria-haspopup=true aria-expanded=false>Releases</a><ul class=dropdown-menu><li><a class=dropdown-item href=/40/>4.0</a></li><li><a class=dropdown-item href=/39/>3.9</a></li><li><a class=dropdown-item href=/38/>3.8</a></li><li><a class=dropdown-item href=/37/>3.7</a></li><li><a class=dropdown-item href=/36/>3.6</a></li><li><a class=dropdown-item href=/35/>3.5</a></li><li><a class=dropdown-item href=/34/>3.4</a></li><li><a class=dropdown-item href=/33/>3.3</a></li><li><a class=dropdown-item href=/32/>3.2</a></li><li><a class=dropdown-item href=/31/>3.1</a></li><li><a class=dropdown-item href=/30/>3.0</a></li><li><a class=dropdown-item href=/28/>2.8</a></li><li><a class=dropdown-item href=/27/>2.7</a></li><li><a class=dropdown-item href=/26/>2.6</a></li><li><a class=dropdown-item href=/25/>2.5</a></li><li><a class=dropdown-item href=/24/>2.4</a></li><li><a class=dropdown-item href=/23/>2.3</a></li><li><a class=dropdown-item href=/22/>2.2</a></li><li><a class=dropdown-item href=/21/>2.1</a></li><li><a class=dropdown-item href=/20/>2.0</a></li><li><a class=dropdown-item href=/11/>1.1</a></li><li><a class=dropdown-item href=/10/>1.0</a></li><li><a class=dropdown-item href=/0110/>0.11.0</a></li><li><a class=dropdown-item href=/0102/>0.10.2</a></li><li><a class=dropdown-item href=/0101/>0.10.1</a></li><li><a class=dropdown-item href=/0100/>0.10.0</a></li><li><a class=dropdown-item href=/090/>0.9.0</a></li><li><a class=dropdown-item href=/082/>0.8.2</a></li><li><a class=dropdown-item href=/081/>0.8.1</a></li><li><a class=dropdown-item href=/080/>0.8.0</a></li><li><a class=dropdown-item href=/07/>0.7</a></li></ul></div></li></ul></div><div class="d-none d-lg-block"><div class="td-search td-search--offline"><div class=td-search__icon></div><input type=search class="td-search__input form-control" placeholder="Search this site…" aria-label="Search this site…" autocomplete=off data-offline-search-index-json-src=/offline-search-index.b12dd2b63080ea49c35456712ace836e.json data-offline-search-base-href=/ data-offline-search-max-results=10></div></div></div></nav></header><div class="container-fluid td-outer"><div class=td-main><div class="row flex-xl-nowrap"><main class="col-12 col-md-9 col-xl-8 ps-md-5" role=main><div class=td-content><div class="pageinfo pageinfo-primary d-print-none"><p>This is the multi-page printable view of this section.
<a href=# onclick="return print(),!1">Click here to print</a>.</p><p><a href=/081/getting-started/>Return to the regular view of this page</a>.</p></div><h1 class=title>Getting Started</h1><div class=lead>This section provides an overview of what Kafka is, why it is useful, and how to get started using it.</div><ul><li>1: <a href=#pg-9e0cf0a56560106ba81122f158b0d0e5>Introduction</a></li><li>2: <a href=#pg-4488ed237a3565d836858ea5aa05ab9b>Use Cases</a></li><li>3: <a href=#pg-14441834e512ddac7aa0606ed6c83649>Quick Start</a></li><li>4: <a href=#pg-04f3d5dc48c23c037512e2b45744d169>Ecosystem</a></li><li>5: <a href=#pg-11bd4117e7eb80bc7f8b0df4713cc111>Upgrading</a></li></ul><div class=content></div></div><div class=td-content><h1 id=pg-9e0cf0a56560106ba81122f158b0d0e5>1 - Introduction</h1><h1 id=introduction>Introduction<a class=td-heading-self-link href=#introduction aria-label="Heading self-link"></a></h1><p>Kafka® is a distributed, partitioned, replicated commit log service. It provides the functionality of a messaging system, but with a unique design.</p><p>What does all that mean?</p><p>First let&rsquo;s review some basic messaging terminology:</p><ul><li>Kafka maintains feeds of messages in categories called <em>topics</em>.</li><li>We&rsquo;ll call processes that publish messages to a Kafka topic <em>producers</em>.</li><li>We&rsquo;ll call processes that subscribe to topics and process the feed of published messages <em>consumers</em>..</li><li>Kafka is run as a cluster comprised of one or more servers each of which is called a <em>broker</em>.
So, at a high level, producers send messages over the network to the Kafka cluster which in turn serves them up to consumers like this:</li></ul><p><img src=../images/producer_consumer.png></p><p>Communication between the clients and the servers is done with a simple, high-performance, language agnostic <a href=https://cwiki.apache.org/confluence/display/KAFKA/A+Guide+To+The+Kafka+Protocol>TCP protocol</a>. We provide a Java client for Kafka, but clients are available in <a href=https://cwiki.apache.org/confluence/display/KAFKA/Clients>many languages</a>.</p><h2 id=topics-and-logs>Topics and Logs<a class=td-heading-self-link href=#topics-and-logs aria-label="Heading self-link"></a></h2><p>Let&rsquo;s first dive into the high-level abstraction Kafka provides&ndash;the topic.</p><p>A topic is a category or feed name to which messages are published. For each topic, the Kafka cluster maintains a partitioned log that looks like this:</p><p><img src=../images/log_anatomy.png></p><p>Each partition is an ordered, immutable sequence of messages that is continually appended to&ndash;a commit log. The messages in the partitions are each assigned a sequential id number called the <em>offset</em> that uniquely identifies each message within the partition.</p><p>The Kafka cluster retains all published messages&ndash;whether or not they have been consumed&ndash;for a configurable period of time. For example if the log retention is set to two days, then for the two days after a message is published it is available for consumption, after which it will be discarded to free up space. Kafka&rsquo;s performance is effectively constant with respect to data size so retaining lots of data is not a problem.</p><p>In fact the only metadata retained on a per-consumer basis is the position of the consumer in the log, called the &ldquo;offset&rdquo;. This offset is controlled by the consumer: normally a consumer will advance its offset linearly as it reads messages, but in fact the position is controlled by the consumer and it can consume messages in any order it likes. For example a consumer can reset to an older offset to reprocess.</p><p>This combination of features means that Kafka consumers are very cheap&ndash;they can come and go without much impact on the cluster or on other consumers. For example, you can use our command line tools to &ldquo;tail&rdquo; the contents of any topic without changing what is consumed by any existing consumers.</p><p>The partitions in the log serve several purposes. First, they allow the log to scale beyond a size that will fit on a single server. Each individual partition must fit on the servers that host it, but a topic may have many partitions so it can handle an arbitrary amount of data. Second they act as the unit of parallelism&ndash;more on that in a bit.</p><h2 id=distribution>Distribution<a class=td-heading-self-link href=#distribution aria-label="Heading self-link"></a></h2><p>The partitions of the log are distributed over the servers in the Kafka cluster with each server handling data and requests for a share of the partitions. Each partition is replicated across a configurable number of servers for fault tolerance.</p><p>Each partition has one server which acts as the &ldquo;leader&rdquo; and zero or more servers which act as &ldquo;followers&rdquo;. The leader handles all read and write requests for the partition while the followers passively replicate the leader. If the leader fails, one of the followers will automatically become the new leader. Each server acts as a leader for some of its partitions and a follower for others so load is well balanced within the cluster.</p><h2 id=producers>Producers<a class=td-heading-self-link href=#producers aria-label="Heading self-link"></a></h2><p>Producers publish data to the topics of their choice. The producer is responsible for choosing which message to assign to which partition within the topic. This can be done in a round-robin fashion simply to balance load or it can be done according to some semantic partition function (say based on some key in the message). More on the use of partitioning in a second.</p><h2 id=consumers>Consumers<a class=td-heading-self-link href=#consumers aria-label="Heading self-link"></a></h2><p>Messaging traditionally has two models: <a href=http://en.wikipedia.org/wiki/Message_queue>queuing</a> and <a href=http://en.wikipedia.org/wiki/Publish%E2%80%93subscribe_pattern>publish-subscribe</a>. In a queue, a pool of consumers may read from a server and each message goes to one of them; in publish-subscribe the message is broadcast to all consumers. Kafka offers a single consumer abstraction that generalizes both of these&ndash;the <em>consumer group</em>.</p><p>Consumers label themselves with a consumer group name, and each message published to a topic is delivered to one consumer instance within each subscribing consumer group. Consumer instances can be in separate processes or on separate machines.</p><p>If all the consumer instances have the same consumer group, then this works just like a traditional queue balancing load over the consumers.</p><p>If all the consumer instances have different consumer groups, then this works like publish-subscribe and all messages are broadcast to all consumers.</p><p>More commonly, however, we have found that topics have a small number of consumer groups, one for each &ldquo;logical subscriber&rdquo;. Each group is composed of many consumer instances for scalability and fault tolerance. This is nothing more than publish-subscribe semantics where the subscriber is cluster of consumers instead of a single process.</p><p><img src=../images/consumer-groups.png><br>A two server Kafka cluster hosting four partitions (P0-P3) with two consumer groups. Consumer group A has two consumer instances and group B has four.</p><p>Kafka has stronger ordering guarantees than a traditional messaging system, too.</p><p>A traditional queue retains messages in-order on the server, and if multiple consumers consume from the queue then the server hands out messages in the order they are stored. However, although the server hands out messages in order, the messages are delivered asynchronously to consumers, so they may arrive out of order on different consumers. This effectively means the ordering of the messages is lost in the presence of parallel consumption. Messaging systems often work around this by having a notion of &ldquo;exclusive consumer&rdquo; that allows only one process to consume from a queue, but of course this means that there is no parallelism in processing.</p><p>Kafka does it better. By having a notion of parallelism&ndash;the partition&ndash;within the topics, Kafka is able to provide both ordering guarantees and load balancing over a pool of consumer processes. This is achieved by assigning the partitions in the topic to the consumers in the consumer group so that each partition is consumed by exactly one consumer in the group. By doing this we ensure that the consumer is the only reader of that partition and consumes the data in order. Since there are many partitions this still balances the load over many consumer instances. Note however that there cannot be more consumer instances than partitions.</p><p>Kafka only provides a total order over messages <em>within</em> a partition, not between different partitions in a topic. Per-partition ordering combined with the ability to partition data by key is sufficient for most applications. However, if you require a total order over messages this can be achieved with a topic that has only one partition, though this will mean only one consumer process.</p><h2 id=guarantees>Guarantees<a class=td-heading-self-link href=#guarantees aria-label="Heading self-link"></a></h2><p>At a high-level Kafka gives the following guarantees:</p><ul><li>Messages sent by a producer to a particular topic partition will be appended in the order they are sent. That is, if a message M1 is sent by the same producer as a message M2, and M1 is sent first, then M1 will have a lower offset than M2 and appear earlier in the log.</li><li>A consumer instance sees messages in the order they are stored in the log.</li><li>For a topic with replication factor N, we will tolerate up to N-1 server failures without losing any messages committed to the log.
More details on these guarantees are given in the design section of the documentation.</li></ul></div><div class=td-content style=page-break-before:always><h1 id=pg-4488ed237a3565d836858ea5aa05ab9b>2 - Use Cases</h1><h1 id=use-cases>Use Cases<a class=td-heading-self-link href=#use-cases aria-label="Heading self-link"></a></h1><p>Here is a description of a few of the popular use cases for Apache Kafka. For an overview of a number of these areas in action, see <a href=http://engineering.linkedin.com/distributed-systems/log-what-every-software-engineer-should-know-about-real-time-datas-unifying>this blog post</a>.</p><h2 id=messaging>Messaging<a class=td-heading-self-link href=#messaging aria-label="Heading self-link"></a></h2><p>Kafka works well as a replacement for a more traditional message broker. Message brokers are used for a variety of reasons (to decouple processing from data producers, to buffer unprocessed messages, etc). In comparison to most messaging systems Kafka has better throughput, built-in partitioning, replication, and fault-tolerance which makes it a good solution for large scale message processing applications.</p><p>In our experience messaging uses are often comparatively low-throughput, but may require low end-to-end latency and often depend on the strong durability guarantees Kafka provides.</p><p>In this domain Kafka is comparable to traditional messaging systems such as <a href=http://activemq.apache.org>ActiveMQ</a> or <a href=https://www.rabbitmq.com>RabbitMQ</a>.</p><h2 id=website-activity-tracking>Website Activity Tracking<a class=td-heading-self-link href=#website-activity-tracking aria-label="Heading self-link"></a></h2><p>The original use case for Kafka was to be able to rebuild a user activity tracking pipeline as a set of real-time publish-subscribe feeds. This means site activity (page views, searches, or other actions users may take) is published to central topics with one topic per activity type. These feeds are available for subscription for a range of use cases including real-time processing, real-time monitoring, and loading into Hadoop or offline data warehousing systems for offline processing and reporting.</p><p>Activity tracking is often very high volume as many activity messages are generated for each user page view.</p><h2 id=metrics>Metrics<a class=td-heading-self-link href=#metrics aria-label="Heading self-link"></a></h2><p>Kafka is often used for operational monitoring data. This involves aggregating statistics from distributed applications to produce centralized feeds of operational data.</p><h2 id=log-aggregation>Log Aggregation<a class=td-heading-self-link href=#log-aggregation aria-label="Heading self-link"></a></h2><p>Many people use Kafka as a replacement for a log aggregation solution. Log aggregation typically collects physical log files off servers and puts them in a central place (a file server or HDFS perhaps) for processing. Kafka abstracts away the details of files and gives a cleaner abstraction of log or event data as a stream of messages. This allows for lower-latency processing and easier support for multiple data sources and distributed data consumption. In comparison to log-centric systems like Scribe or Flume, Kafka offers equally good performance, stronger durability guarantees due to replication, and much lower end-to-end latency.</p><h2 id=stream-processing>Stream Processing<a class=td-heading-self-link href=#stream-processing aria-label="Heading self-link"></a></h2><p>Many users end up doing stage-wise processing of data where data is consumed from topics of raw data and then aggregated, enriched, or otherwise transformed into new Kafka topics for further consumption. For example a processing flow for article recommendation might crawl article content from RSS feeds and publish it to an &ldquo;articles&rdquo; topic; further processing might help normalize or deduplicate this content to a topic of cleaned article content; a final stage might attempt to match this content to users. This creates a graph of real-time data flow out of the individual topics. <a href=https://github.com/nathanmarz/storm>Storm</a> and <a href=http://samza.incubator.apache.org/>Samza</a> are popular frameworks for implementing these kinds of transformations.</p><h2 id=event-sourcing>Event Sourcing<a class=td-heading-self-link href=#event-sourcing aria-label="Heading self-link"></a></h2><p><a href=http://martinfowler.com/eaaDev/EventSourcing.html>Event sourcing</a> is a style of application design where state changes are logged as a time-ordered sequence of records. Kafka&rsquo;s support for very large stored log data makes it an excellent backend for an application built in this style.</p><h2 id=commit-log>Commit Log<a class=td-heading-self-link href=#commit-log aria-label="Heading self-link"></a></h2><p>Kafka can serve as a kind of external commit-log for a distributed system. The log helps replicate data between nodes and acts as a re-syncing mechanism for failed nodes to restore their data. The <a href=/documentation.html#compaction>log compaction</a> feature in Kafka helps support this usage. In this usage Kafka is similar to <a href=http://zookeeper.apache.org/bookkeeper/>Apache BookKeeper</a> project.</p></div><div class=td-content style=page-break-before:always><h1 id=pg-14441834e512ddac7aa0606ed6c83649>3 - Quick Start</h1><h1 id=quick-start>Quick Start<a class=td-heading-self-link href=#quick-start aria-label="Heading self-link"></a></h1><p>This tutorial assumes you are starting fresh and have no existing Kafka or ZooKeeper data.</p><h2 id=step-1-download-the-code>Step 1: Download the code<a class=td-heading-self-link href=#step-1-download-the-code aria-label="Heading self-link"></a></h2><p><a href="https://www.apache.org/dyn/closer.cgi?path=/kafka/0.8.1.1/kafka_2.9.2-0.8.1.1.tgz" title="Kafka downloads">Download</a> the 0.8.1.1 release and un-tar it.</p><pre><code>&gt; **tar -xzf kafka_2.9.2-0.8.1.1.tgz**
&gt; **cd kafka_2.9.2-0.8.1.1**
</code></pre><h2 id=step-2-start-the-server>Step 2: Start the server<a class=td-heading-self-link href=#step-2-start-the-server aria-label="Heading self-link"></a></h2><p>Kafka uses ZooKeeper so you need to first start a ZooKeeper server if you don&rsquo;t already have one. You can use the convenience script packaged with kafka to get a quick-and-dirty single-node ZooKeeper instance.</p><pre><code>&gt; **bin/zookeeper-server-start.sh config/zookeeper.properties**
[2013-04-22 15:01:37,495] INFO Reading configuration from: config/zookeeper.properties (org.apache.zookeeper.server.quorum.QuorumPeerConfig)
...
</code></pre><p>Now start the Kafka server:</p><pre><code>&gt; **bin/kafka-server-start.sh config/server.properties**
[2013-04-22 15:01:47,028] INFO Verifying properties (kafka.utils.VerifiableProperties)
[2013-04-22 15:01:47,051] INFO Property socket.send.buffer.bytes is overridden to 1048576 (kafka.utils.VerifiableProperties)
...
</code></pre><h2 id=step-3-create-a-topic>Step 3: Create a topic<a class=td-heading-self-link href=#step-3-create-a-topic aria-label="Heading self-link"></a></h2><p>Let&rsquo;s create a topic named &ldquo;test&rdquo; with a single partition and only one replica:</p><pre><code>&gt; **bin/kafka-topics.sh --create --zookeeper localhost:2181 --replication-factor 1 --partitions 1 --topic test**
</code></pre><p>We can now see that topic if we run the list topic command:</p><pre><code>&gt; **bin/kafka-topics.sh --list --zookeeper localhost:2181**
test
</code></pre><p>Alternatively, instead of manually creating topics you can also configure your brokers to auto-create topics when a non-existent topic is published to.</p><h2 id=step-4-send-some-messages>Step 4: Send some messages<a class=td-heading-self-link href=#step-4-send-some-messages aria-label="Heading self-link"></a></h2><p>Kafka comes with a command line client that will take input from a file or from standard input and send it out as messages to the Kafka cluster. By default each line will be sent as a separate message.</p><p>Run the producer and then type a few messages into the console to send to the server.</p><pre><code>&gt; **bin/kafka-console-producer.sh --broker-list localhost:9092 --topic test** 
**This is a message**
**This is another message**
</code></pre><h2 id=step-5-start-a-consumer>Step 5: Start a consumer<a class=td-heading-self-link href=#step-5-start-a-consumer aria-label="Heading self-link"></a></h2><p>Kafka also has a command line consumer that will dump out messages to standard output.</p><pre><code>&gt; **bin/kafka-console-consumer.sh --zookeeper localhost:2181 --topic test --from-beginning**
This is a message
This is another message
</code></pre><p>If you have each of the above commands running in a different terminal then you should now be able to type messages into the producer terminal and see them appear in the consumer terminal.</p><p>All of the command line tools have additional options; running the command with no arguments will display usage information documenting them in more detail.</p><h2 id=step-6-setting-up-a-multi-broker-cluster>Step 6: Setting up a multi-broker cluster<a class=td-heading-self-link href=#step-6-setting-up-a-multi-broker-cluster aria-label="Heading self-link"></a></h2><p>So far we have been running against a single broker, but that&rsquo;s no fun. For Kafka, a single broker is just a cluster of size one, so nothing much changes other than starting a few more broker instances. But just to get feel for it, let&rsquo;s expand our cluster to three nodes (still all on our local machine).</p><p>First we make a config file for each of the brokers:</p><pre><code>&gt; **cp config/server.properties config/server-1.properties** 
&gt; **cp config/server.properties config/server-2.properties**
</code></pre><p>Now edit these new files and set the following properties:</p><pre><code>config/server-1.properties:
    broker.id=1
    port=9093
    log.dir=/tmp/kafka-logs-1
 
config/server-2.properties:
    broker.id=2
    port=9094
    log.dir=/tmp/kafka-logs-2
</code></pre><p>The <code>broker.id</code> property is the unique and permanent name of each node in the cluster. We have to override the port and log directory only because we are running these all on the same machine and we want to keep the brokers from all trying to register on the same port or overwrite each others data.</p><p>We already have Zookeeper and our single node started, so we just need to start the two new nodes:</p><pre><code>&gt; **bin/kafka-server-start.sh config/server-1.properties &amp;**
...
&gt; **bin/kafka-server-start.sh config/server-2.properties &amp;**
...
</code></pre><p>Now create a new topic with a replication factor of three:</p><pre><code>&gt; **bin/kafka-topics.sh --create --zookeeper localhost:2181 --replication-factor 3 --partitions 1 --topic my-replicated-topic**
</code></pre><p>Okay but now that we have a cluster how can we know which broker is doing what? To see that run the &ldquo;describe topics&rdquo; command:</p><pre><code>&gt; **bin/kafka-topics.sh --describe --zookeeper localhost:2181 --topic my-replicated-topic**
Topic:my-replicated-topic	PartitionCount:1	ReplicationFactor:3	Configs:
	Topic: my-replicated-topic	Partition: 0	Leader: 1	Replicas: 1,2,0	Isr: 1,2,0
</code></pre><p>Here is an explanation of output. The first line gives a summary of all the partitions, each additional line gives information about one partition. Since we have only one partition for this topic there is only one line.</p><ul><li>&ldquo;leader&rdquo; is the node responsible for all reads and writes for the given partition. Each node will be the leader for a randomly selected portion of the partitions.</li><li>&ldquo;replicas&rdquo; is the list of nodes that replicate the log for this partition regardless of whether they are the leader or even if they are currently alive.</li><li>&ldquo;isr&rdquo; is the set of &ldquo;in-sync&rdquo; replicas. This is the subset of the replicas list that is currently alive and caught-up to the leader.
Note that in my example node 1 is the leader for the only partition of the topic.</li></ul><p>We can run the same command on the original topic we created to see where it is:</p><pre><code>&gt; **bin/kafka-topics.sh --describe --zookeeper localhost:2181 --topic test**
Topic:test	PartitionCount:1	ReplicationFactor:1	Configs:
	Topic: test	Partition: 0	Leader: 0	Replicas: 0	Isr: 0
</code></pre><p>So there is no surprise there&ndash;the original topic has no replicas and is on server 0, the only server in our cluster when we created it.</p><p>Let&rsquo;s publish a few messages to our new topic:</p><pre><code>&gt; **bin/kafka-console-producer.sh --broker-list localhost:9092 --topic my-replicated-topic**
...
**my test message 1**
**my test message 2**
**^C** 
</code></pre><p>Now let&rsquo;s consume these messages:</p><pre><code>&gt; **bin/kafka-console-consumer.sh --zookeeper localhost:2181 --from-beginning --topic my-replicated-topic**
...
my test message 1
my test message 2
**^C**
</code></pre><p>Now let&rsquo;s test out fault-tolerance. Broker 1 was acting as the leader so let&rsquo;s kill it:</p><pre><code>&gt; **ps | grep server-1.properties**
_7564_ ttys002    0:15.91 /System/Library/Frameworks/JavaVM.framework/Versions/1.6/Home/bin/java...
&gt; **kill -9 7564**
</code></pre><p>Leadership has switched to one of the slaves and node 1 is no longer in the in-sync replica set:</p><pre><code>&gt; **bin/kafka-topics.sh --describe --zookeeper localhost:2181 --topic my-replicated-topic**
Topic:my-replicated-topic	PartitionCount:1	ReplicationFactor:3	Configs:
	Topic: my-replicated-topic	Partition: 0	Leader: 2	Replicas: 1,2,0	Isr: 2,0
</code></pre><p>But the messages are still be available for consumption even though the leader that took the writes originally is down:</p><pre><code>&gt; **bin/kafka-console-consumer.sh --zookeeper localhost:2181 --from-beginning --topic my-replicated-topic**
...
my test message 1
my test message 2
**^C**
</code></pre></div><div class=td-content style=page-break-before:always><h1 id=pg-04f3d5dc48c23c037512e2b45744d169>4 - Ecosystem</h1><h1 id=ecosystem>Ecosystem<a class=td-heading-self-link href=#ecosystem aria-label="Heading self-link"></a></h1><p>There are a plethora of tools that integrate with Kafka outside the main distribution. The <a href=https://cwiki.apache.org/confluence/display/KAFKA/Ecosystem>ecosystem page</a> lists many of these, including stream processing systems, Hadoop integration, monitoring, and deployment tools.</p></div><div class=td-content style=page-break-before:always><h1 id=pg-11bd4117e7eb80bc7f8b0df4713cc111>5 - Upgrading</h1><h1 id=upgrading-from-previous-versions>Upgrading From Previous Versions<a class=td-heading-self-link href=#upgrading-from-previous-versions aria-label="Heading self-link"></a></h1><h2 id=upgrading-from-080-to-081>Upgrading from 0.8.0 to 0.8.1<a class=td-heading-self-link href=#upgrading-from-080-to-081 aria-label="Heading self-link"></a></h2><p>0.8.1 is fully compatible with 0.8. The upgrade can be done one broker at a time by simply bringing it down, updating the code, and restarting it.</p><h2 id=upgrading-from-07>Upgrading from 0.7<a class=td-heading-self-link href=#upgrading-from-07 aria-label="Heading self-link"></a></h2><p>0.8, the release in which added replication, was our first backwards-incompatible release: major changes were made to the API, ZooKeeper data structures, and protocol, and configuration. The upgrade from 0.7 to 0.8.x requires a <a href=https://cwiki.apache.org/confluence/display/KAFKA/Migrating+from+0.7+to+0.8>special tool</a> for migration. This migration can be done without downtime.</p></div></main></div></div><footer class="td-footer row d-print-none"><div class=container-fluid><div class="row mx-md-2"><div class="td-footer__left col-6 col-sm-4 order-sm-1"><ul class=td-footer__links-list><li class=td-footer__links-item data-bs-toggle=tooltip title=Contact aria-label=Contact><a target=_blank rel=noopener href=/community/contact/ aria-label=Contact><i class="fa fa-envelope"></i></a></li><li class=td-footer__links-item data-bs-toggle=tooltip title=Twitter aria-label=Twitter><a target=_blank rel=noopener href=https://twitter.com/apachekafka aria-label=Twitter><i class="fab fa-twitter"></i></a></li><li class=td-footer__links-item data-bs-toggle=tooltip title="Stack Overflow" aria-label="Stack Overflow"><a target=_blank rel=noopener href=https://stackoverflow.com/questions/tagged/apache-kafka aria-label="Stack Overflow"><i class="fab fa-stack-overflow"></i></a></li></ul></div><div class="td-footer__right col-6 col-sm-4 order-sm-3"><ul class=td-footer__links-list><li class=td-footer__links-item data-bs-toggle=tooltip title=GitHub aria-label=GitHub><a target=_blank rel=noopener href=https://github.com/apache/kafka aria-label=GitHub><i class="fab fa-github"></i></a></li><li class=td-footer__links-item data-bs-toggle=tooltip title="Developer mailing list" aria-label="Developer mailing list"><a target=_blank rel=noopener href=mailto:dev@kafka.apache.org aria-label="Developer mailing list"><i class="fa fa-envelope"></i></a></li></ul></div><div class="td-footer__center col-12 col-sm-4 py-2 order-sm-2"><span class=td-footer__copyright>&copy;
2014&ndash;2025
<span class=td-footer__authors>By <a href=https://www.apache.org/>Apache Software Foundation</a> under the terms of the <a href=https://www.apache.org/licenses/LICENSE-2.0>Apache License v2</a></span></span><span class=td-footer__all_rights_reserved>All Rights Reserved</span><span class=ms-2><a href=https://privacy.apache.org/policies/privacy-policy-public.html target=_blank rel=noopener>Privacy Policy</a></span></div></div></div></footer></div><script src=/js/main.min.dc2c0119076a0df855e55a8044ce0de74b7b9033c20e853e22d7ec7e9bdde965.js integrity="sha256-3CwBGQdqDfhV5VqARM4N50t7kDPCDoU+Itfsfpvd6WU=" crossorigin=anonymous></script><script defer src=/js/click-to-copy.min.73478a7d4807698aed7e355eb23f9890ca18fea3158604c8471746d046702bad.js integrity="sha256-c0eKfUgHaYrtfjVesj+YkMoY/qMVhgTIRxdG0EZwK60=" crossorigin=anonymous></script><script src=/js/tabpane-persist.js></script></body></html>
<!doctype html><html itemscope itemtype=http://schema.org/WebPage lang=en class=no-js><head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><meta name=robots content="index, follow"><link rel="shortcut icon" href=/favicons/favicon.ico><link rel=apple-touch-icon href=/favicons/apple-touch-icon-180x180.png sizes=180x180><link rel=icon type=image/png href=/favicons/favicon-16x16.png sizes=16x16><link rel=icon type=image/png href=/favicons/favicon-32x32.png sizes=32x32><link rel=icon type=image/png href=/favicons/android-36x36.png sizes=36x36><link rel=icon type=image/png href=/favicons/android-48x48.png sizes=48x48><link rel=icon type=image/png href=/favicons/android-72x72.png sizes=72x72><link rel=icon type=image/png href=/favicons/android-96x96.png sizes=96x96><link rel=icon type=image/png href=/favicons/android-144x144.png sizes=144x144><link rel=icon type=image/png href=/favicons/android-192x192.png sizes=192x192><title>Upgrading | </title><meta name=description content="Upgrading from 0.8.x, 0.9.x, 0.10.0.x, 0.10.1.x, 0.10.2.x or 0.11.0.x to 1.0.0 Kafka 1.0.0 introduces wire protocol changes. By following the recommended rolling upgrade plan below, you guarantee no downtime during the upgrade. However, please review the notable changes in 1.0.0 before upgrading.
For a rolling upgrade:
Update server.properties on all brokers and add the following properties. CURRENT_KAFKA_VERSION refers to the version you are upgrading from. CURRENT_MESSAGE_FORMAT_VERSION refers to the message format version currently in use."><meta property="og:title" content="Upgrading"><meta property="og:description" content="Upgrading from 0.8.x, 0.9.x, 0.10.0.x, 0.10.1.x, 0.10.2.x or 0.11.0.x to 1.0.0 Kafka 1.0.0 introduces wire protocol changes. By following the recommended rolling upgrade plan below, you guarantee no downtime during the upgrade. However, please review the notable changes in 1.0.0 before upgrading.
For a rolling upgrade:
Update server.properties on all brokers and add the following properties. CURRENT_KAFKA_VERSION refers to the version you are upgrading from. CURRENT_MESSAGE_FORMAT_VERSION refers to the message format version currently in use."><meta property="og:type" content="article"><meta property="og:url" content="https://example.kafka-site-md.dev/10/getting-started/upgrade/"><meta property="article:section" content="10"><meta property="article:modified_time" content="2025-01-03T16:06:33-08:00"><meta itemprop=name content="Upgrading"><meta itemprop=description content="Upgrading from 0.8.x, 0.9.x, 0.10.0.x, 0.10.1.x, 0.10.2.x or 0.11.0.x to 1.0.0 Kafka 1.0.0 introduces wire protocol changes. By following the recommended rolling upgrade plan below, you guarantee no downtime during the upgrade. However, please review the notable changes in 1.0.0 before upgrading.
For a rolling upgrade:
Update server.properties on all brokers and add the following properties. CURRENT_KAFKA_VERSION refers to the version you are upgrading from. CURRENT_MESSAGE_FORMAT_VERSION refers to the message format version currently in use."><meta itemprop=dateModified content="2025-01-03T16:06:33-08:00"><meta itemprop=wordCount content="8523"><meta itemprop=keywords content="kafka,docs,"><meta name=twitter:card content="summary"><meta name=twitter:title content="Upgrading"><meta name=twitter:description content="Upgrading from 0.8.x, 0.9.x, 0.10.0.x, 0.10.1.x, 0.10.2.x or 0.11.0.x to 1.0.0 Kafka 1.0.0 introduces wire protocol changes. By following the recommended rolling upgrade plan below, you guarantee no downtime during the upgrade. However, please review the notable changes in 1.0.0 before upgrading.
For a rolling upgrade:
Update server.properties on all brokers and add the following properties. CURRENT_KAFKA_VERSION refers to the version you are upgrading from. CURRENT_MESSAGE_FORMAT_VERSION refers to the message format version currently in use."><link rel=preload href=/scss/main.min.7ed0eb3fc68a0678ca492e0db9c00f8e8d5b776bbb2fb833732191f6bbf02877.css as=style integrity="sha256-ftDrP8aKBnjKSS4NucAPjo1bd2u7L7gzcyGR9rvwKHc=" crossorigin=anonymous><link href=/scss/main.min.7ed0eb3fc68a0678ca492e0db9c00f8e8d5b776bbb2fb833732191f6bbf02877.css rel=stylesheet integrity="sha256-ftDrP8aKBnjKSS4NucAPjo1bd2u7L7gzcyGR9rvwKHc=" crossorigin=anonymous><script src=https://code.jquery.com/jquery-3.7.1.min.js integrity="sha512-v2CJ7UaYy4JwqLDIrZUI/4hqeoQieOmAZNXBeQyjo21dadnwR+8ZaIJVT8EE2iyI61OV8e6M8PP2/4hpQINQ/g==" crossorigin=anonymous></script><script defer src=https://unpkg.com/lunr@2.3.9/lunr.min.js integrity=sha384-203J0SNzyqHby3iU6hzvzltrWi/M41wOP5Gu+BiJMz5nwKykbkUx8Kp7iti0Lpli crossorigin=anonymous></script></head><body class=td-page><header><nav class="td-navbar js-navbar-scroll" data-bs-theme=dark><div class="container-fluid flex-column flex-md-row"><a class=navbar-brand href=/><span class="navbar-brand__logo navbar-logo"><svg width="154" height="250" viewBox="0 0 256 416" xmlns="http://www.w3.org/2000/svg" preserveAspectRatio="xMidYMid"><path d="M201.816 230.216c-16.186.0-30.697 7.171-40.634 18.461l-25.463-18.026c2.703-7.442 4.255-15.433 4.255-23.797.0-8.219-1.498-16.076-4.112-23.408l25.406-17.835c9.936 11.233 24.409 18.365 40.548 18.365 29.875.0 54.184-24.305 54.184-54.184.0-29.879-24.309-54.184-54.184-54.184s-54.184 24.305-54.184 54.184c0 5.348.808 10.505 2.258 15.389l-25.423 17.844c-10.62-13.175-25.911-22.374-43.333-25.182v-30.64c24.544-5.155 43.037-26.962 43.037-53.019C124.171 24.305 99.862.0 69.987.0 40.112.0 15.803 24.305 15.803 54.184c0 25.708 18.014 47.246 42.067 52.769v31.038C25.044 143.753.0 172.401.0 206.854c0 34.621 25.292 63.374 58.355 68.94v32.774c-24.299 5.341-42.552 27.011-42.552 52.894.0 29.879 24.309 54.184 54.184 54.184s54.184-24.305 54.184-54.184c0-25.883-18.253-47.553-42.552-52.894v-32.775a69.965 69.965.0 0042.6-24.776l25.633 18.143c-1.423 4.84-2.22 9.946-2.22 15.24.0 29.879 24.309 54.184 54.184 54.184S256 314.279 256 284.4c0-29.879-24.309-54.184-54.184-54.184zm0-126.695c14.487.0 26.27 11.788 26.27 26.271s-11.783 26.27-26.27 26.27-26.27-11.787-26.27-26.27 11.783-26.271 26.27-26.271zm-158.1-49.337c0-14.483 11.784-26.27 26.271-26.27s26.27 11.787 26.27 26.27c0 14.483-11.783 26.27-26.27 26.27s-26.271-11.787-26.271-26.27zm52.541 307.278c0 14.483-11.783 26.27-26.27 26.27s-26.271-11.787-26.271-26.27 11.784-26.27 26.271-26.27 26.27 11.787 26.27 26.27zm-26.272-117.97c-20.205.0-36.642-16.434-36.642-36.638.0-20.205 16.437-36.642 36.642-36.642 20.204.0 36.641 16.437 36.641 36.642.0 20.204-16.437 36.638-36.641 36.638zm131.831 67.179c-14.487.0-26.27-11.788-26.27-26.271s11.783-26.27 26.27-26.27 26.27 11.787 26.27 26.27-11.783 26.271-26.27 26.271z" style="fill:#231f20"/></svg></span><span class=navbar-brand__name></span></a><div class="td-navbar-nav-scroll ms-md-auto" id=main_navbar><ul class=navbar-nav><li class=nav-item><a class=nav-link href=/41/><span>Documentation</span></a></li><li class=nav-item><a class=nav-link href=/blog/><span>Blog</span></a></li><li class=nav-item><a class=nav-link href=/community/><span>Community</span></a></li><li class=nav-item><a class=nav-link href=/testimonials/><span>Testimonials</span></a></li><li class=nav-item><a class=nav-link href=/community/downloads/><span>Download Kafka</span></a></li><li class="nav-item dropdown d-none d-lg-block"><div class=dropdown><a class="nav-link dropdown-toggle" href=# role=button data-bs-toggle=dropdown aria-haspopup=true aria-expanded=false>Releases</a><ul class=dropdown-menu><li><a class=dropdown-item href=/41/>4.1</a></li><li><a class=dropdown-item href=/40/>4.0</a></li><li><a class=dropdown-item href=/39/>3.9</a></li><li><a class=dropdown-item href=/38/>3.8</a></li><li><a class=dropdown-item href=/37/>3.7</a></li><li><a class=dropdown-item href=/36/>3.6</a></li><li><a class=dropdown-item href=/35/>3.5</a></li><li><a class=dropdown-item href=/34/>3.4</a></li><li><a class=dropdown-item href=/33/>3.3</a></li><li><a class=dropdown-item href=/32/>3.2</a></li><li><a class=dropdown-item href=/31/>3.1</a></li><li><a class=dropdown-item href=/30/>3.0</a></li><li><a class=dropdown-item href=/28/>2.8</a></li><li><a class=dropdown-item href=/27/>2.7</a></li><li><a class=dropdown-item href=/26/>2.6</a></li><li><a class=dropdown-item href=/25/>2.5</a></li><li><a class=dropdown-item href=/24/>2.4</a></li><li><a class=dropdown-item href=/23/>2.3</a></li><li><a class=dropdown-item href=/22/>2.2</a></li><li><a class=dropdown-item href=/21/>2.1</a></li><li><a class=dropdown-item href=/20/>2.0</a></li><li><a class=dropdown-item href=/11/>1.1</a></li><li><a class=dropdown-item href=/10/>1.0</a></li><li><a class=dropdown-item href=/0110/>0.11.0</a></li><li><a class=dropdown-item href=/0102/>0.10.2</a></li><li><a class=dropdown-item href=/0101/>0.10.1</a></li><li><a class=dropdown-item href=/0100/>0.10.0</a></li><li><a class=dropdown-item href=/090/>0.9.0</a></li><li><a class=dropdown-item href=/082/>0.8.2</a></li><li><a class=dropdown-item href=/081/>0.8.1</a></li><li><a class=dropdown-item href=/080/>0.8.0</a></li><li><a class=dropdown-item href=/07/>0.7</a></li></ul></div></li></ul></div><div class="d-none d-lg-block"><div class="td-search td-search--offline"><div class=td-search__icon></div><input type=search class="td-search__input form-control" placeholder="Search this site…" aria-label="Search this site…" autocomplete=off data-offline-search-index-json-src=/offline-search-index.a770465805a0cb46ff1e57a8f55b44bc.json data-offline-search-base-href=/ data-offline-search-max-results=10></div></div></div></nav></header><div class="container-fluid td-outer"><div class=td-main><div class="row flex-xl-nowrap"><aside class="col-12 col-md-3 col-xl-2 td-sidebar d-print-none"><div id=td-sidebar-menu class=td-sidebar__inner><div id=content-mobile><form class="td-sidebar__search d-flex align-items-center"><div class="td-search td-search--offline"><div class=td-search__icon></div><input type=search class="td-search__input form-control" placeholder="Search this site…" aria-label="Search this site…" autocomplete=off data-offline-search-index-json-src=/offline-search-index.a770465805a0cb46ff1e57a8f55b44bc.json data-offline-search-base-href=/ data-offline-search-max-results=10></div><button class="btn btn-link td-sidebar__toggle d-md-none p-0 ms-3 fas fa-bars" type=button data-bs-toggle=collapse data-bs-target=#td-section-nav aria-controls=td-section-nav aria-expanded=false aria-label="Toggle section navigation"></button></form></div><div id=content-desktop></div><nav class="td-sidebar-nav collapse td-sidebar-nav--search-disabled foldable-nav" id=td-section-nav><ul class="td-sidebar-nav__section pe-md-3 ul-0"><li class="td-sidebar-nav__section-title td-sidebar-nav__section with-child active-path" id=m-10-li><a href=/10/ class="align-left ps-0 td-sidebar-link td-sidebar-link__section tree-root" id=m-10><span>AK 1.0.X</span></a><ul class=ul-1><li class="td-sidebar-nav__section-title td-sidebar-nav__section with-child active-path" id=m-10getting-started-li><input type=checkbox id=m-10getting-started-check checked>
<label for=m-10getting-started-check><a href=/10/getting-started/ class="align-left ps-0 td-sidebar-link td-sidebar-link__section" id=m-10getting-started><span>Getting Started</span></a></label><ul class="ul-2 foldable"><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-10getting-startedintroduction-li><input type=checkbox id=m-10getting-startedintroduction-check>
<label for=m-10getting-startedintroduction-check><a href=/10/getting-started/introduction/ class="align-left ps-0 td-sidebar-link td-sidebar-link__page" id=m-10getting-startedintroduction><span>Introduction</span></a></label></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-10getting-starteduses-li><input type=checkbox id=m-10getting-starteduses-check>
<label for=m-10getting-starteduses-check><a href=/10/getting-started/uses/ class="align-left ps-0 td-sidebar-link td-sidebar-link__page" id=m-10getting-starteduses><span>Use Cases</span></a></label></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-10getting-startedquickstart-li><input type=checkbox id=m-10getting-startedquickstart-check>
<label for=m-10getting-startedquickstart-check><a href=/10/getting-started/quickstart/ class="align-left ps-0 td-sidebar-link td-sidebar-link__page" id=m-10getting-startedquickstart><span>Quick Start</span></a></label></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-10getting-startedecosystem-li><input type=checkbox id=m-10getting-startedecosystem-check>
<label for=m-10getting-startedecosystem-check><a href=/10/getting-started/ecosystem/ class="align-left ps-0 td-sidebar-link td-sidebar-link__page" id=m-10getting-startedecosystem><span>Ecosystem</span></a></label></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child active-path" id=m-10getting-startedupgrade-li><input type=checkbox id=m-10getting-startedupgrade-check checked>
<label for=m-10getting-startedupgrade-check><a href=/10/getting-started/upgrade/ class="align-left ps-0 active td-sidebar-link td-sidebar-link__page" id=m-10getting-startedupgrade><span class=td-sidebar-nav-active-item>Upgrading</span></a></label></li></ul></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section with-child" id=m-10apis-li><input type=checkbox id=m-10apis-check>
<label for=m-10apis-check><a href=/10/apis/ class="align-left ps-0 td-sidebar-link td-sidebar-link__section" id=m-10apis><span>APIs</span></a></label><ul class="ul-2 foldable"><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-10apisapi-li><input type=checkbox id=m-10apisapi-check>
<label for=m-10apisapi-check><a href=/10/apis/api/ class="align-left ps-0 td-sidebar-link td-sidebar-link__page" id=m-10apisapi><span>API</span></a></label></li></ul></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section with-child" id=m-10configuration-li><input type=checkbox id=m-10configuration-check>
<label for=m-10configuration-check><a href=/10/configuration/ class="align-left ps-0 td-sidebar-link td-sidebar-link__section" id=m-10configuration><span>Configuration</span></a></label><ul class="ul-2 foldable"><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-10configurationconfiguration-li><input type=checkbox id=m-10configurationconfiguration-check>
<label for=m-10configurationconfiguration-check><a href=/10/configuration/configuration/ class="align-left ps-0 td-sidebar-link td-sidebar-link__page" id=m-10configurationconfiguration><span>Configuration</span></a></label></li></ul></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section with-child" id=m-10design-li><input type=checkbox id=m-10design-check>
<label for=m-10design-check><a href=/10/design/ class="align-left ps-0 td-sidebar-link td-sidebar-link__section" id=m-10design><span>Design</span></a></label><ul class="ul-2 foldable"><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-10designdesign-li><input type=checkbox id=m-10designdesign-check>
<label for=m-10designdesign-check><a href=/10/design/design/ class="align-left ps-0 td-sidebar-link td-sidebar-link__page" id=m-10designdesign><span>Design</span></a></label></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-10designprotocol-li><input type=checkbox id=m-10designprotocol-check>
<label for=m-10designprotocol-check><a href=/10/design/protocol/ class="align-left ps-0 td-sidebar-link td-sidebar-link__page" id=m-10designprotocol><span>Protocol</span></a></label></li></ul></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section with-child" id=m-10implementation-li><input type=checkbox id=m-10implementation-check>
<label for=m-10implementation-check><a href=/10/implementation/ class="align-left ps-0 td-sidebar-link td-sidebar-link__section" id=m-10implementation><span>Implementation</span></a></label><ul class="ul-2 foldable"><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-10implementationnetwork-layer-li><input type=checkbox id=m-10implementationnetwork-layer-check>
<label for=m-10implementationnetwork-layer-check><a href=/10/implementation/network-layer/ class="align-left ps-0 td-sidebar-link td-sidebar-link__page" id=m-10implementationnetwork-layer><span>Network Layer</span></a></label></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-10implementationmessages-li><input type=checkbox id=m-10implementationmessages-check>
<label for=m-10implementationmessages-check><a href=/10/implementation/messages/ class="align-left ps-0 td-sidebar-link td-sidebar-link__page" id=m-10implementationmessages><span>Messages</span></a></label></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-10implementationmessage-format-li><input type=checkbox id=m-10implementationmessage-format-check>
<label for=m-10implementationmessage-format-check><a href=/10/implementation/message-format/ class="align-left ps-0 td-sidebar-link td-sidebar-link__page" id=m-10implementationmessage-format><span>Message Format</span></a></label></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-10implementationlog-li><input type=checkbox id=m-10implementationlog-check>
<label for=m-10implementationlog-check><a href=/10/implementation/log/ class="align-left ps-0 td-sidebar-link td-sidebar-link__page" id=m-10implementationlog><span>Log</span></a></label></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-10implementationdistribution-li><input type=checkbox id=m-10implementationdistribution-check>
<label for=m-10implementationdistribution-check><a href=/10/implementation/distribution/ class="align-left ps-0 td-sidebar-link td-sidebar-link__page" id=m-10implementationdistribution><span>Distribution</span></a></label></li></ul></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section with-child" id=m-10operations-li><input type=checkbox id=m-10operations-check>
<label for=m-10operations-check><a href=/10/operations/ class="align-left ps-0 td-sidebar-link td-sidebar-link__section" id=m-10operations><span>Operations</span></a></label><ul class="ul-2 foldable"><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-10operationsbasic-kafka-operations-li><input type=checkbox id=m-10operationsbasic-kafka-operations-check>
<label for=m-10operationsbasic-kafka-operations-check><a href=/10/operations/basic-kafka-operations/ class="align-left ps-0 td-sidebar-link td-sidebar-link__page" id=m-10operationsbasic-kafka-operations><span>Basic Kafka Operations</span></a></label></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-10operationsdatacenters-li><input type=checkbox id=m-10operationsdatacenters-check>
<label for=m-10operationsdatacenters-check><a href=/10/operations/datacenters/ class="align-left ps-0 td-sidebar-link td-sidebar-link__page" id=m-10operationsdatacenters><span>Datacenters</span></a></label></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-10operationskafka-configuration-li><input type=checkbox id=m-10operationskafka-configuration-check>
<label for=m-10operationskafka-configuration-check><a href=/10/operations/kafka-configuration/ class="align-left ps-0 td-sidebar-link td-sidebar-link__page" id=m-10operationskafka-configuration><span>Kafka Configuration</span></a></label></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-10operationsjava-version-li><input type=checkbox id=m-10operationsjava-version-check>
<label for=m-10operationsjava-version-check><a href=/10/operations/java-version/ class="align-left ps-0 td-sidebar-link td-sidebar-link__page" id=m-10operationsjava-version><span>Java Version</span></a></label></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-10operationshardware-and-os-li><input type=checkbox id=m-10operationshardware-and-os-check>
<label for=m-10operationshardware-and-os-check><a href=/10/operations/hardware-and-os/ class="align-left ps-0 td-sidebar-link td-sidebar-link__page" id=m-10operationshardware-and-os><span>Hardware and OS</span></a></label></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-10operationsmonitoring-li><input type=checkbox id=m-10operationsmonitoring-check>
<label for=m-10operationsmonitoring-check><a href=/10/operations/monitoring/ class="align-left ps-0 td-sidebar-link td-sidebar-link__page" id=m-10operationsmonitoring><span>Monitoring</span></a></label></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-10operationszookeeper-li><input type=checkbox id=m-10operationszookeeper-check>
<label for=m-10operationszookeeper-check><a href=/10/operations/zookeeper/ class="align-left ps-0 td-sidebar-link td-sidebar-link__page" id=m-10operationszookeeper><span>ZooKeeper</span></a></label></li></ul></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section with-child" id=m-10security-li><input type=checkbox id=m-10security-check>
<label for=m-10security-check><a href=/10/security/ class="align-left ps-0 td-sidebar-link td-sidebar-link__section" id=m-10security><span>Security</span></a></label><ul class="ul-2 foldable"><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-10securitysecurity-overview-li><input type=checkbox id=m-10securitysecurity-overview-check>
<label for=m-10securitysecurity-overview-check><a href=/10/security/security-overview/ class="align-left ps-0 td-sidebar-link td-sidebar-link__page" id=m-10securitysecurity-overview><span>Security Overview</span></a></label></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-10securityencryption-and-authentication-using-ssl-li><input type=checkbox id=m-10securityencryption-and-authentication-using-ssl-check>
<label for=m-10securityencryption-and-authentication-using-ssl-check><a href=/10/security/encryption-and-authentication-using-ssl/ class="align-left ps-0 td-sidebar-link td-sidebar-link__page" id=m-10securityencryption-and-authentication-using-ssl><span>Encryption and Authentication using SSL</span></a></label></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-10securityauthentication-using-sasl-li><input type=checkbox id=m-10securityauthentication-using-sasl-check>
<label for=m-10securityauthentication-using-sasl-check><a href=/10/security/authentication-using-sasl/ class="align-left ps-0 td-sidebar-link td-sidebar-link__page" id=m-10securityauthentication-using-sasl><span>Authentication using SASL</span></a></label></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-10securityauthorization-and-acls-li><input type=checkbox id=m-10securityauthorization-and-acls-check>
<label for=m-10securityauthorization-and-acls-check><a href=/10/security/authorization-and-acls/ class="align-left ps-0 td-sidebar-link td-sidebar-link__page" id=m-10securityauthorization-and-acls><span>Authorization and ACLs</span></a></label></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-10securityincorporating-security-features-in-a-running-cluster-li><input type=checkbox id=m-10securityincorporating-security-features-in-a-running-cluster-check>
<label for=m-10securityincorporating-security-features-in-a-running-cluster-check><a href=/10/security/incorporating-security-features-in-a-running-cluster/ class="align-left ps-0 td-sidebar-link td-sidebar-link__page" id=m-10securityincorporating-security-features-in-a-running-cluster><span>Incorporating Security Features in a Running Cluster</span></a></label></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-10securityzookeeper-authentication-li><input type=checkbox id=m-10securityzookeeper-authentication-check>
<label for=m-10securityzookeeper-authentication-check><a href=/10/security/zookeeper-authentication/ class="align-left ps-0 td-sidebar-link td-sidebar-link__page" id=m-10securityzookeeper-authentication><span>ZooKeeper Authentication</span></a></label></li></ul></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section with-child" id=m-10kafka-connect-li><input type=checkbox id=m-10kafka-connect-check>
<label for=m-10kafka-connect-check><a href=/10/kafka-connect/ class="align-left ps-0 td-sidebar-link td-sidebar-link__section" id=m-10kafka-connect><span>Kafka Connect</span></a></label><ul class="ul-2 foldable"><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-10kafka-connectoverview-li><input type=checkbox id=m-10kafka-connectoverview-check>
<label for=m-10kafka-connectoverview-check><a href=/10/kafka-connect/overview/ class="align-left ps-0 td-sidebar-link td-sidebar-link__page" id=m-10kafka-connectoverview><span>Overview</span></a></label></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-10kafka-connectuser-guide-li><input type=checkbox id=m-10kafka-connectuser-guide-check>
<label for=m-10kafka-connectuser-guide-check><a href=/10/kafka-connect/user-guide/ class="align-left ps-0 td-sidebar-link td-sidebar-link__page" id=m-10kafka-connectuser-guide><span>User Guide</span></a></label></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-10kafka-connectconnector-development-guide-li><input type=checkbox id=m-10kafka-connectconnector-development-guide-check>
<label for=m-10kafka-connectconnector-development-guide-check><a href=/10/kafka-connect/connector-development-guide/ class="align-left ps-0 td-sidebar-link td-sidebar-link__page" id=m-10kafka-connectconnector-development-guide><span>Connector Development Guide</span></a></label></li></ul></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section with-child" id=m-10streams-li><input type=checkbox id=m-10streams-check>
<label for=m-10streams-check><a href=/10/streams/ class="align-left ps-0 td-sidebar-link td-sidebar-link__section" id=m-10streams><span>Kafka Streams</span></a></label><ul class="ul-2 foldable"><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-10streamsintroduction-li><input type=checkbox id=m-10streamsintroduction-check>
<label for=m-10streamsintroduction-check><a href=/10/streams/introduction/ class="align-left ps-0 td-sidebar-link td-sidebar-link__page" id=m-10streamsintroduction><span>Introduction</span></a></label></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-10streamsquickstart-li><input type=checkbox id=m-10streamsquickstart-check>
<label for=m-10streamsquickstart-check><a href=/10/streams/quickstart/ class="align-left ps-0 td-sidebar-link td-sidebar-link__page" id=m-10streamsquickstart><span>Quick Start</span></a></label></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-10streamstutorial-li><input type=checkbox id=m-10streamstutorial-check>
<label for=m-10streamstutorial-check><a href=/10/streams/tutorial/ class="align-left ps-0 td-sidebar-link td-sidebar-link__page" id=m-10streamstutorial><span>Write a streams app</span></a></label></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-10streamscore-concepts-li><input type=checkbox id=m-10streamscore-concepts-check>
<label for=m-10streamscore-concepts-check><a href=/10/streams/core-concepts/ class="align-left ps-0 td-sidebar-link td-sidebar-link__page" id=m-10streamscore-concepts><span>Core Concepts</span></a></label></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-10streamsarchitecture-li><input type=checkbox id=m-10streamsarchitecture-check>
<label for=m-10streamsarchitecture-check><a href=/10/streams/architecture/ class="align-left ps-0 td-sidebar-link td-sidebar-link__page" id=m-10streamsarchitecture><span>Architecture</span></a></label></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-10streamsupgrade-guide-li><input type=checkbox id=m-10streamsupgrade-guide-check>
<label for=m-10streamsupgrade-guide-check><a href=/10/streams/upgrade-guide/ class="align-left ps-0 td-sidebar-link td-sidebar-link__page" id=m-10streamsupgrade-guide><span>Upgrade Guide</span></a></label></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section with-child" id=m-10streamsdeveloper-guide-li><input type=checkbox id=m-10streamsdeveloper-guide-check>
<label for=m-10streamsdeveloper-guide-check><a href=/10/streams/developer-guide/ class="align-left ps-0 td-sidebar-link td-sidebar-link__section" id=m-10streamsdeveloper-guide><span>Streams Developer Guide</span></a></label><ul class="ul-3 foldable"><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-10streamsdeveloper-guidewrite-streams-app-li><input type=checkbox id=m-10streamsdeveloper-guidewrite-streams-app-check>
<label for=m-10streamsdeveloper-guidewrite-streams-app-check><a href=/10/streams/developer-guide/write-streams-app/ class="align-left ps-0 td-sidebar-link td-sidebar-link__page" id=m-10streamsdeveloper-guidewrite-streams-app><span>Writing a Streams Application</span></a></label></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-10streamsdeveloper-guideconfig-streams-li><input type=checkbox id=m-10streamsdeveloper-guideconfig-streams-check>
<label for=m-10streamsdeveloper-guideconfig-streams-check><a href=/10/streams/developer-guide/config-streams/ class="align-left ps-0 td-sidebar-link td-sidebar-link__page" id=m-10streamsdeveloper-guideconfig-streams><span>Configuring a Streams Application</span></a></label></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-10streamsdeveloper-guidedsl-api-li><input type=checkbox id=m-10streamsdeveloper-guidedsl-api-check>
<label for=m-10streamsdeveloper-guidedsl-api-check><a href=/10/streams/developer-guide/dsl-api/ class="align-left ps-0 td-sidebar-link td-sidebar-link__page" id=m-10streamsdeveloper-guidedsl-api><span>Streams DSL</span></a></label></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-10streamsdeveloper-guideprocessor-api-li><input type=checkbox id=m-10streamsdeveloper-guideprocessor-api-check>
<label for=m-10streamsdeveloper-guideprocessor-api-check><a href=/10/streams/developer-guide/processor-api/ class="align-left ps-0 td-sidebar-link td-sidebar-link__page" id=m-10streamsdeveloper-guideprocessor-api><span>Processor API</span></a></label></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-10streamsdeveloper-guidedatatypes-li><input type=checkbox id=m-10streamsdeveloper-guidedatatypes-check>
<label for=m-10streamsdeveloper-guidedatatypes-check><a href=/10/streams/developer-guide/datatypes/ class="align-left ps-0 td-sidebar-link td-sidebar-link__page" id=m-10streamsdeveloper-guidedatatypes><span>Data Types and Serialization</span></a></label></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-10streamsdeveloper-guideinteractive-queries-li><input type=checkbox id=m-10streamsdeveloper-guideinteractive-queries-check>
<label for=m-10streamsdeveloper-guideinteractive-queries-check><a href=/10/streams/developer-guide/interactive-queries/ class="align-left ps-0 td-sidebar-link td-sidebar-link__page" id=m-10streamsdeveloper-guideinteractive-queries><span>Interactive Queries</span></a></label></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-10streamsdeveloper-guidememory-mgmt-li><input type=checkbox id=m-10streamsdeveloper-guidememory-mgmt-check>
<label for=m-10streamsdeveloper-guidememory-mgmt-check><a href=/10/streams/developer-guide/memory-mgmt/ class="align-left ps-0 td-sidebar-link td-sidebar-link__page" id=m-10streamsdeveloper-guidememory-mgmt><span>Memory Management</span></a></label></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-10streamsdeveloper-guiderunning-app-li><input type=checkbox id=m-10streamsdeveloper-guiderunning-app-check>
<label for=m-10streamsdeveloper-guiderunning-app-check><a href=/10/streams/developer-guide/running-app/ class="align-left ps-0 td-sidebar-link td-sidebar-link__page" id=m-10streamsdeveloper-guiderunning-app><span>Running Streams Applications</span></a></label></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-10streamsdeveloper-guidemanage-topics-li><input type=checkbox id=m-10streamsdeveloper-guidemanage-topics-check>
<label for=m-10streamsdeveloper-guidemanage-topics-check><a href=/10/streams/developer-guide/manage-topics/ class="align-left ps-0 td-sidebar-link td-sidebar-link__page" id=m-10streamsdeveloper-guidemanage-topics><span>Managing Streams Application Topics</span></a></label></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-10streamsdeveloper-guidesecurity-li><input type=checkbox id=m-10streamsdeveloper-guidesecurity-check>
<label for=m-10streamsdeveloper-guidesecurity-check><a href=/10/streams/developer-guide/security/ class="align-left ps-0 td-sidebar-link td-sidebar-link__page" id=m-10streamsdeveloper-guidesecurity><span>Streams Security</span></a></label></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-10streamsdeveloper-guideapp-reset-tool-li><input type=checkbox id=m-10streamsdeveloper-guideapp-reset-tool-check>
<label for=m-10streamsdeveloper-guideapp-reset-tool-check><a href=/10/streams/developer-guide/app-reset-tool/ class="align-left ps-0 td-sidebar-link td-sidebar-link__page" id=m-10streamsdeveloper-guideapp-reset-tool><span>Application Reset Tool</span></a></label></li></ul></li></ul></li></ul></li></ul></nav></div></aside><aside class="d-none d-xl-block col-xl-2 td-sidebar-toc d-print-none"><div class="td-page-meta ms-2 pb-1 pt-2 mb-0"><a href=https://github.com/apache/kafka-site//tree/markdown/content/en/10/getting-started/upgrade.md class="td-page-meta--view td-page-meta__view" target=_blank rel=noopener><i class="fa-solid fa-file-lines fa-fw"></i> View page source</a>
<a href=https://github.com/apache/kafka-site//edit/markdown/content/en/10/getting-started/upgrade.md class="td-page-meta--edit td-page-meta__edit" target=_blank rel=noopener><i class="fa-solid fa-pen-to-square fa-fw"></i> Edit this page</a>
<a href="https://github.com/apache/kafka-site//new/markdown/content/en/10/getting-started?filename=change-me.md&amp;value=---%0Atitle%3A+%22Long+Page+Title%22%0AlinkTitle%3A+%22Short+Nav+Title%22%0Aweight%3A+100%0Adescription%3A+%3E-%0A+++++Page+description+for+heading+and+indexes.%0A---%0A%0A%23%23+Heading%0A%0AEdit+this+template+to+create+your+new+page.%0A%0A%2A+Give+it+a+good+name%2C+ending+in+%60.md%60+-+e.g.+%60getting-started.md%60%0A%2A+Edit+the+%22front+matter%22+section+at+the+top+of+the+page+%28weight+controls+how+its+ordered+amongst+other+pages+in+the+same+directory%3B+lowest+number+first%29.%0A%2A+Add+a+good+commit+message+at+the+bottom+of+the+page+%28%3C80+characters%3B+use+the+extended+description+field+for+more+detail%29.%0A%2A+Create+a+new+branch+so+you+can+preview+your+new+file+and+request+a+review+via+Pull+Request.%0A" class="td-page-meta--child td-page-meta__child" target=_blank rel=noopener><i class="fa-solid fa-pen-to-square fa-fw"></i> Create child page</a>
<a href="https://github.com/apache/kafka-site//issues/new?title=Upgrading" class="td-page-meta--issue td-page-meta__issue" target=_blank rel=noopener><i class="fa-solid fa-list-check fa-fw"></i> Create documentation issue</a>
<a id=print href=/10/getting-started/_print/><i class="fa-solid fa-print fa-fw"></i> Print entire section</a></div><div class=td-toc><nav id=TableOfContents><ul><li><a href=#upgrading-from-08x-09x-0100x-0101x-0102x-or-0110x-to-100>Upgrading from 0.8.x, 0.9.x, 0.10.0.x, 0.10.1.x, 0.10.2.x or 0.11.0.x to 1.0.0</a><ul><li><a href=#notable-changes-in-101>Notable changes in 1.0.1</a></li><li><a href=#notable-changes-in-100>Notable changes in 1.0.0</a></li><li><a href=#new-protocol-versions>New Protocol Versions</a></li><li><a href=#upgrading-a-0110-kafka-streams-application>Upgrading a 0.11.0 Kafka Streams Application</a></li><li><a href=#upgrading-a-0102-kafka-streams-application>Upgrading a 0.10.2 Kafka Streams Application</a></li><li><a href=#upgrading-a-0101-kafka-streams-application>Upgrading a 0.10.1 Kafka Streams Application</a></li><li><a href=#upgrading-a-0100-kafka-streams-application>Upgrading a 0.10.0 Kafka Streams Application</a></li><li><a href=#notable-changes-in-102>Notable changes in 1.0.2</a></li></ul></li><li><a href=#upgrading-from-08x-09x-0100x-0101x-or-0102x-to-01100>Upgrading from 0.8.x, 0.9.x, 0.10.0.x, 0.10.1.x or 0.10.2.x to 0.11.0.0</a><ul><li><a href=#upgrading-a-0102-kafka-streams-application-1>Upgrading a 0.10.2 Kafka Streams Application</a></li><li><a href=#upgrading-a-0101-kafka-streams-application-1>Upgrading a 0.10.1 Kafka Streams Application</a></li><li><a href=#upgrading-a-0100-kafka-streams-application-1>Upgrading a 0.10.0 Kafka Streams Application</a></li><li><a href=#notable-changes-in-01103>Notable changes in 0.11.0.3</a></li><li><a href=#notable-changes-in-01100>Notable changes in 0.11.0.0</a></li><li><a href=#new-protocol-versions-1>New Protocol Versions</a></li><li><a href=#notes-on-exactly-once-semantics>Notes on Exactly Once Semantics</a></li><li><a href=#notes-on-the-new-message-format-in-0110>Notes on the new message format in 0.11.0</a></li></ul></li><li><a href=#upgrading-from-08x-09x-0100x-or-0101x-to-01020>Upgrading from 0.8.x, 0.9.x, 0.10.0.x or 0.10.1.x to 0.10.2.0</a><ul><li><a href=#upgrading-a-0101-kafka-streams-application-2>Upgrading a 0.10.1 Kafka Streams Application</a></li><li><a href=#upgrading-a-0100-kafka-streams-application-2>Upgrading a 0.10.0 Kafka Streams Application</a></li><li><a href=#notable-changes-in-01022>Notable changes in 0.10.2.2</a></li><li><a href=#notable-changes-in-01021>Notable changes in 0.10.2.1</a></li><li><a href=#notable-changes-in-01020>Notable changes in 0.10.2.0</a></li><li><a href=#new-protocol-versions-2>New Protocol Versions</a></li></ul></li><li><a href=#upgrading-from-08x-09x-or-0100x-to-01010>Upgrading from 0.8.x, 0.9.x or 0.10.0.X to 0.10.1.0</a><ul><li><a href=#potential-breaking-changes-in-01010>Potential breaking changes in 0.10.1.0</a></li><li><a href=#upgrading-a-0100-kafka-streams-application-3>Upgrading a 0.10.0 Kafka Streams Application</a></li><li><a href=#notable-changes-in-01010>Notable changes in 0.10.1.0</a></li><li><a href=#new-protocol-versions-3>New Protocol Versions</a></li></ul></li><li><a href=#upgrading-from-08x-or-09x-to-01000>Upgrading from 0.8.x or 0.9.x to 0.10.0.0</a><ul><li><a href=#potential-performance-impact-following-upgrade-to-01000>Potential performance impact following upgrade to 0.10.0.0</a></li><li><a href=#potential-breaking-changes-in-01000>Potential breaking changes in 0.10.0.0</a></li><li><a href=#notable-changes-in-01000>Notable changes in 0.10.0.0</a></li></ul></li><li><a href=#upgrading-from-080-081x-or-082x-to-0900>Upgrading from 0.8.0, 0.8.1.X or 0.8.2.X to 0.9.0.0</a><ul><li><a href=#potential-breaking-changes-in-0900>Potential breaking changes in 0.9.0.0</a></li><li><a href=#notable-changes-in-0901>Notable changes in 0.9.0.1</a></li><li><a href=#deprecations-in-0900>Deprecations in 0.9.0.0</a></li></ul></li><li><a href=#upgrading-from-081-to-082>Upgrading from 0.8.1 to 0.8.2</a></li><li><a href=#upgrading-from-080-to-081>Upgrading from 0.8.0 to 0.8.1</a></li><li><a href=#upgrading-from-07>Upgrading from 0.7</a></li></ul></nav></div><div class="taxonomy taxonomy-terms-cloud taxo-tags"><h5 class=taxonomy-title>Tag Cloud</h5><ul class=taxonomy-terms><li><a class=taxonomy-term href=https://example.kafka-site-md.dev/tags/apis/ data-taxonomy-term=apis><span class=taxonomy-label>Apis</span><span class=taxonomy-count>32</span></a></li><li><a class=taxonomy-term href=https://example.kafka-site-md.dev/tags/configuration/ data-taxonomy-term=configuration><span class=taxonomy-label>Configuration</span><span class=taxonomy-count>32</span></a></li><li><a class=taxonomy-term href=https://example.kafka-site-md.dev/tags/design/ data-taxonomy-term=design><span class=taxonomy-label>Design</span><span class=taxonomy-count>32</span></a></li><li><a class=taxonomy-term href=https://example.kafka-site-md.dev/tags/developer-guide/ data-taxonomy-term=developer-guide><span class=taxonomy-label>Developer-Guide</span><span class=taxonomy-count>32</span></a></li><li><a class=taxonomy-term href=https://example.kafka-site-md.dev/tags/docs/ data-taxonomy-term=docs><span class=taxonomy-label>Docs</span><span class=taxonomy-count>1781</span></a></li><li><a class=taxonomy-term href=https://example.kafka-site-md.dev/tags/getting-started/ data-taxonomy-term=getting-started><span class=taxonomy-label>Getting-Started</span><span class=taxonomy-count>32</span></a></li><li><a class=taxonomy-term href=https://example.kafka-site-md.dev/tags/implementation/ data-taxonomy-term=implementation><span class=taxonomy-label>Implementation</span><span class=taxonomy-count>32</span></a></li><li><a class=taxonomy-term href=https://example.kafka-site-md.dev/tags/kafka/ data-taxonomy-term=kafka><span class=taxonomy-label>Kafka</span><span class=taxonomy-count>1781</span></a></li><li><a class=taxonomy-term href=https://example.kafka-site-md.dev/tags/ops/ data-taxonomy-term=ops><span class=taxonomy-label>Ops</span><span class=taxonomy-count>32</span></a></li><li><a class=taxonomy-term href=https://example.kafka-site-md.dev/tags/security/ data-taxonomy-term=security><span class=taxonomy-label>Security</span><span class=taxonomy-count>64</span></a></li><li><a class=taxonomy-term href=https://example.kafka-site-md.dev/tags/streams/ data-taxonomy-term=streams><span class=taxonomy-label>Streams</span><span class=taxonomy-count>64</span></a></li></ul></div></aside><main class="col-12 col-md-9 col-xl-8 ps-md-5" role=main><div class="pageinfo pageinfo-warning"><p>You are viewing documentation for an older version (1.0) of Kafka.
For up-to-date documentation, see the
<a href=/41/ target=_blank>latest version</a>.</p></div><nav aria-label=breadcrumb class=td-breadcrumbs><ol class=breadcrumb><li class=breadcrumb-item><a href=/10/>AK 1.0.X</a></li><li class=breadcrumb-item><a href=/10/getting-started/>Getting Started</a></li><li class="breadcrumb-item active" aria-current=page>Upgrading</li></ol></nav><div class=td-content><h1>Upgrading</h1><header class=article-meta><div class="taxonomy taxonomy-terms-article taxo-tags"><h5 class=taxonomy-title>Tags:</h5><ul class=taxonomy-terms><li><a class=taxonomy-term href=https://example.kafka-site-md.dev/tags/kafka/ data-taxonomy-term=kafka><span class=taxonomy-label>Kafka</span></a></li><li><a class=taxonomy-term href=https://example.kafka-site-md.dev/tags/docs/ data-taxonomy-term=docs><span class=taxonomy-label>Docs</span></a></li></ul></div></header><h2 id=upgrading-from-08x-09x-0100x-0101x-0102x-or-0110x-to-100>Upgrading from 0.8.x, 0.9.x, 0.10.0.x, 0.10.1.x, 0.10.2.x or 0.11.0.x to 1.0.0<a class=td-heading-self-link href=#upgrading-from-08x-09x-0100x-0101x-0102x-or-0110x-to-100 aria-label="Heading self-link"></a></h2><p>Kafka 1.0.0 introduces wire protocol changes. By following the recommended rolling upgrade plan below, you guarantee no downtime during the upgrade. However, please review the notable changes in 1.0.0 before upgrading.</p><p><strong>For a rolling upgrade:</strong></p><ol><li>Update server.properties on all brokers and add the following properties. CURRENT_KAFKA_VERSION refers to the version you are upgrading from. CURRENT_MESSAGE_FORMAT_VERSION refers to the message format version currently in use. If you have previously overridden the message format version, you should keep its current value. Alternatively, if you are upgrading from a version prior to 0.11.0.x, then CURRENT_MESSAGE_FORMAT_VERSION should be set to match CURRENT_KAFKA_VERSION.<ul><li>inter.broker.protocol.version=CURRENT_KAFKA_VERSION (e.g. 0.8.2, 0.9.0, 0.10.0, 0.10.1, 0.10.2, 0.11.0).</li><li>log.message.format.version=CURRENT_MESSAGE_FORMAT_VERSION (See potential performance impact following the upgrade for the details on what this configuration does.)
If you are upgrading from 0.11.0.x and you have not overridden the message format, you must set both the message format version and the inter-broker protocol version to 0.11.0.</li><li>inter.broker.protocol.version=0.11.0</li><li>log.message.format.version=0.11.0</li></ul></li><li>Upgrade the brokers one at a time: shut down the broker, update the code, and restart it.</li><li>Once the entire cluster is upgraded, bump the protocol version by editing <code>inter.broker.protocol.version</code> and setting it to 1.0.</li><li>Restart the brokers one by one for the new protocol version to take effect.</li><li>If you have overridden the message format version as instructed above, then you need to do one more rolling restart to upgrade it to its latest version. Once all (or most) consumers have been upgraded to 0.11.0 or later, change log.message.format.version to 1.0 on each broker and restart them one by one. If you are upgrading from 0.11.0 and log.message.format.version is set to 0.11.0, you can update the config and skip the rolling restart. Note that the older Scala consumer does not support the new message format introduced in 0.11, so to avoid the performance cost of down-conversion (or to take advantage of exactly once semantics), the newer Java consumer must be used.</li></ol><p><strong>Additional Upgrade Notes:</strong></p><ol><li>If you are willing to accept downtime, you can simply take all the brokers down, update the code and start them back up. They will start with the new protocol by default.</li><li>Bumping the protocol version and restarting can be done any time after the brokers are upgraded. It does not have to be immediately after. Similarly for the message format version.</li></ol><h3 id=notable-changes-in-101>Notable changes in 1.0.1<a class=td-heading-self-link href=#notable-changes-in-101 aria-label="Heading self-link"></a></h3><ul><li>Restored binary compatibility of AdminClient&rsquo;s Options classes (e.g. CreateTopicsOptions, DeleteTopicsOptions, etc.) with 0.11.0.x. Binary (but not source) compatibility had been broken inadvertently in 1.0.0.</li></ul><h3 id=notable-changes-in-100>Notable changes in 1.0.0<a class=td-heading-self-link href=#notable-changes-in-100 aria-label="Heading self-link"></a></h3><ul><li>Topic deletion is now enabled by default, since the functionality is now stable. Users who wish to to retain the previous behavior should set the broker config <code>delete.topic.enable</code> to <code>false</code>. Keep in mind that topic deletion removes data and the operation is not reversible (i.e. there is no &ldquo;undelete&rdquo; operation)</li><li>For topics that support timestamp search if no offset can be found for a partition, that partition is now included in the search result with a null offset value. Previously, the partition was not included in the map. This change was made to make the search behavior consistent with the case of topics not supporting timestamp search.</li><li>If the <code>inter.broker.protocol.version</code> is 1.0 or later, a broker will now stay online to serve replicas on live log directories even if there are offline log directories. A log directory may become offline due to IOException caused by hardware failure. Users need to monitor the per-broker metric <code>offlineLogDirectoryCount</code> to check whether there is offline log directory.</li><li>Added KafkaStorageException which is a retriable exception. KafkaStorageException will be converted to NotLeaderForPartitionException in the response if the version of client&rsquo;s FetchRequest or ProducerRequest does not support KafkaStorageException.</li><li>-XX:+DisableExplicitGC was replaced by -XX:+ExplicitGCInvokesConcurrent in the default JVM settings. This helps avoid out of memory exceptions during allocation of native memory by direct buffers in some cases.</li><li>The overridden <code>handleError</code> method implementations have been removed from the following deprecated classes in the <code>kafka.api</code> package: <code>FetchRequest</code>, <code>GroupCoordinatorRequest</code>, <code>OffsetCommitRequest</code>, <code>OffsetFetchRequest</code>, <code>OffsetRequest</code>, <code>ProducerRequest</code>, and <code>TopicMetadataRequest</code>. This was only intended for use on the broker, but it is no longer in use and the implementations have not been maintained. A stub implementation has been retained for binary compatibility.</li><li>The Java clients and tools now accept any string as a client-id.</li><li>The deprecated tool <code>kafka-consumer-offset-checker.sh</code> has been removed. Use <code>kafka-consumer-groups.sh</code> to get consumer group details.</li><li>SimpleAclAuthorizer now logs access denials to the authorizer log by default.</li><li>Authentication failures are now reported to clients as one of the subclasses of <code>AuthenticationException</code>. No retries will be performed if a client connection fails authentication.</li><li>Custom <code>SaslServer</code> implementations may throw <code>SaslAuthenticationException</code> to provide an error message to return to clients indicating the reason for authentication failure. Implementors should take care not to include any security-critical information in the exception message that should not be leaked to unauthenticated clients.</li><li>The <code>app-info</code> mbean registered with JMX to provide version and commit id will be deprecated and replaced with metrics providing these attributes.</li><li>Kafka metrics may now contain non-numeric values. <code>org.apache.kafka.common.Metric#value()</code> has been deprecated and will return <code>0.0</code> in such cases to minimise the probability of breaking users who read the value of every client metric (via a <code>MetricsReporter</code> implementation or by calling the <code>metrics()</code> method). <code>org.apache.kafka.common.Metric#metricValue()</code> can be used to retrieve numeric and non-numeric metric values.</li><li>Every Kafka rate metric now has a corresponding cumulative count metric with the suffix <code>-total</code> to simplify downstream processing. For example, <code>records-consumed-rate</code> has a corresponding metric named <code>records-consumed-total</code>.</li><li>Mx4j will only be enabled if the system property <code>kafka_mx4jenable</code> is set to <code>true</code>. Due to a logic inversion bug, it was previously enabled by default and disabled if <code>kafka_mx4jenable</code> was set to <code>true</code>.</li><li>The package <code>org.apache.kafka.common.security.auth</code> in the clients jar has been made public and added to the javadocs. Internal classes which had previously been located in this package have been moved elsewhere.</li><li>When using an Authorizer and a user doesn&rsquo;t have required permissions on a topic, the broker will return TOPIC_AUTHORIZATION_FAILED errors to requests irrespective of topic existence on broker. If the user have required permissions and the topic doesn&rsquo;t exists, then the UNKNOWN_TOPIC_OR_PARTITION error code will be returned.</li><li>config/consumer.properties file updated to use new consumer config properties.</li></ul><h3 id=new-protocol-versions>New Protocol Versions<a class=td-heading-self-link href=#new-protocol-versions aria-label="Heading self-link"></a></h3><ul><li><a href=https://cwiki.apache.org/confluence/display/KAFKA/KIP-112%3A+Handle+disk+failure+for+JBOD>KIP-112</a>: LeaderAndIsrRequest v1 introduces a partition-level <code>is_new</code> field.</li><li><a href=https://cwiki.apache.org/confluence/display/KAFKA/KIP-112%3A+Handle+disk+failure+for+JBOD>KIP-112</a>: UpdateMetadataRequest v4 introduces a partition-level <code>offline_replicas</code> field.</li><li><a href=https://cwiki.apache.org/confluence/display/KAFKA/KIP-112%3A+Handle+disk+failure+for+JBOD>KIP-112</a>: MetadataResponse v5 introduces a partition-level <code>offline_replicas</code> field.</li><li><a href=https://cwiki.apache.org/confluence/display/KAFKA/KIP-112%3A+Handle+disk+failure+for+JBOD>KIP-112</a>: ProduceResponse v4 introduces error code for KafkaStorageException.</li><li><a href=https://cwiki.apache.org/confluence/display/KAFKA/KIP-112%3A+Handle+disk+failure+for+JBOD>KIP-112</a>: FetchResponse v6 introduces error code for KafkaStorageException.</li><li><a href=https://cwiki.apache.org/confluence/display/KAFKA/KIP-152+-+Improve+diagnostics+for+SASL+authentication+failures>KIP-152</a>: SaslAuthenticate request has been added to enable reporting of authentication failures. This request will be used if the SaslHandshake request version is greater than 0.</li></ul><h3 id=upgrading-a-0110-kafka-streams-application>Upgrading a 0.11.0 Kafka Streams Application<a class=td-heading-self-link href=#upgrading-a-0110-kafka-streams-application aria-label="Heading self-link"></a></h3><ul><li>Upgrading your Streams application from 0.11.0 to 1.0 does not require a broker upgrade. A Kafka Streams 1.0 application can connect to 0.11.0, 0.10.2 and 0.10.1 brokers (it is not possible to connect to 0.10.0 brokers though). However, Kafka Streams 1.0 requires 0.10 message format or newer and does not work with older message formats.</li><li>If you are monitoring on streams metrics, you will need make some changes to the metrics names in your reporting and monitoring code, because the metrics sensor hierarchy was changed.</li><li>There are a few public APIs including <code>ProcessorContext#schedule()</code>, <code>Processor#punctuate()</code> and <code>KStreamBuilder</code>, <code>TopologyBuilder</code> are being deprecated by new APIs. We recommend making corresponding code changes, which should be very minor since the new APIs look quite similar, when you upgrade.</li><li>See <a href=/10/streams/upgrade-guide/#streams_api_changes_100>Streams API changes in 1.0.0</a> for more details.</li></ul><h3 id=upgrading-a-0102-kafka-streams-application>Upgrading a 0.10.2 Kafka Streams Application<a class=td-heading-self-link href=#upgrading-a-0102-kafka-streams-application aria-label="Heading self-link"></a></h3><ul><li>Upgrading your Streams application from 0.10.2 to 1.0 does not require a broker upgrade. A Kafka Streams 1.0 application can connect to 1.0, 0.11.0, 0.10.2 and 0.10.1 brokers (it is not possible to connect to 0.10.0 brokers though).</li><li>If you are monitoring on streams metrics, you will need make some changes to the metrics names in your reporting and monitoring code, because the metrics sensor hierarchy was changed.</li><li>There are a few public APIs including <code>ProcessorContext#schedule()</code>, <code>Processor#punctuate()</code> and <code>KStreamBuilder</code>, <code>TopologyBuilder</code> are being deprecated by new APIs. We recommend making corresponding code changes, which should be very minor since the new APIs look quite similar, when you upgrade.</li><li>If you specify customized <code>key.serde</code>, <code>value.serde</code> and <code>timestamp.extractor</code> in configs, it is recommended to use their replaced configure parameter as these configs are deprecated.</li><li>See <a href=/10/streams/upgrade-guide/#streams_api_changes_0110>Streams API changes in 0.11.0</a> for more details.</li></ul><h3 id=upgrading-a-0101-kafka-streams-application>Upgrading a 0.10.1 Kafka Streams Application<a class=td-heading-self-link href=#upgrading-a-0101-kafka-streams-application aria-label="Heading self-link"></a></h3><ul><li>Upgrading your Streams application from 0.10.1 to 1.0 does not require a broker upgrade. A Kafka Streams 1.0 application can connect to 1.0, 0.11.0, 0.10.2 and 0.10.1 brokers (it is not possible to connect to 0.10.0 brokers though).</li><li>You need to recompile your code. Just swapping the Kafka Streams library jar file will not work and will break your application.</li><li>If you are monitoring on streams metrics, you will need make some changes to the metrics names in your reporting and monitoring code, because the metrics sensor hierarchy was changed.</li><li>There are a few public APIs including <code>ProcessorContext#schedule()</code>, <code>Processor#punctuate()</code> and <code>KStreamBuilder</code>, <code>TopologyBuilder</code> are being deprecated by new APIs. We recommend making corresponding code changes, which should be very minor since the new APIs look quite similar, when you upgrade.</li><li>If you specify customized <code>key.serde</code>, <code>value.serde</code> and <code>timestamp.extractor</code> in configs, it is recommended to use their replaced configure parameter as these configs are deprecated.</li><li>If you use a custom (i.e., user implemented) timestamp extractor, you will need to update this code, because the <code>TimestampExtractor</code> interface was changed.</li><li>If you register custom metrics, you will need to update this code, because the <code>StreamsMetric</code> interface was changed.</li><li>See <a href=/10/streams/upgrade-guide/#streams_api_changes_100>Streams API changes in 1.0.0</a>, <a href=/10/streams/upgrade-guide/#streams_api_changes_0110>Streams API changes in 0.11.0</a> and <a href=/10/streams/upgrade-guide/#streams_api_changes_0102>Streams API changes in 0.10.2</a> for more details.</li></ul><h3 id=upgrading-a-0100-kafka-streams-application>Upgrading a 0.10.0 Kafka Streams Application<a class=td-heading-self-link href=#upgrading-a-0100-kafka-streams-application aria-label="Heading self-link"></a></h3><ul><li>Upgrading your Streams application from 0.10.0 to 1.0 does require a broker upgrade because a Kafka Streams 1.0 application can only connect to 0.1, 0.11.0, 0.10.2, or 0.10.1 brokers.</li><li>There are couple of API changes, that are not backward compatible (cf. <a href=/10/streams/upgrade-guide/#streams_api_changes_100>Streams API changes in 1.0.0</a>, <a href=/10/streams/#streams_api_changes_0110>Streams API changes in 0.11.0</a>, <a href=/10/streams/#streams_api_changes_0102>Streams API changes in 0.10.2</a>, and <a href=/10/streams/#streams_api_changes_0101>Streams API changes in 0.10.1</a> for more details). Thus, you need to update and recompile your code. Just swapping the Kafka Streams library jar file will not work and will break your application.</li><li>Upgrading from 0.10.0.x to 1.0.2 requires two rolling bounces with config <code>upgrade.from="0.10.0"</code> set for first upgrade phase (cf. <a href=https://cwiki.apache.org/confluence/display/KAFKA/KIP-268%3A+Simplify+Kafka+Streams+Rebalance+Metadata+Upgrade>KIP-268</a>). As an alternative, an offline upgrade is also possible.<ul><li>prepare your application instances for a rolling bounce and make sure that config <code>upgrade.from</code> is set to <code>"0.10.0"</code> for new version 0.11.0.3</li><li>bounce each instance of your application once</li><li>prepare your newly deployed 1.0.2 application instances for a second round of rolling bounces; make sure to remove the value for config <code>upgrade.mode</code></li><li>bounce each instance of your application once more to complete the upgrade</li></ul></li><li>Upgrading from 0.10.0.x to 1.0.0 or 1.0.1 requires an offline upgrade (rolling bounce upgrade is not supported)<ul><li>stop all old (0.10.0.x) application instances</li><li>update your code and swap old code and jar file with new code and new jar file</li><li>restart all new (1.0.0 or 1.0.1) application instances</li></ul></li></ul><h3 id=notable-changes-in-102>Notable changes in 1.0.2<a class=td-heading-self-link href=#notable-changes-in-102 aria-label="Heading self-link"></a></h3><ul><li>New Kafka Streams configuration parameter <code>upgrade.from</code> added that allows rolling bounce upgrade from version 0.10.0.x</li><li>See the <a href=/10/streams/upgrade-guide/><strong>Kafka Streams upgrade guide</strong></a> for details about this new config.</li></ul><h2 id=upgrading-from-08x-09x-0100x-0101x-or-0102x-to-01100>Upgrading from 0.8.x, 0.9.x, 0.10.0.x, 0.10.1.x or 0.10.2.x to 0.11.0.0<a class=td-heading-self-link href=#upgrading-from-08x-09x-0100x-0101x-or-0102x-to-01100 aria-label="Heading self-link"></a></h2><p>Kafka 0.11.0.0 introduces a new message format version as well as wire protocol changes. By following the recommended rolling upgrade plan below, you guarantee no downtime during the upgrade. However, please review the notable changes in 0.11.0.0 before upgrading.</p><p>Starting with version 0.10.2, Java clients (producer and consumer) have acquired the ability to communicate with older brokers. Version 0.11.0 clients can talk to version 0.10.0 or newer brokers. However, if your brokers are older than 0.10.0, you must upgrade all the brokers in the Kafka cluster before upgrading your clients. Version 0.11.0 brokers support 0.8.x and newer clients.</p><p><strong>For a rolling upgrade:</strong></p><ol><li>Update server.properties on all brokers and add the following properties. CURRENT_KAFKA_VERSION refers to the version you are upgrading from. CURRENT_MESSAGE_FORMAT_VERSION refers to the current message format version currently in use. If you have not overridden the message format previously, then CURRENT_MESSAGE_FORMAT_VERSION should be set to match CURRENT_KAFKA_VERSION.<ul><li>inter.broker.protocol.version=CURRENT_KAFKA_VERSION (e.g. 0.8.2, 0.9.0, 0.10.0, 0.10.1 or 0.10.2).</li><li>log.message.format.version=CURRENT_MESSAGE_FORMAT_VERSION (See potential performance impact following the upgrade for the details on what this configuration does.)</li></ul></li><li>Upgrade the brokers one at a time: shut down the broker, update the code, and restart it.</li><li>Once the entire cluster is upgraded, bump the protocol version by editing <code>inter.broker.protocol.version</code> and setting it to 0.11.0, but do not change <code>log.message.format.version</code> yet.</li><li>Restart the brokers one by one for the new protocol version to take effect.</li><li>Once all (or most) consumers have been upgraded to 0.11.0 or later, then change log.message.format.version to 0.11.0 on each broker and restart them one by one. Note that the older Scala consumer does not support the new message format, so to avoid the performance cost of down-conversion (or to take advantage of exactly once semantics), the new Java consumer must be used.</li></ol><p><strong>Additional Upgrade Notes:</strong></p><ol><li>If you are willing to accept downtime, you can simply take all the brokers down, update the code and start them back up. They will start with the new protocol by default.</li><li>Bumping the protocol version and restarting can be done any time after the brokers are upgraded. It does not have to be immediately after. Similarly for the message format version.</li><li>It is also possible to enable the 0.11.0 message format on individual topics using the topic admin tool (<code>bin/kafka-topics.sh</code>) prior to updating the global setting <code>log.message.format.version</code>.</li><li>If you are upgrading from a version prior to 0.10.0, it is NOT necessary to first update the message format to 0.10.0 before you switch to 0.11.0.</li></ol><h3 id=upgrading-a-0102-kafka-streams-application-1>Upgrading a 0.10.2 Kafka Streams Application<a class=td-heading-self-link href=#upgrading-a-0102-kafka-streams-application-1 aria-label="Heading self-link"></a></h3><ul><li>Upgrading your Streams application from 0.10.2 to 0.11.0 does not require a broker upgrade. A Kafka Streams 0.11.0 application can connect to 0.11.0, 0.10.2 and 0.10.1 brokers (it is not possible to connect to 0.10.0 brokers though).</li><li>If you specify customized <code>key.serde</code>, <code>value.serde</code> and <code>timestamp.extractor</code> in configs, it is recommended to use their replaced configure parameter as these configs are deprecated.</li><li>See <a href=/10/streams/upgrade-guide/#streams_api_changes_0110>Streams API changes in 0.11.0</a> for more details.</li></ul><h3 id=upgrading-a-0101-kafka-streams-application-1>Upgrading a 0.10.1 Kafka Streams Application<a class=td-heading-self-link href=#upgrading-a-0101-kafka-streams-application-1 aria-label="Heading self-link"></a></h3><ul><li>Upgrading your Streams application from 0.10.1 to 0.11.0 does not require a broker upgrade. A Kafka Streams 0.11.0 application can connect to 0.11.0, 0.10.2 and 0.10.1 brokers (it is not possible to connect to 0.10.0 brokers though).</li><li>You need to recompile your code. Just swapping the Kafka Streams library jar file will not work and will break your application.</li><li>If you specify customized <code>key.serde</code>, <code>value.serde</code> and <code>timestamp.extractor</code> in configs, it is recommended to use their replaced configure parameter as these configs are deprecated.</li><li>If you use a custom (i.e., user implemented) timestamp extractor, you will need to update this code, because the <code>TimestampExtractor</code> interface was changed.</li><li>If you register custom metrics, you will need to update this code, because the <code>StreamsMetric</code> interface was changed.</li><li>See <a href=/10/streams/upgrade-guide/#streams_api_changes_0110>Streams API changes in 0.11.0</a> and <a href=/10/streams/upgrade-guide/#streams_api_changes_0102>Streams API changes in 0.10.2</a> for more details.</li></ul><h3 id=upgrading-a-0100-kafka-streams-application-1>Upgrading a 0.10.0 Kafka Streams Application<a class=td-heading-self-link href=#upgrading-a-0100-kafka-streams-application-1 aria-label="Heading self-link"></a></h3><ul><li>Upgrading your Streams application from 0.10.0 to 0.11.0 does require a broker upgrade because a Kafka Streams 0.11.0 application can only connect to 0.11.0, 0.10.2, or 0.10.1 brokers.</li><li>There are couple of API changes, that are not backward compatible (cf. <a href=/10/streams/#streams_api_changes_0110>Streams API changes in 0.11.0</a>, <a href=/10/streams/#streams_api_changes_0102>Streams API changes in 0.10.2</a>, and <a href=/10/streams/#streams_api_changes_0101>Streams API changes in 0.10.1</a> for more details). Thus, you need to update and recompile your code. Just swapping the Kafka Streams library jar file will not work and will break your application.</li><li>Upgrading from 0.10.0.x to 0.11.0.3 requires two rolling bounces with config <code>upgrade.from="0.10.0"</code> set for first upgrade phase (cf. <a href=https://cwiki.apache.org/confluence/display/KAFKA/KIP-268%3A+Simplify+Kafka+Streams+Rebalance+Metadata+Upgrade>KIP-268</a>). As an alternative, an offline upgrade is also possible.<ul><li>prepare your application instances for a rolling bounce and make sure that config <code>upgrade.from</code> is set to <code>"0.10.0"</code> for new version 0.11.0.3</li><li>bounce each instance of your application once</li><li>prepare your newly deployed 0.11.0.3 application instances for a second round of rolling bounces; make sure to remove the value for config <code>upgrade.mode</code></li><li>bounce each instance of your application once more to complete the upgrade</li></ul></li><li>Upgrading from 0.10.0.x to 0.11.0.0, 0.11.0.1, or 0.11.0.2 requires an offline upgrade (rolling bounce upgrade is not supported)<ul><li>stop all old (0.10.0.x) application instances</li><li>update your code and swap old code and jar file with new code and new jar file</li><li>restart all new (0.11.0.0 , 0.11.0.1, or 0.11.0.2) application instances</li></ul></li></ul><h3 id=notable-changes-in-01103>Notable changes in 0.11.0.3<a class=td-heading-self-link href=#notable-changes-in-01103 aria-label="Heading self-link"></a></h3><ul><li>New Kafka Streams configuration parameter <code>upgrade.from</code> added that allows rolling bounce upgrade from version 0.10.0.x</li><li>See the <a href=/10/streams/upgrade-guide/><strong>Kafka Streams upgrade guide</strong></a> for details about this new config.</li></ul><h3 id=notable-changes-in-01100>Notable changes in 0.11.0.0<a class=td-heading-self-link href=#notable-changes-in-01100 aria-label="Heading self-link"></a></h3><ul><li>Unclean leader election is now disabled by default. The new default favors durability over availability. Users who wish to to retain the previous behavior should set the broker config <code>unclean.leader.election.enable</code> to <code>true</code>.</li><li>Producer configs <code>block.on.buffer.full</code>, <code>metadata.fetch.timeout.ms</code> and <code>timeout.ms</code> have been removed. They were initially deprecated in Kafka 0.9.0.0.</li><li>The <code>offsets.topic.replication.factor</code> broker config is now enforced upon auto topic creation. Internal auto topic creation will fail with a GROUP_COORDINATOR_NOT_AVAILABLE error until the cluster size meets this replication factor requirement.</li><li>When compressing data with snappy, the producer and broker will use the compression scheme&rsquo;s default block size (2 x 32 KB) instead of 1 KB in order to improve the compression ratio. There have been reports of data compressed with the smaller block size being 50% larger than when compressed with the larger block size. For the snappy case, a producer with 5000 partitions will require an additional 315 MB of JVM heap.</li><li>Similarly, when compressing data with gzip, the producer and broker will use 8 KB instead of 1 KB as the buffer size. The default for gzip is excessively low (512 bytes).</li><li>The broker configuration <code>max.message.bytes</code> now applies to the total size of a batch of messages. Previously the setting applied to batches of compressed messages, or to non-compressed messages individually. A message batch may consist of only a single message, so in most cases, the limitation on the size of individual messages is only reduced by the overhead of the batch format. However, there are some subtle implications for message format conversion (see below for more detail). Note also that while previously the broker would ensure that at least one message is returned in each fetch request (regardless of the total and partition-level fetch sizes), the same behavior now applies to one message batch.</li><li>GC log rotation is enabled by default, see KAFKA-3754 for details.</li><li>Deprecated constructors of RecordMetadata, MetricName and Cluster classes have been removed.</li><li>Added user headers support through a new Headers interface providing user headers read and write access.</li><li>ProducerRecord and ConsumerRecord expose the new Headers API via <code>Headers headers()</code> method call.</li><li>ExtendedSerializer and ExtendedDeserializer interfaces are introduced to support serialization and deserialization for headers. Headers will be ignored if the configured serializer and deserializer are not the above classes.</li><li>A new config, <code>group.initial.rebalance.delay.ms</code>, was introduced. This config specifies the time, in milliseconds, that the <code>GroupCoordinator</code> will delay the initial consumer rebalance. The rebalance will be further delayed by the value of <code>group.initial.rebalance.delay.ms</code> as new members join the group, up to a maximum of <code>max.poll.interval.ms</code>. The default value for this is 3 seconds. During development and testing it might be desirable to set this to 0 in order to not delay test execution time.</li><li><code>org.apache.kafka.common.Cluster#partitionsForTopic</code>, <code>partitionsForNode</code> and <code>availablePartitionsForTopic</code> methods will return an empty list instead of <code>null</code> (which is considered a bad practice) in case the metadata for the required topic does not exist.</li><li>Streams API configuration parameters <code>timestamp.extractor</code>, <code>key.serde</code>, and <code>value.serde</code> were deprecated and replaced by <code>default.timestamp.extractor</code>, <code>default.key.serde</code>, and <code>default.value.serde</code>, respectively.</li><li>For offset commit failures in the Java consumer&rsquo;s <code>commitAsync</code> APIs, we no longer expose the underlying cause when instances of <code>RetriableCommitFailedException</code> are passed to the commit callback. See <a href=https://issues.apache.org/jira/browse/KAFKA-5052>KAFKA-5052</a> for more detail.</li></ul><h3 id=new-protocol-versions-1>New Protocol Versions<a class=td-heading-self-link href=#new-protocol-versions-1 aria-label="Heading self-link"></a></h3><ul><li><a href=https://cwiki.apache.org/confluence/display/KAFKA/KIP-107:+Add+purgeDataBefore%5C%28%5C%29+API+in+AdminClient>KIP-107</a>: FetchRequest v5 introduces a partition-level <code>log_start_offset</code> field.</li><li><a href=https://cwiki.apache.org/confluence/display/KAFKA/KIP-107:+Add+purgeDataBefore%5C%28%5C%29+API+in+AdminClient>KIP-107</a>: FetchResponse v5 introduces a partition-level <code>log_start_offset</code> field.</li><li><a href=https://cwiki.apache.org/confluence/display/KAFKA/KIP-82+-+Add+Record+Headers>KIP-82</a>: ProduceRequest v3 introduces an array of <code>header</code> in the message protocol, containing <code>key</code> field and <code>value</code> field.</li><li><a href=https://cwiki.apache.org/confluence/display/KAFKA/KIP-82+-+Add+Record+Headers>KIP-82</a>: FetchResponse v5 introduces an array of <code>header</code> in the message protocol, containing <code>key</code> field and <code>value</code> field.</li></ul><h3 id=notes-on-exactly-once-semantics>Notes on Exactly Once Semantics<a class=td-heading-self-link href=#notes-on-exactly-once-semantics aria-label="Heading self-link"></a></h3><p>Kafka 0.11.0 includes support for idempotent and transactional capabilities in the producer. Idempotent delivery ensures that messages are delivered exactly once to a particular topic partition during the lifetime of a single producer. Transactional delivery allows producers to send data to multiple partitions such that either all messages are successfully delivered, or none of them are. Together, these capabilities enable &ldquo;exactly once semantics&rdquo; in Kafka. More details on these features are available in the user guide, but below we add a few specific notes on enabling them in an upgraded cluster. Note that enabling EoS is not required and there is no impact on the broker&rsquo;s behavior if unused.</p><ol><li>Only the new Java producer and consumer support exactly once semantics.</li><li>These features depend crucially on the 0.11.0 message format. Attempting to use them on an older format will result in unsupported version errors.</li><li>Transaction state is stored in a new internal topic <code>__transaction_state</code>. This topic is not created until the the first attempt to use a transactional request API. Similar to the consumer offsets topic, there are several settings to control the topic&rsquo;s configuration. For example, <code>transaction.state.log.min.isr</code> controls the minimum ISR for this topic. See the configuration section in the user guide for a full list of options.</li><li>For secure clusters, the transactional APIs require new ACLs which can be turned on with the <code>bin/kafka-acls.sh</code>. tool.</li><li>EoS in Kafka introduces new request APIs and modifies several existing ones. See <a href=https://cwiki.apache.org/confluence/display/KAFKA/KIP-98+-+Exactly+Once+Delivery+and+Transactional+Messaging#KIP-98-ExactlyOnceDeliveryandTransactionalMessaging-RPCProtocolSummary>KIP-98</a> for the full details</li></ol><h3 id=notes-on-the-new-message-format-in-0110>Notes on the new message format in 0.11.0<a class=td-heading-self-link href=#notes-on-the-new-message-format-in-0110 aria-label="Heading self-link"></a></h3><p>The 0.11.0 message format includes several major enhancements in order to support better delivery semantics for the producer (see <a href=https://cwiki.apache.org/confluence/display/KAFKA/KIP-98+-+Exactly+Once+Delivery+and+Transactional+Messaging>KIP-98</a>) and improved replication fault tolerance (see <a href=https://cwiki.apache.org/confluence/display/KAFKA/KIP-101+-+Alter+Replication+Protocol+to+use+Leader+Epoch+rather+than+High+Watermark+for+Truncation>KIP-101</a>). Although the new format contains more information to make these improvements possible, we have made the batch format much more efficient. As long as the number of messages per batch is more than 2, you can expect lower overall overhead. For smaller batches, however, there may be a small performance impact. See <a href=bit.ly/kafka-eos-perf>here</a> for the results of our initial performance analysis of the new message format. You can also find more detail on the message format in the <a href=https://cwiki.apache.org/confluence/display/KAFKA/KIP-98+-+Exactly+Once+Delivery+and+Transactional+Messaging#KIP-98-ExactlyOnceDeliveryandTransactionalMessaging-MessageFormat>KIP-98</a> proposal.</p><p>One of the notable differences in the new message format is that even uncompressed messages are stored together as a single batch. This has a few implications for the broker configuration <code>max.message.bytes</code>, which limits the size of a single batch. First, if an older client produces messages to a topic partition using the old format, and the messages are individually smaller than <code>max.message.bytes</code>, the broker may still reject them after they are merged into a single batch during the up-conversion process. Generally this can happen when the aggregate size of the individual messages is larger than <code>max.message.bytes</code>. There is a similar effect for older consumers reading messages down-converted from the new format: if the fetch size is not set at least as large as <code>max.message.bytes</code>, the consumer may not be able to make progress even if the individual uncompressed messages are smaller than the configured fetch size. This behavior does not impact the Java client for 0.10.1.0 and later since it uses an updated fetch protocol which ensures that at least one message can be returned even if it exceeds the fetch size. To get around these problems, you should ensure 1) that the producer&rsquo;s batch size is not set larger than <code>max.message.bytes</code>, and 2) that the consumer&rsquo;s fetch size is set at least as large as <code>max.message.bytes</code>.</p><p>Most of the discussion on the performance impact of upgrading to the 0.10.0 message format remains pertinent to the 0.11.0 upgrade. This mainly affects clusters that are not secured with TLS since &ldquo;zero-copy&rdquo; transfer is already not possible in that case. In order to avoid the cost of down-conversion, you should ensure that consumer applications are upgraded to the latest 0.11.0 client. Significantly, since the old consumer has been deprecated in 0.11.0.0, it does not support the new message format. You must upgrade to use the new consumer to use the new message format without the cost of down-conversion. Note that 0.11.0 consumers support backwards compatibility with 0.10.0 brokers and upward, so it is possible to upgrade the clients first before the brokers.</p><h2 id=upgrading-from-08x-09x-0100x-or-0101x-to-01020>Upgrading from 0.8.x, 0.9.x, 0.10.0.x or 0.10.1.x to 0.10.2.0<a class=td-heading-self-link href=#upgrading-from-08x-09x-0100x-or-0101x-to-01020 aria-label="Heading self-link"></a></h2><p>0.10.2.0 has wire protocol changes. By following the recommended rolling upgrade plan below, you guarantee no downtime during the upgrade. However, please review the notable changes in 0.10.2.0 before upgrading.</p><p>Starting with version 0.10.2, Java clients (producer and consumer) have acquired the ability to communicate with older brokers. Version 0.10.2 clients can talk to version 0.10.0 or newer brokers. However, if your brokers are older than 0.10.0, you must upgrade all the brokers in the Kafka cluster before upgrading your clients. Version 0.10.2 brokers support 0.8.x and newer clients.</p><p><strong>For a rolling upgrade:</strong></p><ol><li>Update server.properties file on all brokers and add the following properties:<ul><li>inter.broker.protocol.version=CURRENT_KAFKA_VERSION (e.g. 0.8.2, 0.9.0, 0.10.0 or 0.10.1).</li><li>log.message.format.version=CURRENT_KAFKA_VERSION (See potential performance impact following the upgrade for the details on what this configuration does.)</li></ul></li><li>Upgrade the brokers one at a time: shut down the broker, update the code, and restart it.</li><li>Once the entire cluster is upgraded, bump the protocol version by editing inter.broker.protocol.version and setting it to 0.10.2.</li><li>If your previous message format is 0.10.0, change log.message.format.version to 0.10.2 (this is a no-op as the message format is the same for 0.10.0, 0.10.1 and 0.10.2). If your previous message format version is lower than 0.10.0, do not change log.message.format.version yet - this parameter should only change once all consumers have been upgraded to 0.10.0.0 or later.</li><li>Restart the brokers one by one for the new protocol version to take effect.</li><li>If log.message.format.version is still lower than 0.10.0 at this point, wait until all consumers have been upgraded to 0.10.0 or later, then change log.message.format.version to 0.10.2 on each broker and restart them one by one.</li></ol><p><strong>Note:</strong> If you are willing to accept downtime, you can simply take all the brokers down, update the code and start all of them. They will start with the new protocol by default.</p><p><strong>Note:</strong> Bumping the protocol version and restarting can be done any time after the brokers were upgraded. It does not have to be immediately after.</p><h3 id=upgrading-a-0101-kafka-streams-application-2>Upgrading a 0.10.1 Kafka Streams Application<a class=td-heading-self-link href=#upgrading-a-0101-kafka-streams-application-2 aria-label="Heading self-link"></a></h3><ul><li>Upgrading your Streams application from 0.10.1 to 0.10.2 does not require a broker upgrade. A Kafka Streams 0.10.2 application can connect to 0.10.2 and 0.10.1 brokers (it is not possible to connect to 0.10.0 brokers though).</li><li>You need to recompile your code. Just swapping the Kafka Streams library jar file will not work and will break your application.</li><li>If you use a custom (i.e., user implemented) timestamp extractor, you will need to update this code, because the <code>TimestampExtractor</code> interface was changed.</li><li>If you register custom metrics, you will need to update this code, because the <code>StreamsMetric</code> interface was changed.</li><li>See <a href=/10/streams/upgrade-guide/#streams_api_changes_0102>Streams API changes in 0.10.2</a> for more details.</li></ul><h3 id=upgrading-a-0100-kafka-streams-application-2>Upgrading a 0.10.0 Kafka Streams Application<a class=td-heading-self-link href=#upgrading-a-0100-kafka-streams-application-2 aria-label="Heading self-link"></a></h3><ul><li>Upgrading your Streams application from 0.10.0 to 0.10.2 does require a broker upgrade because a Kafka Streams 0.10.2 application can only connect to 0.10.2 or 0.10.1 brokers.</li><li>There are couple of API changes, that are not backward compatible (cf. <a href=/10/streams/#streams_api_changes_0102>Streams API changes in 0.10.2</a> for more details). Thus, you need to update and recompile your code. Just swapping the Kafka Streams library jar file will not work and will break your application.</li><li>Upgrading from 0.10.0.x to 0.10.2.2 requires two rolling bounces with config <code>upgrade.from="0.10.0"</code> set for first upgrade phase (cf. <a href=https://cwiki.apache.org/confluence/display/KAFKA/KIP-268%3A+Simplify+Kafka+Streams+Rebalance+Metadata+Upgrade>KIP-268</a>). As an alternative, an offline upgrade is also possible.<ul><li>prepare your application instances for a rolling bounce and make sure that config <code>upgrade.from</code> is set to <code>"0.10.0"</code> for new version 0.10.2.2</li><li>bounce each instance of your application once</li><li>prepare your newly deployed 0.10.2.2 application instances for a second round of rolling bounces; make sure to remove the value for config <code>upgrade.mode</code></li><li>bounce each instance of your application once more to complete the upgrade</li></ul></li><li>Upgrading from 0.10.0.x to 0.10.2.0 or 0.10.2.1 requires an offline upgrade (rolling bounce upgrade is not supported)<ul><li>stop all old (0.10.0.x) application instances</li><li>update your code and swap old code and jar file with new code and new jar file</li><li>restart all new (0.10.2.0 or 0.10.2.1) application instances</li></ul></li></ul><h3 id=notable-changes-in-01022>Notable changes in 0.10.2.2<a class=td-heading-self-link href=#notable-changes-in-01022 aria-label="Heading self-link"></a></h3><ul><li>New configuration parameter <code>upgrade.from</code> added that allows rolling bounce upgrade from version 0.10.0.x</li></ul><h3 id=notable-changes-in-01021>Notable changes in 0.10.2.1<a class=td-heading-self-link href=#notable-changes-in-01021 aria-label="Heading self-link"></a></h3><ul><li>The default values for two configurations of the StreamsConfig class were changed to improve the resiliency of Kafka Streams applications. The internal Kafka Streams producer <code>retries</code> default value was changed from 0 to 10. The internal Kafka Streams consumer <code>max.poll.interval.ms</code> default value was changed from 300000 to <code>Integer.MAX_VALUE</code>.</li></ul><h3 id=notable-changes-in-01020>Notable changes in 0.10.2.0<a class=td-heading-self-link href=#notable-changes-in-01020 aria-label="Heading self-link"></a></h3><ul><li>The Java clients (producer and consumer) have acquired the ability to communicate with older brokers. Version 0.10.2 clients can talk to version 0.10.0 or newer brokers. Note that some features are not available or are limited when older brokers are used.</li><li>Several methods on the Java consumer may now throw <code>InterruptException</code> if the calling thread is interrupted. Please refer to the <code>KafkaConsumer</code> Javadoc for a more in-depth explanation of this change.</li><li>Java consumer now shuts down gracefully. By default, the consumer waits up to 30 seconds to complete pending requests. A new close API with timeout has been added to <code>KafkaConsumer</code> to control the maximum wait time.</li><li>Multiple regular expressions separated by commas can be passed to MirrorMaker with the new Java consumer via the &ndash;whitelist option. This makes the behaviour consistent with MirrorMaker when used the old Scala consumer.</li><li>Upgrading your Streams application from 0.10.1 to 0.10.2 does not require a broker upgrade. A Kafka Streams 0.10.2 application can connect to 0.10.2 and 0.10.1 brokers (it is not possible to connect to 0.10.0 brokers though).</li><li>The Zookeeper dependency was removed from the Streams API. The Streams API now uses the Kafka protocol to manage internal topics instead of modifying Zookeeper directly. This eliminates the need for privileges to access Zookeeper directly and &ldquo;StreamsConfig.ZOOKEEPER_CONFIG&rdquo; should not be set in the Streams app any more. If the Kafka cluster is secured, Streams apps must have the required security privileges to create new topics.</li><li>Several new fields including &ldquo;security.protocol&rdquo;, &ldquo;connections.max.idle.ms&rdquo;, &ldquo;retry.backoff.ms&rdquo;, &ldquo;reconnect.backoff.ms&rdquo; and &ldquo;request.timeout.ms&rdquo; were added to StreamsConfig class. User should pay attention to the default values and set these if needed. For more details please refer to <a href=/10/#streamsconfigs>3.5 Kafka Streams Configs</a>.</li></ul><h3 id=new-protocol-versions-2>New Protocol Versions<a class=td-heading-self-link href=#new-protocol-versions-2 aria-label="Heading self-link"></a></h3><ul><li><a href=https://cwiki.apache.org/confluence/display/KAFKA/KIP-88%3A+OffsetFetch+Protocol+Update>KIP-88</a>: OffsetFetchRequest v2 supports retrieval of offsets for all topics if the <code>topics</code> array is set to <code>null</code>.</li><li><a href=https://cwiki.apache.org/confluence/display/KAFKA/KIP-88%3A+OffsetFetch+Protocol+Update>KIP-88</a>: OffsetFetchResponse v2 introduces a top-level <code>error_code</code> field.</li><li><a href=https://cwiki.apache.org/confluence/display/KAFKA/KIP-103%3A+Separation+of+Internal+and+External+traffic>KIP-103</a>: UpdateMetadataRequest v3 introduces a <code>listener_name</code> field to the elements of the <code>end_points</code> array.</li><li><a href=https://cwiki.apache.org/confluence/display/KAFKA/KIP-108%3A+Create+Topic+Policy>KIP-108</a>: CreateTopicsRequest v1 introduces a <code>validate_only</code> field.</li><li><a href=https://cwiki.apache.org/confluence/display/KAFKA/KIP-108%3A+Create+Topic+Policy>KIP-108</a>: CreateTopicsResponse v1 introduces an <code>error_message</code> field to the elements of the <code>topic_errors</code> array.</li></ul><h2 id=upgrading-from-08x-09x-or-0100x-to-01010>Upgrading from 0.8.x, 0.9.x or 0.10.0.X to 0.10.1.0<a class=td-heading-self-link href=#upgrading-from-08x-09x-or-0100x-to-01010 aria-label="Heading self-link"></a></h2><p>0.10.1.0 has wire protocol changes. By following the recommended rolling upgrade plan below, you guarantee no downtime during the upgrade. However, please notice the Potential breaking changes in 0.10.1.0 before upgrade.<br>Note: Because new protocols are introduced, it is important to upgrade your Kafka clusters before upgrading your clients (i.e. 0.10.1.x clients only support 0.10.1.x or later brokers while 0.10.1.x brokers also support older clients).</p><p><strong>For a rolling upgrade:</strong></p><ol><li>Update server.properties file on all brokers and add the following properties:<ul><li>inter.broker.protocol.version=CURRENT_KAFKA_VERSION (e.g. 0.8.2.0, 0.9.0.0 or 0.10.0.0).</li><li>log.message.format.version=CURRENT_KAFKA_VERSION (See potential performance impact following the upgrade for the details on what this configuration does.)</li></ul></li><li>Upgrade the brokers one at a time: shut down the broker, update the code, and restart it.</li><li>Once the entire cluster is upgraded, bump the protocol version by editing inter.broker.protocol.version and setting it to 0.10.1.0.</li><li>If your previous message format is 0.10.0, change log.message.format.version to 0.10.1 (this is a no-op as the message format is the same for both 0.10.0 and 0.10.1). If your previous message format version is lower than 0.10.0, do not change log.message.format.version yet - this parameter should only change once all consumers have been upgraded to 0.10.0.0 or later.</li><li>Restart the brokers one by one for the new protocol version to take effect.</li><li>If log.message.format.version is still lower than 0.10.0 at this point, wait until all consumers have been upgraded to 0.10.0 or later, then change log.message.format.version to 0.10.1 on each broker and restart them one by one.</li></ol><p><strong>Note:</strong> If you are willing to accept downtime, you can simply take all the brokers down, update the code and start all of them. They will start with the new protocol by default.</p><p><strong>Note:</strong> Bumping the protocol version and restarting can be done any time after the brokers were upgraded. It does not have to be immediately after.</p><h3 id=potential-breaking-changes-in-01010>Potential breaking changes in 0.10.1.0<a class=td-heading-self-link href=#potential-breaking-changes-in-01010 aria-label="Heading self-link"></a></h3><ul><li>The log retention time is no longer based on last modified time of the log segments. Instead it will be based on the largest timestamp of the messages in a log segment.</li><li>The log rolling time is no longer depending on log segment create time. Instead it is now based on the timestamp in the messages. More specifically. if the timestamp of the first message in the segment is T, the log will be rolled out when a new message has a timestamp greater than or equal to T + log.roll.ms</li><li>The open file handlers of 0.10.0 will increase by ~33% because of the addition of time index files for each segment.</li><li>The time index and offset index share the same index size configuration. Since each time index entry is 1.5x the size of offset index entry. User may need to increase log.index.size.max.bytes to avoid potential frequent log rolling.</li><li>Due to the increased number of index files, on some brokers with large amount the log segments (e.g. >15K), the log loading process during the broker startup could be longer. Based on our experiment, setting the num.recovery.threads.per.data.dir to one may reduce the log loading time.</li></ul><h3 id=upgrading-a-0100-kafka-streams-application-3>Upgrading a 0.10.0 Kafka Streams Application<a class=td-heading-self-link href=#upgrading-a-0100-kafka-streams-application-3 aria-label="Heading self-link"></a></h3><ul><li>Upgrading your Streams application from 0.10.0 to 0.10.1 does require a broker upgrade because a Kafka Streams 0.10.1 application can only connect to 0.10.1 brokers.</li><li>There are couple of API changes, that are not backward compatible (cf. <a href=/10/streams/upgrade-guide/#streams_api_changes_0101>Streams API changes in 0.10.1</a> for more details). Thus, you need to update and recompile your code. Just swapping the Kafka Streams library jar file will not work and will break your application.</li><li>Upgrading from 0.10.0.x to 0.10.1.0 or 0.10.1.1 requires an offline upgrade (rolling bounce upgrade is not supported)<ul><li>stop all old (0.10.0.x) application instances</li><li>update your code and swap old code and jar file with new code and new jar file</li><li>restart all new (0.10.1.0 or 0.10.1.1) application instances</li></ul></li></ul><h3 id=notable-changes-in-01010>Notable changes in 0.10.1.0<a class=td-heading-self-link href=#notable-changes-in-01010 aria-label="Heading self-link"></a></h3><ul><li>The new Java consumer is no longer in beta and we recommend it for all new development. The old Scala consumers are still supported, but they will be deprecated in the next release and will be removed in a future major release.</li><li>The <code>--new-consumer</code>/<code>--new.consumer</code> switch is no longer required to use tools like MirrorMaker and the Console Consumer with the new consumer; one simply needs to pass a Kafka broker to connect to instead of the ZooKeeper ensemble. In addition, usage of the Console Consumer with the old consumer has been deprecated and it will be removed in a future major release.</li><li>Kafka clusters can now be uniquely identified by a cluster id. It will be automatically generated when a broker is upgraded to 0.10.1.0. The cluster id is available via the kafka.server:type=KafkaServer,name=ClusterId metric and it is part of the Metadata response. Serializers, client interceptors and metric reporters can receive the cluster id by implementing the ClusterResourceListener interface.</li><li>The BrokerState &ldquo;RunningAsController&rdquo; (value 4) has been removed. Due to a bug, a broker would only be in this state briefly before transitioning out of it and hence the impact of the removal should be minimal. The recommended way to detect if a given broker is the controller is via the kafka.controller:type=KafkaController,name=ActiveControllerCount metric.</li><li>The new Java Consumer now allows users to search offsets by timestamp on partitions.</li><li>The new Java Consumer now supports heartbeating from a background thread. There is a new configuration <code>max.poll.interval.ms</code> which controls the maximum time between poll invocations before the consumer will proactively leave the group (5 minutes by default). The value of the configuration <code>request.timeout.ms</code> must always be larger than <code>max.poll.interval.ms</code> because this is the maximum time that a JoinGroup request can block on the server while the consumer is rebalancing, so we have changed its default value to just above 5 minutes. Finally, the default value of <code>session.timeout.ms</code> has been adjusted down to 10 seconds, and the default value of <code>max.poll.records</code> has been changed to 500.</li><li>When using an Authorizer and a user doesn&rsquo;t have <strong>Describe</strong> authorization on a topic, the broker will no longer return TOPIC_AUTHORIZATION_FAILED errors to requests since this leaks topic names. Instead, the UNKNOWN_TOPIC_OR_PARTITION error code will be returned. This may cause unexpected timeouts or delays when using the producer and consumer since Kafka clients will typically retry automatically on unknown topic errors. You should consult the client logs if you suspect this could be happening.</li><li>Fetch responses have a size limit by default (50 MB for consumers and 10 MB for replication). The existing per partition limits also apply (1 MB for consumers and replication). Note that neither of these limits is an absolute maximum as explained in the next point.</li><li>Consumers and replicas can make progress if a message larger than the response/partition size limit is found. More concretely, if the first message in the first non-empty partition of the fetch is larger than either or both limits, the message will still be returned.</li><li>Overloaded constructors were added to <code>kafka.api.FetchRequest</code> and <code>kafka.javaapi.FetchRequest</code> to allow the caller to specify the order of the partitions (since order is significant in v3). The previously existing constructors were deprecated and the partitions are shuffled before the request is sent to avoid starvation issues.</li></ul><h3 id=new-protocol-versions-3>New Protocol Versions<a class=td-heading-self-link href=#new-protocol-versions-3 aria-label="Heading self-link"></a></h3><ul><li>ListOffsetRequest v1 supports accurate offset search based on timestamps.</li><li>MetadataResponse v2 introduces a new field: &ldquo;cluster_id&rdquo;.</li><li>FetchRequest v3 supports limiting the response size (in addition to the existing per partition limit), it returns messages bigger than the limits if required to make progress and the order of partitions in the request is now significant.</li><li>JoinGroup v1 introduces a new field: &ldquo;rebalance_timeout&rdquo;.</li></ul><h2 id=upgrading-from-08x-or-09x-to-01000>Upgrading from 0.8.x or 0.9.x to 0.10.0.0<a class=td-heading-self-link href=#upgrading-from-08x-or-09x-to-01000 aria-label="Heading self-link"></a></h2><p>0.10.0.0 has potential breaking changes (please review before upgrading) and possible performance impact following the upgrade. By following the recommended rolling upgrade plan below, you guarantee no downtime and no performance impact during and following the upgrade.<br>Note: Because new protocols are introduced, it is important to upgrade your Kafka clusters before upgrading your clients.</p><p><strong>Notes to clients with version 0.9.0.0:</strong> Due to a bug introduced in 0.9.0.0, clients that depend on ZooKeeper (old Scala high-level Consumer and MirrorMaker if used with the old consumer) will not work with 0.10.0.x brokers. Therefore, 0.9.0.0 clients should be upgraded to 0.9.0.1 <strong>before</strong> brokers are upgraded to 0.10.0.x. This step is not necessary for 0.8.X or 0.9.0.1 clients.</p><p><strong>For a rolling upgrade:</strong></p><ol><li>Update server.properties file on all brokers and add the following properties:<ul><li>inter.broker.protocol.version=CURRENT_KAFKA_VERSION (e.g. 0.8.2 or 0.9.0.0).</li><li>log.message.format.version=CURRENT_KAFKA_VERSION (See potential performance impact following the upgrade for the details on what this configuration does.)</li></ul></li><li>Upgrade the brokers. This can be done a broker at a time by simply bringing it down, updating the code, and restarting it.</li><li>Once the entire cluster is upgraded, bump the protocol version by editing inter.broker.protocol.version and setting it to 0.10.0.0. NOTE: You shouldn&rsquo;t touch log.message.format.version yet - this parameter should only change once all consumers have been upgraded to 0.10.0.0</li><li>Restart the brokers one by one for the new protocol version to take effect.</li><li>Once all consumers have been upgraded to 0.10.0, change log.message.format.version to 0.10.0 on each broker and restart them one by one.</li></ol><p><strong>Note:</strong> If you are willing to accept downtime, you can simply take all the brokers down, update the code and start all of them. They will start with the new protocol by default.</p><p><strong>Note:</strong> Bumping the protocol version and restarting can be done any time after the brokers were upgraded. It does not have to be immediately after.</p><h3 id=potential-performance-impact-following-upgrade-to-01000>Potential performance impact following upgrade to 0.10.0.0<a class=td-heading-self-link href=#potential-performance-impact-following-upgrade-to-01000 aria-label="Heading self-link"></a></h3><p>The message format in 0.10.0 includes a new timestamp field and uses relative offsets for compressed messages. The on disk message format can be configured through log.message.format.version in the server.properties file. The default on-disk message format is 0.10.0. If a consumer client is on a version before 0.10.0.0, it only understands message formats before 0.10.0. In this case, the broker is able to convert messages from the 0.10.0 format to an earlier format before sending the response to the consumer on an older version. However, the broker can&rsquo;t use zero-copy transfer in this case. Reports from the Kafka community on the performance impact have shown CPU utilization going from 20% before to 100% after an upgrade, which forced an immediate upgrade of all clients to bring performance back to normal. To avoid such message conversion before consumers are upgraded to 0.10.0.0, one can set log.message.format.version to 0.8.2 or 0.9.0 when upgrading the broker to 0.10.0.0. This way, the broker can still use zero-copy transfer to send the data to the old consumers. Once consumers are upgraded, one can change the message format to 0.10.0 on the broker and enjoy the new message format that includes new timestamp and improved compression. The conversion is supported to ensure compatibility and can be useful to support a few apps that have not updated to newer clients yet, but is impractical to support all consumer traffic on even an overprovisioned cluster. Therefore, it is critical to avoid the message conversion as much as possible when brokers have been upgraded but the majority of clients have not.</p><p>For clients that are upgraded to 0.10.0.0, there is no performance impact.</p><p><strong>Note:</strong> By setting the message format version, one certifies that all existing messages are on or below that message format version. Otherwise consumers before 0.10.0.0 might break. In particular, after the message format is set to 0.10.0, one should not change it back to an earlier format as it may break consumers on versions before 0.10.0.0.</p><p><strong>Note:</strong> Due to the additional timestamp introduced in each message, producers sending small messages may see a message throughput degradation because of the increased overhead. Likewise, replication now transmits an additional 8 bytes per message. If you&rsquo;re running close to the network capacity of your cluster, it&rsquo;s possible that you&rsquo;ll overwhelm the network cards and see failures and performance issues due to the overload.</p><p><strong>Note:</strong> If you have enabled compression on producers, you may notice reduced producer throughput and/or lower compression rate on the broker in some cases. When receiving compressed messages, 0.10.0 brokers avoid recompressing the messages, which in general reduces the latency and improves the throughput. In certain cases, however, this may reduce the batching size on the producer, which could lead to worse throughput. If this happens, users can tune linger.ms and batch.size of the producer for better throughput. In addition, the producer buffer used for compressing messages with snappy is smaller than the one used by the broker, which may have a negative impact on the compression ratio for the messages on disk. We intend to make this configurable in a future Kafka release.</p><h3 id=potential-breaking-changes-in-01000>Potential breaking changes in 0.10.0.0<a class=td-heading-self-link href=#potential-breaking-changes-in-01000 aria-label="Heading self-link"></a></h3><ul><li>Starting from Kafka 0.10.0.0, the message format version in Kafka is represented as the Kafka version. For example, message format 0.9.0 refers to the highest message version supported by Kafka 0.9.0.</li><li>Message format 0.10.0 has been introduced and it is used by default. It includes a timestamp field in the messages and relative offsets are used for compressed messages.</li><li>ProduceRequest/Response v2 has been introduced and it is used by default to support message format 0.10.0</li><li>FetchRequest/Response v2 has been introduced and it is used by default to support message format 0.10.0</li><li>MessageFormatter interface was changed from <code>def writeTo(key: Array[Byte], value: Array[Byte], output: PrintStream)</code> to <code>def writeTo(consumerRecord: ConsumerRecord[Array[Byte], Array[Byte]], output: PrintStream)</code></li><li>MessageReader interface was changed from <code>def readMessage(): KeyedMessage[Array[Byte], Array[Byte]]</code> to <code>def readMessage(): ProducerRecord[Array[Byte], Array[Byte]]</code></li><li>MessageFormatter&rsquo;s package was changed from <code>kafka.tools</code> to <code>kafka.common</code></li><li>MessageReader&rsquo;s package was changed from <code>kafka.tools</code> to <code>kafka.common</code></li><li>MirrorMakerMessageHandler no longer exposes the <code>handle(record: MessageAndMetadata[Array[Byte], Array[Byte]])</code> method as it was never called.</li><li>The 0.7 KafkaMigrationTool is no longer packaged with Kafka. If you need to migrate from 0.7 to 0.10.0, please migrate to 0.8 first and then follow the documented upgrade process to upgrade from 0.8 to 0.10.0.</li><li>The new consumer has standardized its APIs to accept <code>java.util.Collection</code> as the sequence type for method parameters. Existing code may have to be updated to work with the 0.10.0 client library.</li><li>LZ4-compressed message handling was changed to use an interoperable framing specification (LZ4f v1.5.1). To maintain compatibility with old clients, this change only applies to Message format 0.10.0 and later. Clients that Produce/Fetch LZ4-compressed messages using v0/v1 (Message format 0.9.0) should continue to use the 0.9.0 framing implementation. Clients that use Produce/Fetch protocols v2 or later should use interoperable LZ4f framing. A list of interoperable LZ4 libraries is available at <a href=http://www.lz4.org/>http://www.lz4.org/</a></li></ul><h3 id=notable-changes-in-01000>Notable changes in 0.10.0.0<a class=td-heading-self-link href=#notable-changes-in-01000 aria-label="Heading self-link"></a></h3><ul><li>Starting from Kafka 0.10.0.0, a new client library named <strong>Kafka Streams</strong> is available for stream processing on data stored in Kafka topics. This new client library only works with 0.10.x and upward versioned brokers due to message format changes mentioned above. For more information please read <a href=/10/streams/>Streams documentation</a>.</li><li>The default value of the configuration parameter <code>receive.buffer.bytes</code> is now 64K for the new consumer.</li><li>The new consumer now exposes the configuration parameter <code>exclude.internal.topics</code> to restrict internal topics (such as the consumer offsets topic) from accidentally being included in regular expression subscriptions. By default, it is enabled.</li><li>The old Scala producer has been deprecated. Users should migrate their code to the Java producer included in the kafka-clients JAR as soon as possible.</li><li>The new consumer API has been marked stable.</li></ul><h2 id=upgrading-from-080-081x-or-082x-to-0900>Upgrading from 0.8.0, 0.8.1.X or 0.8.2.X to 0.9.0.0<a class=td-heading-self-link href=#upgrading-from-080-081x-or-082x-to-0900 aria-label="Heading self-link"></a></h2><p>0.9.0.0 has potential breaking changes (please review before upgrading) and an inter-broker protocol change from previous versions. This means that upgraded brokers and clients may not be compatible with older versions. It is important that you upgrade your Kafka cluster before upgrading your clients. If you are using MirrorMaker downstream clusters should be upgraded first as well.</p><p><strong>For a rolling upgrade:</strong></p><ol><li>Update server.properties file on all brokers and add the following property: inter.broker.protocol.version=0.8.2.X</li><li>Upgrade the brokers. This can be done a broker at a time by simply bringing it down, updating the code, and restarting it.</li><li>Once the entire cluster is upgraded, bump the protocol version by editing inter.broker.protocol.version and setting it to 0.9.0.0.</li><li>Restart the brokers one by one for the new protocol version to take effect</li></ol><p><strong>Note:</strong> If you are willing to accept downtime, you can simply take all the brokers down, update the code and start all of them. They will start with the new protocol by default.</p><p><strong>Note:</strong> Bumping the protocol version and restarting can be done any time after the brokers were upgraded. It does not have to be immediately after.</p><h3 id=potential-breaking-changes-in-0900>Potential breaking changes in 0.9.0.0<a class=td-heading-self-link href=#potential-breaking-changes-in-0900 aria-label="Heading self-link"></a></h3><ul><li>Java 1.6 is no longer supported.</li><li>Scala 2.9 is no longer supported.</li><li>Broker IDs above 1000 are now reserved by default to automatically assigned broker IDs. If your cluster has existing broker IDs above that threshold make sure to increase the reserved.broker.max.id broker configuration property accordingly.</li><li>Configuration parameter replica.lag.max.messages was removed. Partition leaders will no longer consider the number of lagging messages when deciding which replicas are in sync.</li><li>Configuration parameter replica.lag.time.max.ms now refers not just to the time passed since last fetch request from replica, but also to time since the replica last caught up. Replicas that are still fetching messages from leaders but did not catch up to the latest messages in replica.lag.time.max.ms will be considered out of sync.</li><li>Compacted topics no longer accept messages without key and an exception is thrown by the producer if this is attempted. In 0.8.x, a message without key would cause the log compaction thread to subsequently complain and quit (and stop compacting all compacted topics).</li><li>MirrorMaker no longer supports multiple target clusters. As a result it will only accept a single &ndash;consumer.config parameter. To mirror multiple source clusters, you will need at least one MirrorMaker instance per source cluster, each with its own consumer configuration.</li><li>Tools packaged under <em>org.apache.kafka.clients.tools.*</em> have been moved to <em>org.apache.kafka.tools.*</em>. All included scripts will still function as usual, only custom code directly importing these classes will be affected.</li><li>The default Kafka JVM performance options (KAFKA_JVM_PERFORMANCE_OPTS) have been changed in kafka-run-class.sh.</li><li>The kafka-topics.sh script (kafka.admin.TopicCommand) now exits with non-zero exit code on failure.</li><li>The kafka-topics.sh script (kafka.admin.TopicCommand) will now print a warning when topic names risk metric collisions due to the use of a &lsquo;.&rsquo; or &lsquo;_&rsquo; in the topic name, and error in the case of an actual collision.</li><li>The kafka-console-producer.sh script (kafka.tools.ConsoleProducer) will use the Java producer instead of the old Scala producer be default, and users have to specify &lsquo;old-producer&rsquo; to use the old producer.</li><li>By default, all command line tools will print all logging messages to stderr instead of stdout.</li></ul><h3 id=notable-changes-in-0901>Notable changes in 0.9.0.1<a class=td-heading-self-link href=#notable-changes-in-0901 aria-label="Heading self-link"></a></h3><ul><li>The new broker id generation feature can be disabled by setting broker.id.generation.enable to false.</li><li>Configuration parameter log.cleaner.enable is now true by default. This means topics with a cleanup.policy=compact will now be compacted by default, and 128 MB of heap will be allocated to the cleaner process via log.cleaner.dedupe.buffer.size. You may want to review log.cleaner.dedupe.buffer.size and the other log.cleaner configuration values based on your usage of compacted topics.</li><li>Default value of configuration parameter fetch.min.bytes for the new consumer is now 1 by default.</li></ul><h3 id=deprecations-in-0900>Deprecations in 0.9.0.0<a class=td-heading-self-link href=#deprecations-in-0900 aria-label="Heading self-link"></a></h3><ul><li>Altering topic configuration from the kafka-topics.sh script (kafka.admin.TopicCommand) has been deprecated. Going forward, please use the kafka-configs.sh script (kafka.admin.ConfigCommand) for this functionality.</li><li>The kafka-consumer-offset-checker.sh (kafka.tools.ConsumerOffsetChecker) has been deprecated. Going forward, please use kafka-consumer-groups.sh (kafka.admin.ConsumerGroupCommand) for this functionality.</li><li>The kafka.tools.ProducerPerformance class has been deprecated. Going forward, please use org.apache.kafka.tools.ProducerPerformance for this functionality (kafka-producer-perf-test.sh will also be changed to use the new class).</li><li>The producer config block.on.buffer.full has been deprecated and will be removed in future release. Currently its default value has been changed to false. The KafkaProducer will no longer throw BufferExhaustedException but instead will use max.block.ms value to block, after which it will throw a TimeoutException. If block.on.buffer.full property is set to true explicitly, it will set the max.block.ms to Long.MAX_VALUE and metadata.fetch.timeout.ms will not be honoured</li></ul><h2 id=upgrading-from-081-to-082>Upgrading from 0.8.1 to 0.8.2<a class=td-heading-self-link href=#upgrading-from-081-to-082 aria-label="Heading self-link"></a></h2><p>0.8.2 is fully compatible with 0.8.1. The upgrade can be done one broker at a time by simply bringing it down, updating the code, and restarting it.</p><h2 id=upgrading-from-080-to-081>Upgrading from 0.8.0 to 0.8.1<a class=td-heading-self-link href=#upgrading-from-080-to-081 aria-label="Heading self-link"></a></h2><p>0.8.1 is fully compatible with 0.8. The upgrade can be done one broker at a time by simply bringing it down, updating the code, and restarting it.</p><h2 id=upgrading-from-07>Upgrading from 0.7<a class=td-heading-self-link href=#upgrading-from-07 aria-label="Heading self-link"></a></h2><p>Release 0.7 is incompatible with newer releases. Major changes were made to the API, ZooKeeper data structures, and protocol, and configuration in order to add replication (Which was missing in 0.7). The upgrade from 0.7 to later versions requires a <a href=https://cwiki.apache.org/confluence/display/KAFKA/Migrating+from+0.7+to+0.8>special tool</a> for migration. This migration can be done without downtime.</p><style>.feedback--answer{display:inline-block}.feedback--answer-no{margin-left:1em}.feedback--response{display:none;margin-top:1em}.feedback--response__visible{display:block}</style><div class=d-print-none><h2 class=feedback--title>Feedback</h2><p class=feedback--question>Was this page helpful?</p><button class="btn btn-primary mb-4 feedback--answer feedback--answer-yes">Yes</button>
<button class="btn btn-primary mb-4 feedback--answer feedback--answer-no">No</button><p class="feedback--response feedback--response-yes">Glad to hear it! Please <a href=https://github.com/USERNAME/REPOSITORY/issues/new>tell us how we can improve</a>.</p><p class="feedback--response feedback--response-no">Sorry to hear that. Please <a href=https://github.com/USERNAME/REPOSITORY/issues/new>tell us how we can improve</a>.</p></div><script>const yesButton=document.querySelector(".feedback--answer-yes"),noButton=document.querySelector(".feedback--answer-no"),yesResponse=document.querySelector(".feedback--response-yes"),noResponse=document.querySelector(".feedback--response-no"),disableButtons=()=>{yesButton.disabled=!0,noButton.disabled=!0},sendFeedback=e=>{if(typeof gtag!="function")return;gtag("event","page_helpful",{event_category:"Helpful",event_label:window.location.pathname,value:e})};yesButton.addEventListener("click",()=>{yesResponse.classList.add("feedback--response__visible"),disableButtons(),sendFeedback(100)}),noButton.addEventListener("click",()=>{noResponse.classList.add("feedback--response__visible"),disableButtons(),sendFeedback(0)})</script><br><div class=td-page-meta__lastmod>Last modified January 3, 2025: <a href=https://github.com/apache/kafka-site//commit/b4639af2bf30cedb703fa2d7d054cf6ded963ae7>Documentation for all releases generated by ak2md automation (b4639af2)</a></div></div></main></div></div><footer class="td-footer row d-print-none"><div class=container-fluid><div class="row mx-md-2"><div class="td-footer__left col-6 col-sm-4 order-sm-1"><ul class=td-footer__links-list><li class=td-footer__links-item data-bs-toggle=tooltip title=Contact aria-label=Contact><a target=_blank rel=noopener href=/community/contact/ aria-label=Contact><i class="fa fa-envelope"></i></a></li><li class=td-footer__links-item data-bs-toggle=tooltip title=Twitter aria-label=Twitter><a target=_blank rel=noopener href=https://twitter.com/apachekafka aria-label=Twitter><i class="fab fa-twitter"></i></a></li><li class=td-footer__links-item data-bs-toggle=tooltip title="Stack Overflow" aria-label="Stack Overflow"><a target=_blank rel=noopener href=https://stackoverflow.com/questions/tagged/apache-kafka aria-label="Stack Overflow"><i class="fab fa-stack-overflow"></i></a></li></ul></div><div class="td-footer__right col-6 col-sm-4 order-sm-3"><ul class=td-footer__links-list><li class=td-footer__links-item data-bs-toggle=tooltip title=GitHub aria-label=GitHub><a target=_blank rel=noopener href=https://github.com/apache/kafka aria-label=GitHub><i class="fab fa-github"></i></a></li><li class=td-footer__links-item data-bs-toggle=tooltip title="Developer mailing list" aria-label="Developer mailing list"><a target=_blank rel=noopener href=mailto:dev@kafka.apache.org aria-label="Developer mailing list"><i class="fa fa-envelope"></i></a></li></ul></div><div class="td-footer__center col-12 col-sm-4 py-2 order-sm-2"><span class=td-footer__copyright>&copy;
2014&ndash;2025
<span class=td-footer__authors>By <a href=https://www.apache.org/>Apache Software Foundation</a> under the terms of the <a href=https://www.apache.org/licenses/LICENSE-2.0>Apache License v2</a></span></span><span class=td-footer__all_rights_reserved>All Rights Reserved</span><span class=ms-2><a href=https://privacy.apache.org/policies/privacy-policy-public.html target=_blank rel=noopener>Privacy Policy</a></span></div></div></div></footer></div><script src=/js/main.min.dc2c0119076a0df855e55a8044ce0de74b7b9033c20e853e22d7ec7e9bdde965.js integrity="sha256-3CwBGQdqDfhV5VqARM4N50t7kDPCDoU+Itfsfpvd6WU=" crossorigin=anonymous></script><script defer src=/js/click-to-copy.min.73478a7d4807698aed7e355eb23f9890ca18fea3158604c8471746d046702bad.js integrity="sha256-c0eKfUgHaYrtfjVesj+YkMoY/qMVhgTIRxdG0EZwK60=" crossorigin=anonymous></script><script src=/js/tabpane-persist.js></script></body></html>
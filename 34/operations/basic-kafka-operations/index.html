<!doctype html><html itemscope itemtype=http://schema.org/WebPage lang=en class=no-js><head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><meta name=robots content="index, follow"><link rel="shortcut icon" href=/favicons/favicon.ico><link rel=apple-touch-icon href=/favicons/apple-touch-icon-180x180.png sizes=180x180><link rel=icon type=image/png href=/favicons/favicon-16x16.png sizes=16x16><link rel=icon type=image/png href=/favicons/favicon-32x32.png sizes=32x32><link rel=icon type=image/png href=/favicons/android-36x36.png sizes=36x36><link rel=icon type=image/png href=/favicons/android-48x48.png sizes=48x48><link rel=icon type=image/png href=/favicons/android-72x72.png sizes=72x72><link rel=icon type=image/png href=/favicons/android-96x96.png sizes=96x96><link rel=icon type=image/png href=/favicons/android-144x144.png sizes=144x144><link rel=icon type=image/png href=/favicons/android-192x192.png sizes=192x192><title>Basic Kafka Operations | </title><meta name=description content="Basic Kafka Operations"><meta property="og:title" content="Basic Kafka Operations"><meta property="og:description" content="Basic Kafka Operations"><meta property="og:type" content="article"><meta property="og:url" content="https://example.kafka-site-md.dev/34/operations/basic-kafka-operations/"><meta property="article:section" content="34"><meta property="article:modified_time" content="2025-01-03T16:06:33-08:00"><meta itemprop=name content="Basic Kafka Operations"><meta itemprop=description content="Basic Kafka Operations"><meta itemprop=dateModified content="2025-01-03T16:06:33-08:00"><meta itemprop=wordCount content="4310"><meta itemprop=keywords content="kafka,docs,"><meta name=twitter:card content="summary"><meta name=twitter:title content="Basic Kafka Operations"><meta name=twitter:description content="Basic Kafka Operations"><link rel=preload href=/scss/main.min.7ed0eb3fc68a0678ca492e0db9c00f8e8d5b776bbb2fb833732191f6bbf02877.css as=style integrity="sha256-ftDrP8aKBnjKSS4NucAPjo1bd2u7L7gzcyGR9rvwKHc=" crossorigin=anonymous><link href=/scss/main.min.7ed0eb3fc68a0678ca492e0db9c00f8e8d5b776bbb2fb833732191f6bbf02877.css rel=stylesheet integrity="sha256-ftDrP8aKBnjKSS4NucAPjo1bd2u7L7gzcyGR9rvwKHc=" crossorigin=anonymous><script src=https://code.jquery.com/jquery-3.7.1.min.js integrity="sha512-v2CJ7UaYy4JwqLDIrZUI/4hqeoQieOmAZNXBeQyjo21dadnwR+8ZaIJVT8EE2iyI61OV8e6M8PP2/4hpQINQ/g==" crossorigin=anonymous></script><script defer src=https://unpkg.com/lunr@2.3.9/lunr.min.js integrity=sha384-203J0SNzyqHby3iU6hzvzltrWi/M41wOP5Gu+BiJMz5nwKykbkUx8Kp7iti0Lpli crossorigin=anonymous></script></head><body class=td-page><header><nav class="td-navbar js-navbar-scroll" data-bs-theme=dark><div class="container-fluid flex-column flex-md-row"><a class=navbar-brand href=/><span class="navbar-brand__logo navbar-logo"><svg width="154" height="250" viewBox="0 0 256 416" xmlns="http://www.w3.org/2000/svg" preserveAspectRatio="xMidYMid"><path d="M201.816 230.216c-16.186.0-30.697 7.171-40.634 18.461l-25.463-18.026c2.703-7.442 4.255-15.433 4.255-23.797.0-8.219-1.498-16.076-4.112-23.408l25.406-17.835c9.936 11.233 24.409 18.365 40.548 18.365 29.875.0 54.184-24.305 54.184-54.184.0-29.879-24.309-54.184-54.184-54.184s-54.184 24.305-54.184 54.184c0 5.348.808 10.505 2.258 15.389l-25.423 17.844c-10.62-13.175-25.911-22.374-43.333-25.182v-30.64c24.544-5.155 43.037-26.962 43.037-53.019C124.171 24.305 99.862.0 69.987.0 40.112.0 15.803 24.305 15.803 54.184c0 25.708 18.014 47.246 42.067 52.769v31.038C25.044 143.753.0 172.401.0 206.854c0 34.621 25.292 63.374 58.355 68.94v32.774c-24.299 5.341-42.552 27.011-42.552 52.894.0 29.879 24.309 54.184 54.184 54.184s54.184-24.305 54.184-54.184c0-25.883-18.253-47.553-42.552-52.894v-32.775a69.965 69.965.0 0042.6-24.776l25.633 18.143c-1.423 4.84-2.22 9.946-2.22 15.24.0 29.879 24.309 54.184 54.184 54.184S256 314.279 256 284.4c0-29.879-24.309-54.184-54.184-54.184zm0-126.695c14.487.0 26.27 11.788 26.27 26.271s-11.783 26.27-26.27 26.27-26.27-11.787-26.27-26.27 11.783-26.271 26.27-26.271zm-158.1-49.337c0-14.483 11.784-26.27 26.271-26.27s26.27 11.787 26.27 26.27c0 14.483-11.783 26.27-26.27 26.27s-26.271-11.787-26.271-26.27zm52.541 307.278c0 14.483-11.783 26.27-26.27 26.27s-26.271-11.787-26.271-26.27 11.784-26.27 26.271-26.27 26.27 11.787 26.27 26.27zm-26.272-117.97c-20.205.0-36.642-16.434-36.642-36.638.0-20.205 16.437-36.642 36.642-36.642 20.204.0 36.641 16.437 36.641 36.642.0 20.204-16.437 36.638-36.641 36.638zm131.831 67.179c-14.487.0-26.27-11.788-26.27-26.271s11.783-26.27 26.27-26.27 26.27 11.787 26.27 26.27-11.783 26.271-26.27 26.271z" style="fill:#231f20"/></svg></span><span class=navbar-brand__name></span></a><div class="td-navbar-nav-scroll ms-md-auto" id=main_navbar><ul class=navbar-nav><li class=nav-item><a class=nav-link href=/41/><span>Documentation</span></a></li><li class=nav-item><a class=nav-link href=/blog/><span>Blog</span></a></li><li class=nav-item><a class=nav-link href=/community/><span>Community</span></a></li><li class=nav-item><a class=nav-link href=/testimonials/><span>Testimonials</span></a></li><li class=nav-item><a class=nav-link href=/community/downloads/><span>Download Kafka</span></a></li><li class="nav-item dropdown d-none d-lg-block"><div class=dropdown><a class="nav-link dropdown-toggle" href=# role=button data-bs-toggle=dropdown aria-haspopup=true aria-expanded=false>Releases</a><ul class=dropdown-menu><li><a class=dropdown-item href=/41/>4.1</a></li><li><a class=dropdown-item href=/40/>4.0</a></li><li><a class=dropdown-item href=/39/>3.9</a></li><li><a class=dropdown-item href=/38/>3.8</a></li><li><a class=dropdown-item href=/37/>3.7</a></li><li><a class=dropdown-item href=/36/>3.6</a></li><li><a class=dropdown-item href=/35/>3.5</a></li><li><a class=dropdown-item href=/34/>3.4</a></li><li><a class=dropdown-item href=/33/>3.3</a></li><li><a class=dropdown-item href=/32/>3.2</a></li><li><a class=dropdown-item href=/31/>3.1</a></li><li><a class=dropdown-item href=/30/>3.0</a></li><li><a class=dropdown-item href=/28/>2.8</a></li><li><a class=dropdown-item href=/27/>2.7</a></li><li><a class=dropdown-item href=/26/>2.6</a></li><li><a class=dropdown-item href=/25/>2.5</a></li><li><a class=dropdown-item href=/24/>2.4</a></li><li><a class=dropdown-item href=/23/>2.3</a></li><li><a class=dropdown-item href=/22/>2.2</a></li><li><a class=dropdown-item href=/21/>2.1</a></li><li><a class=dropdown-item href=/20/>2.0</a></li><li><a class=dropdown-item href=/11/>1.1</a></li><li><a class=dropdown-item href=/10/>1.0</a></li><li><a class=dropdown-item href=/0110/>0.11.0</a></li><li><a class=dropdown-item href=/0102/>0.10.2</a></li><li><a class=dropdown-item href=/0101/>0.10.1</a></li><li><a class=dropdown-item href=/0100/>0.10.0</a></li><li><a class=dropdown-item href=/090/>0.9.0</a></li><li><a class=dropdown-item href=/082/>0.8.2</a></li><li><a class=dropdown-item href=/081/>0.8.1</a></li><li><a class=dropdown-item href=/080/>0.8.0</a></li><li><a class=dropdown-item href=/07/>0.7</a></li></ul></div></li></ul></div><div class="d-none d-lg-block"><div class="td-search td-search--offline"><div class=td-search__icon></div><input type=search class="td-search__input form-control" placeholder="Search this site…" aria-label="Search this site…" autocomplete=off data-offline-search-index-json-src=/offline-search-index.e58a36913f949563db0a14b5eaf8f6a5.json data-offline-search-base-href=/ data-offline-search-max-results=10></div></div></div></nav></header><div class="container-fluid td-outer"><div class=td-main><div class="row flex-xl-nowrap"><aside class="col-12 col-md-3 col-xl-2 td-sidebar d-print-none"><div id=td-sidebar-menu class=td-sidebar__inner><div id=content-mobile><form class="td-sidebar__search d-flex align-items-center"><div class="td-search td-search--offline"><div class=td-search__icon></div><input type=search class="td-search__input form-control" placeholder="Search this site…" aria-label="Search this site…" autocomplete=off data-offline-search-index-json-src=/offline-search-index.e58a36913f949563db0a14b5eaf8f6a5.json data-offline-search-base-href=/ data-offline-search-max-results=10></div><button class="btn btn-link td-sidebar__toggle d-md-none p-0 ms-3 fas fa-bars" type=button data-bs-toggle=collapse data-bs-target=#td-section-nav aria-controls=td-section-nav aria-expanded=false aria-label="Toggle section navigation"></button></form></div><div id=content-desktop></div><nav class="td-sidebar-nav collapse td-sidebar-nav--search-disabled foldable-nav" id=td-section-nav><ul class="td-sidebar-nav__section pe-md-3 ul-0"><li class="td-sidebar-nav__section-title td-sidebar-nav__section with-child active-path" id=m-34-li><a href=/34/ class="align-left ps-0 td-sidebar-link td-sidebar-link__section tree-root" id=m-34><span>AK 3.4.X</span></a><ul class=ul-1><li class="td-sidebar-nav__section-title td-sidebar-nav__section with-child" id=m-34getting-started-li><input type=checkbox id=m-34getting-started-check>
<label for=m-34getting-started-check><a href=/34/getting-started/ class="align-left ps-0 td-sidebar-link td-sidebar-link__section" id=m-34getting-started><span>Getting Started</span></a></label><ul class="ul-2 foldable"><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-34getting-startedintroduction-li><input type=checkbox id=m-34getting-startedintroduction-check>
<label for=m-34getting-startedintroduction-check><a href=/34/getting-started/introduction/ class="align-left ps-0 td-sidebar-link td-sidebar-link__page" id=m-34getting-startedintroduction><span>Introduction</span></a></label></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-34getting-starteduses-li><input type=checkbox id=m-34getting-starteduses-check>
<label for=m-34getting-starteduses-check><a href=/34/getting-started/uses/ class="align-left ps-0 td-sidebar-link td-sidebar-link__page" id=m-34getting-starteduses><span>Use Cases</span></a></label></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-34getting-startedquickstart-li><input type=checkbox id=m-34getting-startedquickstart-check>
<label for=m-34getting-startedquickstart-check><a href=/34/getting-started/quickstart/ class="align-left ps-0 td-sidebar-link td-sidebar-link__page" id=m-34getting-startedquickstart><span>Quick Start</span></a></label></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-34getting-startedecosystem-li><input type=checkbox id=m-34getting-startedecosystem-check>
<label for=m-34getting-startedecosystem-check><a href=/34/getting-started/ecosystem/ class="align-left ps-0 td-sidebar-link td-sidebar-link__page" id=m-34getting-startedecosystem><span>Ecosystem</span></a></label></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-34getting-startedupgrade-li><input type=checkbox id=m-34getting-startedupgrade-check>
<label for=m-34getting-startedupgrade-check><a href=/34/getting-started/upgrade/ class="align-left ps-0 td-sidebar-link td-sidebar-link__page" id=m-34getting-startedupgrade><span>Upgrading</span></a></label></li></ul></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section with-child" id=m-34apis-li><input type=checkbox id=m-34apis-check>
<label for=m-34apis-check><a href=/34/apis/ class="align-left ps-0 td-sidebar-link td-sidebar-link__section" id=m-34apis><span>APIs</span></a></label><ul class="ul-2 foldable"><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-34apisapi-li><input type=checkbox id=m-34apisapi-check>
<label for=m-34apisapi-check><a href=/34/apis/api/ class="align-left ps-0 td-sidebar-link td-sidebar-link__page" id=m-34apisapi><span>API</span></a></label></li></ul></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section with-child" id=m-34configuration-li><input type=checkbox id=m-34configuration-check>
<label for=m-34configuration-check><a href=/34/configuration/ class="align-left ps-0 td-sidebar-link td-sidebar-link__section" id=m-34configuration><span>Configuration</span></a></label><ul class="ul-2 foldable"><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-34configurationconfiguration-li><input type=checkbox id=m-34configurationconfiguration-check>
<label for=m-34configurationconfiguration-check><a href=/34/configuration/configuration/ class="align-left ps-0 td-sidebar-link td-sidebar-link__page" id=m-34configurationconfiguration><span>Configuration</span></a></label></li></ul></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section with-child" id=m-34design-li><input type=checkbox id=m-34design-check>
<label for=m-34design-check><a href=/34/design/ class="align-left ps-0 td-sidebar-link td-sidebar-link__section" id=m-34design><span>Design</span></a></label><ul class="ul-2 foldable"><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-34designdesign-li><input type=checkbox id=m-34designdesign-check>
<label for=m-34designdesign-check><a href=/34/design/design/ class="align-left ps-0 td-sidebar-link td-sidebar-link__page" id=m-34designdesign><span>Design</span></a></label></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-34designprotocol-li><input type=checkbox id=m-34designprotocol-check>
<label for=m-34designprotocol-check><a href=/34/design/protocol/ class="align-left ps-0 td-sidebar-link td-sidebar-link__page" id=m-34designprotocol><span>Protocol</span></a></label></li></ul></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section with-child" id=m-34implementation-li><input type=checkbox id=m-34implementation-check>
<label for=m-34implementation-check><a href=/34/implementation/ class="align-left ps-0 td-sidebar-link td-sidebar-link__section" id=m-34implementation><span>Implementation</span></a></label><ul class="ul-2 foldable"><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-34implementationnetwork-layer-li><input type=checkbox id=m-34implementationnetwork-layer-check>
<label for=m-34implementationnetwork-layer-check><a href=/34/implementation/network-layer/ class="align-left ps-0 td-sidebar-link td-sidebar-link__page" id=m-34implementationnetwork-layer><span>Network Layer</span></a></label></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-34implementationmessages-li><input type=checkbox id=m-34implementationmessages-check>
<label for=m-34implementationmessages-check><a href=/34/implementation/messages/ class="align-left ps-0 td-sidebar-link td-sidebar-link__page" id=m-34implementationmessages><span>Messages</span></a></label></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-34implementationmessage-format-li><input type=checkbox id=m-34implementationmessage-format-check>
<label for=m-34implementationmessage-format-check><a href=/34/implementation/message-format/ class="align-left ps-0 td-sidebar-link td-sidebar-link__page" id=m-34implementationmessage-format><span>Message Format</span></a></label></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-34implementationlog-li><input type=checkbox id=m-34implementationlog-check>
<label for=m-34implementationlog-check><a href=/34/implementation/log/ class="align-left ps-0 td-sidebar-link td-sidebar-link__page" id=m-34implementationlog><span>Log</span></a></label></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-34implementationdistribution-li><input type=checkbox id=m-34implementationdistribution-check>
<label for=m-34implementationdistribution-check><a href=/34/implementation/distribution/ class="align-left ps-0 td-sidebar-link td-sidebar-link__page" id=m-34implementationdistribution><span>Distribution</span></a></label></li></ul></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section with-child active-path" id=m-34operations-li><input type=checkbox id=m-34operations-check checked>
<label for=m-34operations-check><a href=/34/operations/ class="align-left ps-0 td-sidebar-link td-sidebar-link__section" id=m-34operations><span>Operations</span></a></label><ul class="ul-2 foldable"><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child active-path" id=m-34operationsbasic-kafka-operations-li><input type=checkbox id=m-34operationsbasic-kafka-operations-check checked>
<label for=m-34operationsbasic-kafka-operations-check><a href=/34/operations/basic-kafka-operations/ class="align-left ps-0 active td-sidebar-link td-sidebar-link__page" id=m-34operationsbasic-kafka-operations><span class=td-sidebar-nav-active-item>Basic Kafka Operations</span></a></label></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-34operationsdatacenters-li><input type=checkbox id=m-34operationsdatacenters-check>
<label for=m-34operationsdatacenters-check><a href=/34/operations/datacenters/ class="align-left ps-0 td-sidebar-link td-sidebar-link__page" id=m-34operationsdatacenters><span>Datacenters</span></a></label></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-34operationsgeo-replication-cross-cluster-data-mirroring-li><input type=checkbox id=m-34operationsgeo-replication-cross-cluster-data-mirroring-check>
<label for=m-34operationsgeo-replication-cross-cluster-data-mirroring-check><a href=/34/operations/geo-replication-cross-cluster-data-mirroring/ class="align-left ps-0 td-sidebar-link td-sidebar-link__page" id=m-34operationsgeo-replication-cross-cluster-data-mirroring><span>Geo-Replication (Cross-Cluster Data Mirroring)</span></a></label></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-34operationsmulti-tenancy-li><input type=checkbox id=m-34operationsmulti-tenancy-check>
<label for=m-34operationsmulti-tenancy-check><a href=/34/operations/multi-tenancy/ class="align-left ps-0 td-sidebar-link td-sidebar-link__page" id=m-34operationsmulti-tenancy><span>Multi-Tenancy</span></a></label></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-34operationskafka-configuration-li><input type=checkbox id=m-34operationskafka-configuration-check>
<label for=m-34operationskafka-configuration-check><a href=/34/operations/kafka-configuration/ class="align-left ps-0 td-sidebar-link td-sidebar-link__page" id=m-34operationskafka-configuration><span>Kafka Configuration</span></a></label></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-34operationsjava-version-li><input type=checkbox id=m-34operationsjava-version-check>
<label for=m-34operationsjava-version-check><a href=/34/operations/java-version/ class="align-left ps-0 td-sidebar-link td-sidebar-link__page" id=m-34operationsjava-version><span>Java Version</span></a></label></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-34operationshardware-and-os-li><input type=checkbox id=m-34operationshardware-and-os-check>
<label for=m-34operationshardware-and-os-check><a href=/34/operations/hardware-and-os/ class="align-left ps-0 td-sidebar-link td-sidebar-link__page" id=m-34operationshardware-and-os><span>Hardware and OS</span></a></label></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-34operationsmonitoring-li><input type=checkbox id=m-34operationsmonitoring-check>
<label for=m-34operationsmonitoring-check><a href=/34/operations/monitoring/ class="align-left ps-0 td-sidebar-link td-sidebar-link__page" id=m-34operationsmonitoring><span>Monitoring</span></a></label></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-34operationszookeeper-li><input type=checkbox id=m-34operationszookeeper-check>
<label for=m-34operationszookeeper-check><a href=/34/operations/zookeeper/ class="align-left ps-0 td-sidebar-link td-sidebar-link__page" id=m-34operationszookeeper><span>ZooKeeper</span></a></label></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-34operationskraft-li><input type=checkbox id=m-34operationskraft-check>
<label for=m-34operationskraft-check><a href=/34/operations/kraft/ class="align-left ps-0 td-sidebar-link td-sidebar-link__page" id=m-34operationskraft><span>KRaft</span></a></label></li></ul></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section with-child" id=m-34security-li><input type=checkbox id=m-34security-check>
<label for=m-34security-check><a href=/34/security/ class="align-left ps-0 td-sidebar-link td-sidebar-link__section" id=m-34security><span>Security</span></a></label><ul class="ul-2 foldable"><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-34securitysecurity-overview-li><input type=checkbox id=m-34securitysecurity-overview-check>
<label for=m-34securitysecurity-overview-check><a href=/34/security/security-overview/ class="align-left ps-0 td-sidebar-link td-sidebar-link__page" id=m-34securitysecurity-overview><span>Security Overview</span></a></label></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-34securitylistener-configuration-li><input type=checkbox id=m-34securitylistener-configuration-check>
<label for=m-34securitylistener-configuration-check><a href=/34/security/listener-configuration/ class="align-left ps-0 td-sidebar-link td-sidebar-link__page" id=m-34securitylistener-configuration><span>Listener Configuration</span></a></label></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-34securityencryption-and-authentication-using-ssl-li><input type=checkbox id=m-34securityencryption-and-authentication-using-ssl-check>
<label for=m-34securityencryption-and-authentication-using-ssl-check><a href=/34/security/encryption-and-authentication-using-ssl/ class="align-left ps-0 td-sidebar-link td-sidebar-link__page" id=m-34securityencryption-and-authentication-using-ssl><span>Encryption and Authentication using SSL</span></a></label></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-34securityauthentication-using-sasl-li><input type=checkbox id=m-34securityauthentication-using-sasl-check>
<label for=m-34securityauthentication-using-sasl-check><a href=/34/security/authentication-using-sasl/ class="align-left ps-0 td-sidebar-link td-sidebar-link__page" id=m-34securityauthentication-using-sasl><span>Authentication using SASL</span></a></label></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-34securityauthorization-and-acls-li><input type=checkbox id=m-34securityauthorization-and-acls-check>
<label for=m-34securityauthorization-and-acls-check><a href=/34/security/authorization-and-acls/ class="align-left ps-0 td-sidebar-link td-sidebar-link__page" id=m-34securityauthorization-and-acls><span>Authorization and ACLs</span></a></label></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-34securityincorporating-security-features-in-a-running-cluster-li><input type=checkbox id=m-34securityincorporating-security-features-in-a-running-cluster-check>
<label for=m-34securityincorporating-security-features-in-a-running-cluster-check><a href=/34/security/incorporating-security-features-in-a-running-cluster/ class="align-left ps-0 td-sidebar-link td-sidebar-link__page" id=m-34securityincorporating-security-features-in-a-running-cluster><span>Incorporating Security Features in a Running Cluster</span></a></label></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-34securityzookeeper-authentication-li><input type=checkbox id=m-34securityzookeeper-authentication-check>
<label for=m-34securityzookeeper-authentication-check><a href=/34/security/zookeeper-authentication/ class="align-left ps-0 td-sidebar-link td-sidebar-link__page" id=m-34securityzookeeper-authentication><span>ZooKeeper Authentication</span></a></label></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-34securityzookeeper-encryption-li><input type=checkbox id=m-34securityzookeeper-encryption-check>
<label for=m-34securityzookeeper-encryption-check><a href=/34/security/zookeeper-encryption/ class="align-left ps-0 td-sidebar-link td-sidebar-link__page" id=m-34securityzookeeper-encryption><span>ZooKeeper Encryption</span></a></label></li></ul></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section with-child" id=m-34kafka-connect-li><input type=checkbox id=m-34kafka-connect-check>
<label for=m-34kafka-connect-check><a href=/34/kafka-connect/ class="align-left ps-0 td-sidebar-link td-sidebar-link__section" id=m-34kafka-connect><span>Kafka Connect</span></a></label><ul class="ul-2 foldable"><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-34kafka-connectoverview-li><input type=checkbox id=m-34kafka-connectoverview-check>
<label for=m-34kafka-connectoverview-check><a href=/34/kafka-connect/overview/ class="align-left ps-0 td-sidebar-link td-sidebar-link__page" id=m-34kafka-connectoverview><span>Overview</span></a></label></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-34kafka-connectuser-guide-li><input type=checkbox id=m-34kafka-connectuser-guide-check>
<label for=m-34kafka-connectuser-guide-check><a href=/34/kafka-connect/user-guide/ class="align-left ps-0 td-sidebar-link td-sidebar-link__page" id=m-34kafka-connectuser-guide><span>User Guide</span></a></label></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-34kafka-connectconnector-development-guide-li><input type=checkbox id=m-34kafka-connectconnector-development-guide-check>
<label for=m-34kafka-connectconnector-development-guide-check><a href=/34/kafka-connect/connector-development-guide/ class="align-left ps-0 td-sidebar-link td-sidebar-link__page" id=m-34kafka-connectconnector-development-guide><span>Connector Development Guide</span></a></label></li></ul></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section with-child" id=m-34streams-li><input type=checkbox id=m-34streams-check>
<label for=m-34streams-check><a href=/34/streams/ class="align-left ps-0 td-sidebar-link td-sidebar-link__section" id=m-34streams><span>Kafka Streams</span></a></label><ul class="ul-2 foldable"><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-34streamsintroduction-li><input type=checkbox id=m-34streamsintroduction-check>
<label for=m-34streamsintroduction-check><a href=/34/streams/introduction/ class="align-left ps-0 td-sidebar-link td-sidebar-link__page" id=m-34streamsintroduction><span>Introduction</span></a></label></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-34streamsquickstart-li><input type=checkbox id=m-34streamsquickstart-check>
<label for=m-34streamsquickstart-check><a href=/34/streams/quickstart/ class="align-left ps-0 td-sidebar-link td-sidebar-link__page" id=m-34streamsquickstart><span>Quick Start</span></a></label></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-34streamstutorial-li><input type=checkbox id=m-34streamstutorial-check>
<label for=m-34streamstutorial-check><a href=/34/streams/tutorial/ class="align-left ps-0 td-sidebar-link td-sidebar-link__page" id=m-34streamstutorial><span>Write a streams app</span></a></label></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-34streamscore-concepts-li><input type=checkbox id=m-34streamscore-concepts-check>
<label for=m-34streamscore-concepts-check><a href=/34/streams/core-concepts/ class="align-left ps-0 td-sidebar-link td-sidebar-link__page" id=m-34streamscore-concepts><span>Core Concepts</span></a></label></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-34streamsarchitecture-li><input type=checkbox id=m-34streamsarchitecture-check>
<label for=m-34streamsarchitecture-check><a href=/34/streams/architecture/ class="align-left ps-0 td-sidebar-link td-sidebar-link__page" id=m-34streamsarchitecture><span>Architecture</span></a></label></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-34streamsupgrade-guide-li><input type=checkbox id=m-34streamsupgrade-guide-check>
<label for=m-34streamsupgrade-guide-check><a href=/34/streams/upgrade-guide/ class="align-left ps-0 td-sidebar-link td-sidebar-link__page" id=m-34streamsupgrade-guide><span>Upgrade Guide</span></a></label></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section with-child" id=m-34streamsdeveloper-guide-li><input type=checkbox id=m-34streamsdeveloper-guide-check>
<label for=m-34streamsdeveloper-guide-check><a href=/34/streams/developer-guide/ class="align-left ps-0 td-sidebar-link td-sidebar-link__section" id=m-34streamsdeveloper-guide><span>Streams Developer Guide</span></a></label><ul class="ul-3 foldable"><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-34streamsdeveloper-guidewrite-streams-app-li><input type=checkbox id=m-34streamsdeveloper-guidewrite-streams-app-check>
<label for=m-34streamsdeveloper-guidewrite-streams-app-check><a href=/34/streams/developer-guide/write-streams-app/ class="align-left ps-0 td-sidebar-link td-sidebar-link__page" id=m-34streamsdeveloper-guidewrite-streams-app><span>Writing a Streams Application</span></a></label></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-34streamsdeveloper-guideconfig-streams-li><input type=checkbox id=m-34streamsdeveloper-guideconfig-streams-check>
<label for=m-34streamsdeveloper-guideconfig-streams-check><a href=/34/streams/developer-guide/config-streams/ class="align-left ps-0 td-sidebar-link td-sidebar-link__page" id=m-34streamsdeveloper-guideconfig-streams><span>Configuring a Streams Application</span></a></label></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-34streamsdeveloper-guidedsl-api-li><input type=checkbox id=m-34streamsdeveloper-guidedsl-api-check>
<label for=m-34streamsdeveloper-guidedsl-api-check><a href=/34/streams/developer-guide/dsl-api/ class="align-left ps-0 td-sidebar-link td-sidebar-link__page" id=m-34streamsdeveloper-guidedsl-api><span>Streams DSL</span></a></label></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-34streamsdeveloper-guideprocessor-api-li><input type=checkbox id=m-34streamsdeveloper-guideprocessor-api-check>
<label for=m-34streamsdeveloper-guideprocessor-api-check><a href=/34/streams/developer-guide/processor-api/ class="align-left ps-0 td-sidebar-link td-sidebar-link__page" id=m-34streamsdeveloper-guideprocessor-api><span>Processor API</span></a></label></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-34streamsdeveloper-guidedsl-topology-naming-li><input type=checkbox id=m-34streamsdeveloper-guidedsl-topology-naming-check>
<label for=m-34streamsdeveloper-guidedsl-topology-naming-check><a href=/34/streams/developer-guide/dsl-topology-naming/ class="align-left ps-0 td-sidebar-link td-sidebar-link__page" id=m-34streamsdeveloper-guidedsl-topology-naming><span>Naming Operators in a Streams DSL application</span></a></label></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-34streamsdeveloper-guidedatatypes-li><input type=checkbox id=m-34streamsdeveloper-guidedatatypes-check>
<label for=m-34streamsdeveloper-guidedatatypes-check><a href=/34/streams/developer-guide/datatypes/ class="align-left ps-0 td-sidebar-link td-sidebar-link__page" id=m-34streamsdeveloper-guidedatatypes><span>Data Types and Serialization</span></a></label></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-34streamsdeveloper-guidetesting-li><input type=checkbox id=m-34streamsdeveloper-guidetesting-check>
<label for=m-34streamsdeveloper-guidetesting-check><a href=/34/streams/developer-guide/testing/ class="align-left ps-0 td-sidebar-link td-sidebar-link__page" id=m-34streamsdeveloper-guidetesting><span>Testing a Streams Application</span></a></label></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-34streamsdeveloper-guideinteractive-queries-li><input type=checkbox id=m-34streamsdeveloper-guideinteractive-queries-check>
<label for=m-34streamsdeveloper-guideinteractive-queries-check><a href=/34/streams/developer-guide/interactive-queries/ class="align-left ps-0 td-sidebar-link td-sidebar-link__page" id=m-34streamsdeveloper-guideinteractive-queries><span>Interactive Queries</span></a></label></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-34streamsdeveloper-guidememory-mgmt-li><input type=checkbox id=m-34streamsdeveloper-guidememory-mgmt-check>
<label for=m-34streamsdeveloper-guidememory-mgmt-check><a href=/34/streams/developer-guide/memory-mgmt/ class="align-left ps-0 td-sidebar-link td-sidebar-link__page" id=m-34streamsdeveloper-guidememory-mgmt><span>Memory Management</span></a></label></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-34streamsdeveloper-guiderunning-app-li><input type=checkbox id=m-34streamsdeveloper-guiderunning-app-check>
<label for=m-34streamsdeveloper-guiderunning-app-check><a href=/34/streams/developer-guide/running-app/ class="align-left ps-0 td-sidebar-link td-sidebar-link__page" id=m-34streamsdeveloper-guiderunning-app><span>Running Streams Applications</span></a></label></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-34streamsdeveloper-guidemanage-topics-li><input type=checkbox id=m-34streamsdeveloper-guidemanage-topics-check>
<label for=m-34streamsdeveloper-guidemanage-topics-check><a href=/34/streams/developer-guide/manage-topics/ class="align-left ps-0 td-sidebar-link td-sidebar-link__page" id=m-34streamsdeveloper-guidemanage-topics><span>Managing Streams Application Topics</span></a></label></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-34streamsdeveloper-guidesecurity-li><input type=checkbox id=m-34streamsdeveloper-guidesecurity-check>
<label for=m-34streamsdeveloper-guidesecurity-check><a href=/34/streams/developer-guide/security/ class="align-left ps-0 td-sidebar-link td-sidebar-link__page" id=m-34streamsdeveloper-guidesecurity><span>Streams Security</span></a></label></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-34streamsdeveloper-guideapp-reset-tool-li><input type=checkbox id=m-34streamsdeveloper-guideapp-reset-tool-check>
<label for=m-34streamsdeveloper-guideapp-reset-tool-check><a href=/34/streams/developer-guide/app-reset-tool/ class="align-left ps-0 td-sidebar-link td-sidebar-link__page" id=m-34streamsdeveloper-guideapp-reset-tool><span>Application Reset Tool</span></a></label></li></ul></li></ul></li></ul></li></ul></nav></div></aside><aside class="d-none d-xl-block col-xl-2 td-sidebar-toc d-print-none"><div class="td-page-meta ms-2 pb-1 pt-2 mb-0"><a href=https://github.com/apache/kafka-site//tree/markdown/content/en/34/operations/basic-kafka-operations.md class="td-page-meta--view td-page-meta__view" target=_blank rel=noopener><i class="fa-solid fa-file-lines fa-fw"></i> View page source</a>
<a href=https://github.com/apache/kafka-site//edit/markdown/content/en/34/operations/basic-kafka-operations.md class="td-page-meta--edit td-page-meta__edit" target=_blank rel=noopener><i class="fa-solid fa-pen-to-square fa-fw"></i> Edit this page</a>
<a href="https://github.com/apache/kafka-site//new/markdown/content/en/34/operations?filename=change-me.md&amp;value=---%0Atitle%3A+%22Long+Page+Title%22%0AlinkTitle%3A+%22Short+Nav+Title%22%0Aweight%3A+100%0Adescription%3A+%3E-%0A+++++Page+description+for+heading+and+indexes.%0A---%0A%0A%23%23+Heading%0A%0AEdit+this+template+to+create+your+new+page.%0A%0A%2A+Give+it+a+good+name%2C+ending+in+%60.md%60+-+e.g.+%60getting-started.md%60%0A%2A+Edit+the+%22front+matter%22+section+at+the+top+of+the+page+%28weight+controls+how+its+ordered+amongst+other+pages+in+the+same+directory%3B+lowest+number+first%29.%0A%2A+Add+a+good+commit+message+at+the+bottom+of+the+page+%28%3C80+characters%3B+use+the+extended+description+field+for+more+detail%29.%0A%2A+Create+a+new+branch+so+you+can+preview+your+new+file+and+request+a+review+via+Pull+Request.%0A" class="td-page-meta--child td-page-meta__child" target=_blank rel=noopener><i class="fa-solid fa-pen-to-square fa-fw"></i> Create child page</a>
<a href="https://github.com/apache/kafka-site//issues/new?title=Basic%20Kafka%20Operations" class="td-page-meta--issue td-page-meta__issue" target=_blank rel=noopener><i class="fa-solid fa-list-check fa-fw"></i> Create documentation issue</a>
<a id=print href=/34/operations/_print/><i class="fa-solid fa-print fa-fw"></i> Print entire section</a></div><div class=td-toc><nav id=TableOfContents><ul><li><a href=#adding-and-removing-topics>Adding and removing topics</a></li><li><a href=#modifying-topics>Modifying topics</a></li><li><a href=#graceful-shutdown>Graceful shutdown</a></li><li><a href=#balancing-leadership>Balancing leadership</a></li><li><a href=#balancing-replicas-across-racks>Balancing Replicas Across Racks</a></li><li><a href=#mirroring-data-between-clusters--geo-replication>Mirroring data between clusters & Geo-replication</a></li><li><a href=#checking-consumer-position>Checking consumer position</a></li><li><a href=#managing-consumer-groups>Managing Consumer Groups</a></li><li><a href=#expanding-your-cluster>Expanding your cluster</a><ul><li><a href=#automatically-migrating-data-to-new-machines>Automatically migrating data to new machines</a></li><li><a href=#custom-partition-assignment-and-migration>Custom partition assignment and migration</a></li></ul></li><li><a href=#decommissioning-brokers>Decommissioning brokers</a></li><li><a href=#increasing-replication-factor>Increasing replication factor</a></li><li><a href=#limiting-bandwidth-usage-during-data-migration>Limiting Bandwidth Usage during Data Migration</a><ul><li><a href=#safe-usage-of-throttled-replication>Safe usage of throttled replication</a></li></ul></li><li><a href=#setting-quotas>Setting quotas</a></li></ul></nav></div><div class="taxonomy taxonomy-terms-cloud taxo-tags"><h5 class=taxonomy-title>Tag Cloud</h5><ul class=taxonomy-terms><li><a class=taxonomy-term href=https://example.kafka-site-md.dev/tags/apis/ data-taxonomy-term=apis><span class=taxonomy-label>Apis</span><span class=taxonomy-count>32</span></a></li><li><a class=taxonomy-term href=https://example.kafka-site-md.dev/tags/configuration/ data-taxonomy-term=configuration><span class=taxonomy-label>Configuration</span><span class=taxonomy-count>32</span></a></li><li><a class=taxonomy-term href=https://example.kafka-site-md.dev/tags/design/ data-taxonomy-term=design><span class=taxonomy-label>Design</span><span class=taxonomy-count>32</span></a></li><li><a class=taxonomy-term href=https://example.kafka-site-md.dev/tags/developer-guide/ data-taxonomy-term=developer-guide><span class=taxonomy-label>Developer-Guide</span><span class=taxonomy-count>32</span></a></li><li><a class=taxonomy-term href=https://example.kafka-site-md.dev/tags/docs/ data-taxonomy-term=docs><span class=taxonomy-label>Docs</span><span class=taxonomy-count>1781</span></a></li><li><a class=taxonomy-term href=https://example.kafka-site-md.dev/tags/getting-started/ data-taxonomy-term=getting-started><span class=taxonomy-label>Getting-Started</span><span class=taxonomy-count>32</span></a></li><li><a class=taxonomy-term href=https://example.kafka-site-md.dev/tags/implementation/ data-taxonomy-term=implementation><span class=taxonomy-label>Implementation</span><span class=taxonomy-count>32</span></a></li><li><a class=taxonomy-term href=https://example.kafka-site-md.dev/tags/kafka/ data-taxonomy-term=kafka><span class=taxonomy-label>Kafka</span><span class=taxonomy-count>1781</span></a></li><li><a class=taxonomy-term href=https://example.kafka-site-md.dev/tags/ops/ data-taxonomy-term=ops><span class=taxonomy-label>Ops</span><span class=taxonomy-count>32</span></a></li><li><a class=taxonomy-term href=https://example.kafka-site-md.dev/tags/security/ data-taxonomy-term=security><span class=taxonomy-label>Security</span><span class=taxonomy-count>64</span></a></li><li><a class=taxonomy-term href=https://example.kafka-site-md.dev/tags/streams/ data-taxonomy-term=streams><span class=taxonomy-label>Streams</span><span class=taxonomy-count>64</span></a></li></ul></div></aside><main class="col-12 col-md-9 col-xl-8 ps-md-5" role=main><div class="pageinfo pageinfo-warning"><p>You are viewing documentation for an older version (3.4) of Kafka.
For up-to-date documentation, see the
<a href=/41/ target=_blank>latest version</a>.</p></div><nav aria-label=breadcrumb class=td-breadcrumbs><ol class=breadcrumb><li class=breadcrumb-item><a href=/34/>AK 3.4.X</a></li><li class=breadcrumb-item><a href=/34/operations/>Operations</a></li><li class="breadcrumb-item active" aria-current=page>Basic Kafka Operations</li></ol></nav><div class=td-content><h1>Basic Kafka Operations</h1><div class=lead>Basic Kafka Operations</div><header class=article-meta><div class="taxonomy taxonomy-terms-article taxo-tags"><h5 class=taxonomy-title>Tags:</h5><ul class=taxonomy-terms><li><a class=taxonomy-term href=https://example.kafka-site-md.dev/tags/kafka/ data-taxonomy-term=kafka><span class=taxonomy-label>Kafka</span></a></li><li><a class=taxonomy-term href=https://example.kafka-site-md.dev/tags/docs/ data-taxonomy-term=docs><span class=taxonomy-label>Docs</span></a></li></ul></div></header><h1 id=basic-kafka-operations>Basic Kafka Operations<a class=td-heading-self-link href=#basic-kafka-operations aria-label="Heading self-link"></a></h1><p>This section will review the most common operations you will perform on your Kafka cluster. All of the tools reviewed in this section are available under the <code>bin/</code> directory of the Kafka distribution and each tool will print details on all possible commandline options if it is run with no arguments.</p><h2 id=adding-and-removing-topics>Adding and removing topics<a class=td-heading-self-link href=#adding-and-removing-topics aria-label="Heading self-link"></a></h2><p>You have the option of either adding topics manually or having them be created automatically when data is first published to a non-existent topic. If topics are auto-created then you may want to tune the default topic configurations used for auto-created topics.</p><p>Topics are added and modified using the topic tool:</p><pre><code>  &gt; bin/kafka-topics.sh --bootstrap-server broker_host:port --create --topic my_topic_name \
        --partitions 20 --replication-factor 3 --config x=y
</code></pre><p>The replication factor controls how many servers will replicate each message that is written. If you have a replication factor of 3 then up to 2 servers can fail before you will lose access to your data. We recommend you use a replication factor of 2 or 3 so that you can transparently bounce machines without interrupting data consumption.</p><p>The partition count controls how many logs the topic will be sharded into. There are several impacts of the partition count. First each partition must fit entirely on a single server. So if you have 20 partitions the full data set (and read and write load) will be handled by no more than 20 servers (not counting replicas). Finally the partition count impacts the maximum parallelism of your consumers. This is discussed in greater detail in the concepts section.</p><p>Each sharded partition log is placed into its own folder under the Kafka log directory. The name of such folders consists of the topic name, appended by a dash (-) and the partition id. Since a typical folder name can not be over 255 characters long, there will be a limitation on the length of topic names. We assume the number of partitions will not ever be above 100,000. Therefore, topic names cannot be longer than 249 characters. This leaves just enough room in the folder name for a dash and a potentially 5 digit long partition id.</p><p>The configurations added on the command line override the default settings the server has for things like the length of time data should be retained. The complete set of per-topic configurations is documented here.</p><h2 id=modifying-topics>Modifying topics<a class=td-heading-self-link href=#modifying-topics aria-label="Heading self-link"></a></h2><p>You can change the configuration or partitioning of a topic using the same topic tool.</p><p>To add partitions you can do</p><pre><code>  &gt; bin/kafka-topics.sh --bootstrap-server broker_host:port --alter --topic my_topic_name \
        --partitions 40
</code></pre><p>Be aware that one use case for partitions is to semantically partition data, and adding partitions doesn&rsquo;t change the partitioning of existing data so this may disturb consumers if they rely on that partition. That is if data is partitioned by <code>hash(key) % number_of_partitions</code> then this partitioning will potentially be shuffled by adding partitions but Kafka will not attempt to automatically redistribute data in any way.</p><p>To add configs:</p><pre><code>  &gt; bin/kafka-configs.sh --bootstrap-server broker_host:port --entity-type topics --entity-name my_topic_name --alter --add-config x=y
</code></pre><p>To remove a config:</p><pre><code>  &gt; bin/kafka-configs.sh --bootstrap-server broker_host:port --entity-type topics --entity-name my_topic_name --alter --delete-config x
</code></pre><p>And finally deleting a topic:</p><pre><code>  &gt; bin/kafka-topics.sh --bootstrap-server broker_host:port --delete --topic my_topic_name
</code></pre><p>Kafka does not currently support reducing the number of partitions for a topic.</p><p>Instructions for changing the replication factor of a topic can be found here.</p><h2 id=graceful-shutdown>Graceful shutdown<a class=td-heading-self-link href=#graceful-shutdown aria-label="Heading self-link"></a></h2><p>The Kafka cluster will automatically detect any broker shutdown or failure and elect new leaders for the partitions on that machine. This will occur whether a server fails or it is brought down intentionally for maintenance or configuration changes. For the latter cases Kafka supports a more graceful mechanism for stopping a server than just killing it. When a server is stopped gracefully it has two optimizations it will take advantage of:</p><ol><li><p>It will sync all its logs to disk to avoid needing to do any log recovery when it restarts (i.e. validating the checksum for all messages in the tail of the log). Log recovery takes time so this speeds up intentional restarts.</p></li><li><p>It will migrate any partitions the server is the leader for to other replicas prior to shutting down. This will make the leadership transfer faster and minimize the time each partition is unavailable to a few milliseconds.
Syncing the logs will happen automatically whenever the server is stopped other than by a hard kill, but the controlled leadership migration requires using a special setting:</p><pre><code> controlled.shutdown.enable=true
</code></pre></li></ol><p>Note that controlled shutdown will only succeed if <em>all</em> the partitions hosted on the broker have replicas (i.e. the replication factor is greater than 1 <em>and</em> at least one of these replicas is alive). This is generally what you want since shutting down the last replica would make that topic partition unavailable.</p><h2 id=balancing-leadership>Balancing leadership<a class=td-heading-self-link href=#balancing-leadership aria-label="Heading self-link"></a></h2><p>Whenever a broker stops or crashes, leadership for that broker&rsquo;s partitions transfers to other replicas. When the broker is restarted it will only be a follower for all its partitions, meaning it will not be used for client reads and writes.</p><p>To avoid this imbalance, Kafka has a notion of preferred replicas. If the list of replicas for a partition is 1,5,9 then node 1 is preferred as the leader to either node 5 or 9 because it is earlier in the replica list. By default the Kafka cluster will try to restore leadership to the preferred replicas. This behaviour is configured with:</p><pre><code>      auto.leader.rebalance.enable=true
</code></pre><p>You can also set this to false, but you will then need to manually restore leadership to the restored replicas by running the command:</p><pre><code>  &gt; bin/kafka-leader-election.sh --bootstrap-server broker_host:port --election-type preferred --all-topic-partitions
</code></pre><h2 id=balancing-replicas-across-racks>Balancing Replicas Across Racks<a class=td-heading-self-link href=#balancing-replicas-across-racks aria-label="Heading self-link"></a></h2><p>The rack awareness feature spreads replicas of the same partition across different racks. This extends the guarantees Kafka provides for broker-failure to cover rack-failure, limiting the risk of data loss should all the brokers on a rack fail at once. The feature can also be applied to other broker groupings such as availability zones in EC2.</p><p>You can specify that a broker belongs to a particular rack by adding a property to the broker config:</p><pre><code>  broker.rack=my-rack-id
</code></pre><p>When a topic is created, modified or replicas are redistributed, the rack constraint will be honoured, ensuring replicas span as many racks as they can (a partition will span min(#racks, replication-factor) different racks).</p><p>The algorithm used to assign replicas to brokers ensures that the number of leaders per broker will be constant, regardless of how brokers are distributed across racks. This ensures balanced throughput.</p><p>However if racks are assigned different numbers of brokers, the assignment of replicas will not be even. Racks with fewer brokers will get more replicas, meaning they will use more storage and put more resources into replication. Hence it is sensible to configure an equal number of brokers per rack.</p><h2 id=mirroring-data-between-clusters--geo-replication>Mirroring data between clusters & Geo-replication<a class=td-heading-self-link href=#mirroring-data-between-clusters--geo-replication aria-label="Heading self-link"></a></h2><p>Kafka administrators can define data flows that cross the boundaries of individual Kafka clusters, data centers, or geographical regions. Please refer to the section on Geo-Replication for further information.</p><h2 id=checking-consumer-position>Checking consumer position<a class=td-heading-self-link href=#checking-consumer-position aria-label="Heading self-link"></a></h2><p>Sometimes it&rsquo;s useful to see the position of your consumers. We have a tool that will show the position of all consumers in a consumer group as well as how far behind the end of the log they are. To run this tool on a consumer group named <em>my-group</em> consuming a topic named <em>my-topic</em> would look like this:</p><pre><code>  &gt; bin/kafka-consumer-groups.sh --bootstrap-server localhost:9092 --describe --group my-group

  TOPIC                          PARTITION  CURRENT-OFFSET  LOG-END-OFFSET  LAG        CONSUMER-ID                                       HOST                           CLIENT-ID
  my-topic                       0          2               4               2          consumer-1-029af89c-873c-4751-a720-cefd41a669d6   /127.0.0.1                     consumer-1
  my-topic                       1          2               3               1          consumer-1-029af89c-873c-4751-a720-cefd41a669d6   /127.0.0.1                     consumer-1
  my-topic                       2          2               3               1          consumer-2-42c1abd4-e3b2-425d-a8bb-e1ea49b29bb2   /127.0.0.1                     consumer-2
</code></pre><h2 id=managing-consumer-groups>Managing Consumer Groups<a class=td-heading-self-link href=#managing-consumer-groups aria-label="Heading self-link"></a></h2><p>With the ConsumerGroupCommand tool, we can list, describe, or delete the consumer groups. The consumer group can be deleted manually, or automatically when the last committed offset for that group expires. Manual deletion works only if the group does not have any active members. For example, to list all consumer groups across all topics:</p><pre><code>  &gt; bin/kafka-consumer-groups.sh --bootstrap-server localhost:9092 --list

  test-consumer-group
</code></pre><p>To view offsets, as mentioned earlier, we &ldquo;describe&rdquo; the consumer group like this:</p><pre><code>  &gt; bin/kafka-consumer-groups.sh --bootstrap-server localhost:9092 --describe --group my-group

  TOPIC           PARTITION  CURRENT-OFFSET  LOG-END-OFFSET  LAG             CONSUMER-ID                                    HOST            CLIENT-ID
  topic3          0          241019          395308          154289          consumer2-e76ea8c3-5d30-4299-9005-47eb41f3d3c4 /127.0.0.1      consumer2
  topic2          1          520678          803288          282610          consumer2-e76ea8c3-5d30-4299-9005-47eb41f3d3c4 /127.0.0.1      consumer2
  topic3          1          241018          398817          157799          consumer2-e76ea8c3-5d30-4299-9005-47eb41f3d3c4 /127.0.0.1      consumer2
  topic1          0          854144          855809          1665            consumer1-3fc8d6f1-581a-4472-bdf3-3515b4aee8c1 /127.0.0.1      consumer1
  topic2          0          460537          803290          342753          consumer1-3fc8d6f1-581a-4472-bdf3-3515b4aee8c1 /127.0.0.1      consumer1
  topic3          2          243655          398812          155157          consumer4-117fe4d3-c6c1-4178-8ee9-eb4a3954bee0 /127.0.0.1      consumer4
</code></pre><p>There are a number of additional &ldquo;describe&rdquo; options that can be used to provide more detailed information about a consumer group:</p><ul><li><p>--members: This option provides the list of all active members in the consumer group.</p><pre><code>      &gt; bin/kafka-consumer-groups.sh --bootstrap-server localhost:9092 --describe --group my-group --members

  CONSUMER-ID                                    HOST            CLIENT-ID       #PARTITIONS
  consumer1-3fc8d6f1-581a-4472-bdf3-3515b4aee8c1 /127.0.0.1      consumer1       2
  consumer4-117fe4d3-c6c1-4178-8ee9-eb4a3954bee0 /127.0.0.1      consumer4       1
  consumer2-e76ea8c3-5d30-4299-9005-47eb41f3d3c4 /127.0.0.1      consumer2       3
  consumer3-ecea43e4-1f01-479f-8349-f9130b75d8ee /127.0.0.1      consumer3       0
</code></pre></li><li><p>--members &ndash;verbose: On top of the information reported by the &ldquo;&ndash;members&rdquo; options above, this option also provides the partitions assigned to each member.</p><pre><code>      &gt; bin/kafka-consumer-groups.sh --bootstrap-server localhost:9092 --describe --group my-group --members --verbose

  CONSUMER-ID                                    HOST            CLIENT-ID       #PARTITIONS     ASSIGNMENT
  consumer1-3fc8d6f1-581a-4472-bdf3-3515b4aee8c1 /127.0.0.1      consumer1       2               topic1(0), topic2(0)
  consumer4-117fe4d3-c6c1-4178-8ee9-eb4a3954bee0 /127.0.0.1      consumer4       1               topic3(2)
  consumer2-e76ea8c3-5d30-4299-9005-47eb41f3d3c4 /127.0.0.1      consumer2       3               topic2(1), topic3(0,1)
  consumer3-ecea43e4-1f01-479f-8349-f9130b75d8ee /127.0.0.1      consumer3       0               -
</code></pre></li><li><p>--offsets: This is the default describe option and provides the same output as the &ldquo;&ndash;describe&rdquo; option.</p></li><li><p>--state: This option provides useful group-level information.</p><pre><code>      &gt; bin/kafka-consumer-groups.sh --bootstrap-server localhost:9092 --describe --group my-group --state

  COORDINATOR (ID)          ASSIGNMENT-STRATEGY       STATE                #MEMBERS
  localhost:9092 (0)        range                     Stable               4
</code></pre></li></ul><p>To manually delete one or multiple consumer groups, the &ldquo;&ndash;delete&rdquo; option can be used:</p><pre><code>  &gt; bin/kafka-consumer-groups.sh --bootstrap-server localhost:9092 --delete --group my-group --group my-other-group

  Deletion of requested consumer groups ('my-group', 'my-other-group') was successful.
</code></pre><p>To reset offsets of a consumer group, &ldquo;&ndash;reset-offsets&rdquo; option can be used. This option supports one consumer group at the time. It requires defining following scopes: &ndash;all-topics or &ndash;topic. One scope must be selected, unless you use &lsquo;&ndash;from-file&rsquo; scenario. Also, first make sure that the consumer instances are inactive. See <a href=https://cwiki.apache.org/confluence/display/KAFKA/KIP-122%3A+Add+Reset+Consumer+Group+Offsets+tooling>KIP-122</a> for more details.</p><p>It has 3 execution options:</p><ul><li>(default) to display which offsets to reset.</li><li>--execute : to execute &ndash;reset-offsets process.</li><li>--export : to export the results to a CSV format.</li></ul><p>--reset-offsets also has following scenarios to choose from (at least one scenario must be selected):</p><ul><li>--to-datetime &lt;String: datetime> : Reset offsets to offsets from datetime. Format: &lsquo;YYYY-MM-DDTHH:mm:SS.sss&rsquo;</li><li>--to-earliest : Reset offsets to earliest offset.</li><li>--to-latest : Reset offsets to latest offset.</li><li>--shift-by &lt;Long: number-of-offsets> : Reset offsets shifting current offset by &rsquo;n&rsquo;, where &rsquo;n&rsquo; can be positive or negative.</li><li>--from-file : Reset offsets to values defined in CSV file.</li><li>--to-current : Resets offsets to current offset.</li><li>--by-duration &lt;String: duration> : Reset offsets to offset by duration from current timestamp. Format: &lsquo;PnDTnHnMnS&rsquo;</li><li>--to-offset : Reset offsets to a specific offset.</li></ul><p>Please note, that out of range offsets will be adjusted to available offset end. For example, if offset end is at 10 and offset shift request is of 15, then, offset at 10 will actually be selected.</p><p>For example, to reset offsets of a consumer group to the latest offset:</p><pre><code>  &gt; bin/kafka-consumer-groups.sh --bootstrap-server localhost:9092 --reset-offsets --group consumergroup1 --topic topic1 --to-latest

  TOPIC                          PARTITION  NEW-OFFSET
  topic1                         0          0
</code></pre><p>If you are using the old high-level consumer and storing the group metadata in ZooKeeper (i.e. <code>offsets.storage=zookeeper</code>), pass <code>--zookeeper</code> instead of <code>--bootstrap-server</code>:</p><pre><code>  &gt; bin/kafka-consumer-groups.sh --zookeeper localhost:2181 --list
</code></pre><h2 id=expanding-your-cluster>Expanding your cluster<a class=td-heading-self-link href=#expanding-your-cluster aria-label="Heading self-link"></a></h2><p>Adding servers to a Kafka cluster is easy, just assign them a unique broker id and start up Kafka on your new servers. However these new servers will not automatically be assigned any data partitions, so unless partitions are moved to them they won&rsquo;t be doing any work until new topics are created. So usually when you add machines to your cluster you will want to migrate some existing data to these machines.</p><p>The process of migrating data is manually initiated but fully automated. Under the covers what happens is that Kafka will add the new server as a follower of the partition it is migrating and allow it to fully replicate the existing data in that partition. When the new server has fully replicated the contents of this partition and joined the in-sync replica one of the existing replicas will delete their partition&rsquo;s data.</p><p>The partition reassignment tool can be used to move partitions across brokers. An ideal partition distribution would ensure even data load and partition sizes across all brokers. The partition reassignment tool does not have the capability to automatically study the data distribution in a Kafka cluster and move partitions around to attain an even load distribution. As such, the admin has to figure out which topics or partitions should be moved around.</p><p>The partition reassignment tool can run in 3 mutually exclusive modes:</p><ul><li>--generate: In this mode, given a list of topics and a list of brokers, the tool generates a candidate reassignment to move all partitions of the specified topics to the new brokers. This option merely provides a convenient way to generate a partition reassignment plan given a list of topics and target brokers.</li><li>--execute: In this mode, the tool kicks off the reassignment of partitions based on the user provided reassignment plan. (using the &ndash;reassignment-json-file option). This can either be a custom reassignment plan hand crafted by the admin or provided by using the &ndash;generate option</li><li>--verify: In this mode, the tool verifies the status of the reassignment for all partitions listed during the last &ndash;execute. The status can be either of successfully completed, failed or in progress</li></ul><h3 id=automatically-migrating-data-to-new-machines>Automatically migrating data to new machines<a class=td-heading-self-link href=#automatically-migrating-data-to-new-machines aria-label="Heading self-link"></a></h3><p>The partition reassignment tool can be used to move some topics off of the current set of brokers to the newly added brokers. This is typically useful while expanding an existing cluster since it is easier to move entire topics to the new set of brokers, than moving one partition at a time. When used to do this, the user should provide a list of topics that should be moved to the new set of brokers and a target list of new brokers. The tool then evenly distributes all partitions for the given list of topics across the new set of brokers. During this move, the replication factor of the topic is kept constant. Effectively the replicas for all partitions for the input list of topics are moved from the old set of brokers to the newly added brokers.</p><p>For instance, the following example will move all partitions for topics foo1,foo2 to the new set of brokers 5,6. At the end of this move, all partitions for topics foo1 and foo2 will <em>only</em> exist on brokers 5,6.</p><p>Since the tool accepts the input list of topics as a json file, you first need to identify the topics you want to move and create the json file as follows:</p><pre><code>  &gt; cat topics-to-move.json
  {&quot;topics&quot;: [{&quot;topic&quot;: &quot;foo1&quot;},
              {&quot;topic&quot;: &quot;foo2&quot;}],
  &quot;version&quot;:1
  }
</code></pre><p>Once the json file is ready, use the partition reassignment tool to generate a candidate assignment:</p><pre><code>  &gt; bin/kafka-reassign-partitions.sh --bootstrap-server localhost:9092 --topics-to-move-json-file topics-to-move.json --broker-list &quot;5,6&quot; --generate
  Current partition replica assignment

  {&quot;version&quot;:1,
  &quot;partitions&quot;:[{&quot;topic&quot;:&quot;foo1&quot;,&quot;partition&quot;:0,&quot;replicas&quot;:[2,1]},
                {&quot;topic&quot;:&quot;foo1&quot;,&quot;partition&quot;:1,&quot;replicas&quot;:[1,3]},
                {&quot;topic&quot;:&quot;foo1&quot;,&quot;partition&quot;:2,&quot;replicas&quot;:[3,4]},
                {&quot;topic&quot;:&quot;foo2&quot;,&quot;partition&quot;:0,&quot;replicas&quot;:[4,2]},
                {&quot;topic&quot;:&quot;foo2&quot;,&quot;partition&quot;:1,&quot;replicas&quot;:[2,1]},
                {&quot;topic&quot;:&quot;foo2&quot;,&quot;partition&quot;:2,&quot;replicas&quot;:[1,3]}]
  }

  Proposed partition reassignment configuration

  {&quot;version&quot;:1,
  &quot;partitions&quot;:[{&quot;topic&quot;:&quot;foo1&quot;,&quot;partition&quot;:0,&quot;replicas&quot;:[6,5]},
                {&quot;topic&quot;:&quot;foo1&quot;,&quot;partition&quot;:1,&quot;replicas&quot;:[5,6]},
                {&quot;topic&quot;:&quot;foo1&quot;,&quot;partition&quot;:2,&quot;replicas&quot;:[6,5]},
                {&quot;topic&quot;:&quot;foo2&quot;,&quot;partition&quot;:0,&quot;replicas&quot;:[5,6]},
                {&quot;topic&quot;:&quot;foo2&quot;,&quot;partition&quot;:1,&quot;replicas&quot;:[6,5]},
                {&quot;topic&quot;:&quot;foo2&quot;,&quot;partition&quot;:2,&quot;replicas&quot;:[5,6]}]
  }
</code></pre><p>The tool generates a candidate assignment that will move all partitions from topics foo1,foo2 to brokers 5,6. Note, however, that at this point, the partition movement has not started, it merely tells you the current assignment and the proposed new assignment. The current assignment should be saved in case you want to rollback to it. The new assignment should be saved in a json file (e.g. expand-cluster-reassignment.json) to be input to the tool with the &ndash;execute option as follows:</p><pre><code>  &gt; bin/kafka-reassign-partitions.sh --bootstrap-server localhost:9092 --reassignment-json-file expand-cluster-reassignment.json --execute
  Current partition replica assignment

  {&quot;version&quot;:1,
  &quot;partitions&quot;:[{&quot;topic&quot;:&quot;foo1&quot;,&quot;partition&quot;:0,&quot;replicas&quot;:[2,1]},
                {&quot;topic&quot;:&quot;foo1&quot;,&quot;partition&quot;:1,&quot;replicas&quot;:[1,3]},
                {&quot;topic&quot;:&quot;foo1&quot;,&quot;partition&quot;:2,&quot;replicas&quot;:[3,4]},
                {&quot;topic&quot;:&quot;foo2&quot;,&quot;partition&quot;:0,&quot;replicas&quot;:[4,2]},
                {&quot;topic&quot;:&quot;foo2&quot;,&quot;partition&quot;:1,&quot;replicas&quot;:[2,1]},
                {&quot;topic&quot;:&quot;foo2&quot;,&quot;partition&quot;:2,&quot;replicas&quot;:[1,3]}]
  }

  Save this to use as the --reassignment-json-file option during rollback
  Successfully started partition reassignments for foo1-0,foo1-1,foo1-2,foo2-0,foo2-1,foo2-2
</code></pre><p>Finally, the &ndash;verify option can be used with the tool to check the status of the partition reassignment. Note that the same expand-cluster-reassignment.json (used with the &ndash;execute option) should be used with the &ndash;verify option:</p><pre><code>  &gt; bin/kafka-reassign-partitions.sh --bootstrap-server localhost:9092 --reassignment-json-file expand-cluster-reassignment.json --verify
  Status of partition reassignment:
  Reassignment of partition [foo1,0] is completed
  Reassignment of partition [foo1,1] is still in progress
  Reassignment of partition [foo1,2] is still in progress
  Reassignment of partition [foo2,0] is completed
  Reassignment of partition [foo2,1] is completed
  Reassignment of partition [foo2,2] is completed
</code></pre><h3 id=custom-partition-assignment-and-migration>Custom partition assignment and migration<a class=td-heading-self-link href=#custom-partition-assignment-and-migration aria-label="Heading self-link"></a></h3><p>The partition reassignment tool can also be used to selectively move replicas of a partition to a specific set of brokers. When used in this manner, it is assumed that the user knows the reassignment plan and does not require the tool to generate a candidate reassignment, effectively skipping the &ndash;generate step and moving straight to the &ndash;execute step</p><p>For instance, the following example moves partition 0 of topic foo1 to brokers 5,6 and partition 1 of topic foo2 to brokers 2,3:</p><p>The first step is to hand craft the custom reassignment plan in a json file:</p><pre><code>  &gt; cat custom-reassignment.json
  {&quot;version&quot;:1,&quot;partitions&quot;:[{&quot;topic&quot;:&quot;foo1&quot;,&quot;partition&quot;:0,&quot;replicas&quot;:[5,6]},{&quot;topic&quot;:&quot;foo2&quot;,&quot;partition&quot;:1,&quot;replicas&quot;:[2,3]}]}
</code></pre><p>Then, use the json file with the &ndash;execute option to start the reassignment process:</p><pre><code>  &gt; bin/kafka-reassign-partitions.sh --bootstrap-server localhost:9092 --reassignment-json-file custom-reassignment.json --execute
  Current partition replica assignment

  {&quot;version&quot;:1,
  &quot;partitions&quot;:[{&quot;topic&quot;:&quot;foo1&quot;,&quot;partition&quot;:0,&quot;replicas&quot;:[1,2]},
                {&quot;topic&quot;:&quot;foo2&quot;,&quot;partition&quot;:1,&quot;replicas&quot;:[3,4]}]
  }

  Save this to use as the --reassignment-json-file option during rollback
  Successfully started partition reassignments for foo1-0,foo2-1
</code></pre><p>The &ndash;verify option can be used with the tool to check the status of the partition reassignment. Note that the same custom-reassignment.json (used with the &ndash;execute option) should be used with the &ndash;verify option:</p><pre><code>  &gt; bin/kafka-reassign-partitions.sh --bootstrap-server localhost:9092 --reassignment-json-file custom-reassignment.json --verify
  Status of partition reassignment:
  Reassignment of partition [foo1,0] is completed
  Reassignment of partition [foo2,1] is completed
</code></pre><h2 id=decommissioning-brokers>Decommissioning brokers<a class=td-heading-self-link href=#decommissioning-brokers aria-label="Heading self-link"></a></h2><p>The partition reassignment tool does not have the ability to automatically generate a reassignment plan for decommissioning brokers yet. As such, the admin has to come up with a reassignment plan to move the replica for all partitions hosted on the broker to be decommissioned, to the rest of the brokers. This can be relatively tedious as the reassignment needs to ensure that all the replicas are not moved from the decommissioned broker to only one other broker. To make this process effortless, we plan to add tooling support for decommissioning brokers in the future.</p><h2 id=increasing-replication-factor>Increasing replication factor<a class=td-heading-self-link href=#increasing-replication-factor aria-label="Heading self-link"></a></h2><p>Increasing the replication factor of an existing partition is easy. Just specify the extra replicas in the custom reassignment json file and use it with the &ndash;execute option to increase the replication factor of the specified partitions.</p><p>For instance, the following example increases the replication factor of partition 0 of topic foo from 1 to 3. Before increasing the replication factor, the partition&rsquo;s only replica existed on broker 5. As part of increasing the replication factor, we will add more replicas on brokers 6 and 7.</p><p>The first step is to hand craft the custom reassignment plan in a json file:</p><pre><code>  &gt; cat increase-replication-factor.json
  {&quot;version&quot;:1,
  &quot;partitions&quot;:[{&quot;topic&quot;:&quot;foo&quot;,&quot;partition&quot;:0,&quot;replicas&quot;:[5,6,7]}]}
</code></pre><p>Then, use the json file with the &ndash;execute option to start the reassignment process:</p><pre><code>  &gt; bin/kafka-reassign-partitions.sh --bootstrap-server localhost:9092 --reassignment-json-file increase-replication-factor.json --execute
  Current partition replica assignment

  {&quot;version&quot;:1,
  &quot;partitions&quot;:[{&quot;topic&quot;:&quot;foo&quot;,&quot;partition&quot;:0,&quot;replicas&quot;:[5]}]}

  Save this to use as the --reassignment-json-file option during rollback
  Successfully started partition reassignment for foo-0
</code></pre><p>The &ndash;verify option can be used with the tool to check the status of the partition reassignment. Note that the same increase-replication-factor.json (used with the &ndash;execute option) should be used with the &ndash;verify option:</p><pre><code>  &gt; bin/kafka-reassign-partitions.sh --bootstrap-server localhost:9092 --reassignment-json-file increase-replication-factor.json --verify
  Status of partition reassignment:
  Reassignment of partition [foo,0] is completed
</code></pre><p>You can also verify the increase in replication factor with the kafka-topics tool:</p><pre><code>  &gt; bin/kafka-topics.sh --bootstrap-server localhost:9092 --topic foo --describe
  Topic:foo	PartitionCount:1	ReplicationFactor:3	Configs:
    Topic: foo	Partition: 0	Leader: 5	Replicas: 5,6,7	Isr: 5,6,7
</code></pre><h2 id=limiting-bandwidth-usage-during-data-migration>Limiting Bandwidth Usage during Data Migration<a class=td-heading-self-link href=#limiting-bandwidth-usage-during-data-migration aria-label="Heading self-link"></a></h2><p>Kafka lets you apply a throttle to replication traffic, setting an upper bound on the bandwidth used to move replicas from machine to machine. This is useful when rebalancing a cluster, bootstrapping a new broker or adding or removing brokers, as it limits the impact these data-intensive operations will have on users.</p><p>There are two interfaces that can be used to engage a throttle. The simplest, and safest, is to apply a throttle when invoking the kafka-reassign-partitions.sh, but kafka-configs.sh can also be used to view and alter the throttle values directly.</p><p>So for example, if you were to execute a rebalance, with the below command, it would move partitions at no more than 50MB/s.</p><pre><code>$ bin/kafka-reassign-partitions.sh --bootstrap-server localhost:9092 --execute --reassignment-json-file bigger-cluster.json --throttle 50000000
</code></pre><p>When you execute this script you will see the throttle engage:</p><pre><code>  The inter-broker throttle limit was set to 50000000 B/s
  Successfully started partition reassignment for foo1-0
</code></pre><p>Should you wish to alter the throttle, during a rebalance, say to increase the throughput so it completes quicker, you can do this by re-running the execute command with the &ndash;additional option passing the same reassignment-json-file:</p><pre><code>$ bin/kafka-reassign-partitions.sh --bootstrap-server localhost:9092  --additional --execute --reassignment-json-file bigger-cluster.json --throttle 700000000
  The inter-broker throttle limit was set to 700000000 B/s
</code></pre><p>Once the rebalance completes the administrator can check the status of the rebalance using the &ndash;verify option. If the rebalance has completed, the throttle will be removed via the &ndash;verify command. It is important that administrators remove the throttle in a timely manner once rebalancing completes by running the command with the &ndash;verify option. Failure to do so could cause regular replication traffic to be throttled.</p><p>When the &ndash;verify option is executed, and the reassignment has completed, the script will confirm that the throttle was removed:</p><pre><code>  &gt; bin/kafka-reassign-partitions.sh --bootstrap-server localhost:9092  --verify --reassignment-json-file bigger-cluster.json
  Status of partition reassignment:
  Reassignment of partition [my-topic,1] is completed
  Reassignment of partition [my-topic,0] is completed

  Clearing broker-level throttles on brokers 1,2,3
  Clearing topic-level throttles on topic my-topic
</code></pre><p>The administrator can also validate the assigned configs using the kafka-configs.sh. There are two pairs of throttle configuration used to manage the throttling process. First pair refers to the throttle value itself. This is configured, at a broker level, using the dynamic properties:</p><pre><code>    leader.replication.throttled.rate
    follower.replication.throttled.rate
</code></pre><p>Then there is the configuration pair of enumerated sets of throttled replicas:</p><pre><code>    leader.replication.throttled.replicas
    follower.replication.throttled.replicas
</code></pre><p>Which are configured per topic.</p><p>All four config values are automatically assigned by kafka-reassign-partitions.sh (discussed below).</p><p>To view the throttle limit configuration:</p><pre><code>  &gt; bin/kafka-configs.sh --describe --bootstrap-server localhost:9092 --entity-type brokers
  Configs for brokers '2' are leader.replication.throttled.rate=700000000,follower.replication.throttled.rate=700000000
  Configs for brokers '1' are leader.replication.throttled.rate=700000000,follower.replication.throttled.rate=700000000
</code></pre><p>This shows the throttle applied to both leader and follower side of the replication protocol. By default both sides are assigned the same throttled throughput value.</p><p>To view the list of throttled replicas:</p><pre><code>  &gt; bin/kafka-configs.sh --describe --bootstrap-server localhost:9092 --entity-type topics
  Configs for topic 'my-topic' are leader.replication.throttled.replicas=1:102,0:101,
      follower.replication.throttled.replicas=1:101,0:102
</code></pre><p>Here we see the leader throttle is applied to partition 1 on broker 102 and partition 0 on broker 101. Likewise the follower throttle is applied to partition 1 on broker 101 and partition 0 on broker 102.</p><p>By default kafka-reassign-partitions.sh will apply the leader throttle to all replicas that exist before the rebalance, any one of which might be leader. It will apply the follower throttle to all move destinations. So if there is a partition with replicas on brokers 101,102, being reassigned to 102,103, a leader throttle, for that partition, would be applied to 101,102 and a follower throttle would be applied to 103 only.</p><p>If required, you can also use the &ndash;alter switch on kafka-configs.sh to alter the throttle configurations manually.</p><h3 id=safe-usage-of-throttled-replication>Safe usage of throttled replication<a class=td-heading-self-link href=#safe-usage-of-throttled-replication aria-label="Heading self-link"></a></h3><p>Some care should be taken when using throttled replication. In particular:</p><p><em>(1) Throttle Removal:</em></p><p>The throttle should be removed in a timely manner once reassignment completes (by running kafka-reassign-partitions.sh --verify).</p><p><em>(2) Ensuring Progress:</em></p><p>If the throttle is set too low, in comparison to the incoming write rate, it is possible for replication to not make progress. This occurs when:</p><pre><code>max(BytesInPerSec) &gt; throttle
</code></pre><p>Where BytesInPerSec is the metric that monitors the write throughput of producers into each broker.</p><p>The administrator can monitor whether replication is making progress, during the rebalance, using the metric:</p><pre><code>kafka.server:type=FetcherLagMetrics,name=ConsumerLag,clientId=([-.\\w]+),topic=([-.\\w]+),partition=([0-9]+)
</code></pre><p>The lag should constantly decrease during replication. If the metric does not decrease the administrator should increase the throttle throughput as described above.</p><h2 id=setting-quotas>Setting quotas<a class=td-heading-self-link href=#setting-quotas aria-label="Heading self-link"></a></h2><p>Quotas overrides and defaults may be configured at (user, client-id), user or client-id levels as described here. By default, clients receive an unlimited quota. It is possible to set custom quotas for each (user, client-id), user or client-id group.</p><p>Configure custom quota for (user=user1, client-id=clientA):</p><pre><code>  &gt; bin/kafka-configs.sh  --bootstrap-server localhost:9092 --alter --add-config 'producer_byte_rate=1024,consumer_byte_rate=2048,request_percentage=200' --entity-type users --entity-name user1 --entity-type clients --entity-name clientA
  Updated config for entity: user-principal 'user1', client-id 'clientA'.
</code></pre><p>Configure custom quota for user=user1:</p><pre><code>  &gt; bin/kafka-configs.sh  --bootstrap-server localhost:9092 --alter --add-config 'producer_byte_rate=1024,consumer_byte_rate=2048,request_percentage=200' --entity-type users --entity-name user1
  Updated config for entity: user-principal 'user1'.
</code></pre><p>Configure custom quota for client-id=clientA:</p><pre><code>  &gt; bin/kafka-configs.sh  --bootstrap-server localhost:9092 --alter --add-config 'producer_byte_rate=1024,consumer_byte_rate=2048,request_percentage=200' --entity-type clients --entity-name clientA
  Updated config for entity: client-id 'clientA'.
</code></pre><p>It is possible to set default quotas for each (user, client-id), user or client-id group by specifying <em>--entity-default</em> option instead of <em>--entity-name</em>.</p><p>Configure default client-id quota for user=userA:</p><pre><code>  &gt; bin/kafka-configs.sh  --bootstrap-server localhost:9092 --alter --add-config 'producer_byte_rate=1024,consumer_byte_rate=2048,request_percentage=200' --entity-type users --entity-name user1 --entity-type clients --entity-default
  Updated config for entity: user-principal 'user1', default client-id.
</code></pre><p>Configure default quota for user:</p><pre><code>  &gt; bin/kafka-configs.sh  --bootstrap-server localhost:9092 --alter --add-config 'producer_byte_rate=1024,consumer_byte_rate=2048,request_percentage=200' --entity-type users --entity-default
  Updated config for entity: default user-principal.
</code></pre><p>Configure default quota for client-id:</p><pre><code>  &gt; bin/kafka-configs.sh  --bootstrap-server localhost:9092 --alter --add-config 'producer_byte_rate=1024,consumer_byte_rate=2048,request_percentage=200' --entity-type clients --entity-default
  Updated config for entity: default client-id.
</code></pre><p>Here&rsquo;s how to describe the quota for a given (user, client-id):</p><pre><code>  &gt; bin/kafka-configs.sh  --bootstrap-server localhost:9092 --describe --entity-type users --entity-name user1 --entity-type clients --entity-name clientA
  Configs for user-principal 'user1', client-id 'clientA' are producer_byte_rate=1024,consumer_byte_rate=2048,request_percentage=200
</code></pre><p>Describe quota for a given user:</p><pre><code>  &gt; bin/kafka-configs.sh  --bootstrap-server localhost:9092 --describe --entity-type users --entity-name user1
  Configs for user-principal 'user1' are producer_byte_rate=1024,consumer_byte_rate=2048,request_percentage=200
</code></pre><p>Describe quota for a given client-id:</p><pre><code>  &gt; bin/kafka-configs.sh  --bootstrap-server localhost:9092 --describe --entity-type clients --entity-name clientA
  Configs for client-id 'clientA' are producer_byte_rate=1024,consumer_byte_rate=2048,request_percentage=200
</code></pre><p>If entity name is not specified, all entities of the specified type are described. For example, describe all users:</p><pre><code>  &gt; bin/kafka-configs.sh  --bootstrap-server localhost:9092 --describe --entity-type users
  Configs for user-principal 'user1' are producer_byte_rate=1024,consumer_byte_rate=2048,request_percentage=200
  Configs for default user-principal are producer_byte_rate=1024,consumer_byte_rate=2048,request_percentage=200
</code></pre><p>Similarly for (user, client):</p><pre><code>  &gt; bin/kafka-configs.sh  --bootstrap-server localhost:9092 --describe --entity-type users --entity-type clients
  Configs for user-principal 'user1', default client-id are producer_byte_rate=1024,consumer_byte_rate=2048,request_percentage=200
  Configs for user-principal 'user1', client-id 'clientA' are producer_byte_rate=1024,consumer_byte_rate=2048,request_percentage=200
</code></pre><style>.feedback--answer{display:inline-block}.feedback--answer-no{margin-left:1em}.feedback--response{display:none;margin-top:1em}.feedback--response__visible{display:block}</style><div class=d-print-none><h2 class=feedback--title>Feedback</h2><p class=feedback--question>Was this page helpful?</p><button class="btn btn-primary mb-4 feedback--answer feedback--answer-yes">Yes</button>
<button class="btn btn-primary mb-4 feedback--answer feedback--answer-no">No</button><p class="feedback--response feedback--response-yes">Glad to hear it! Please <a href=https://github.com/USERNAME/REPOSITORY/issues/new>tell us how we can improve</a>.</p><p class="feedback--response feedback--response-no">Sorry to hear that. Please <a href=https://github.com/USERNAME/REPOSITORY/issues/new>tell us how we can improve</a>.</p></div><script>const yesButton=document.querySelector(".feedback--answer-yes"),noButton=document.querySelector(".feedback--answer-no"),yesResponse=document.querySelector(".feedback--response-yes"),noResponse=document.querySelector(".feedback--response-no"),disableButtons=()=>{yesButton.disabled=!0,noButton.disabled=!0},sendFeedback=e=>{if(typeof gtag!="function")return;gtag("event","page_helpful",{event_category:"Helpful",event_label:window.location.pathname,value:e})};yesButton.addEventListener("click",()=>{yesResponse.classList.add("feedback--response__visible"),disableButtons(),sendFeedback(100)}),noButton.addEventListener("click",()=>{noResponse.classList.add("feedback--response__visible"),disableButtons(),sendFeedback(0)})</script><br><div class=td-page-meta__lastmod>Last modified January 3, 2025: <a href=https://github.com/apache/kafka-site//commit/b4639af2bf30cedb703fa2d7d054cf6ded963ae7>Documentation for all releases generated by ak2md automation (b4639af2)</a></div></div></main></div></div><footer class="td-footer row d-print-none"><div class=container-fluid><div class="row mx-md-2"><div class="td-footer__left col-6 col-sm-4 order-sm-1"><ul class=td-footer__links-list><li class=td-footer__links-item data-bs-toggle=tooltip title=Contact aria-label=Contact><a target=_blank rel=noopener href=/community/contact/ aria-label=Contact><i class="fa fa-envelope"></i></a></li><li class=td-footer__links-item data-bs-toggle=tooltip title=Twitter aria-label=Twitter><a target=_blank rel=noopener href=https://twitter.com/apachekafka aria-label=Twitter><i class="fab fa-twitter"></i></a></li><li class=td-footer__links-item data-bs-toggle=tooltip title="Stack Overflow" aria-label="Stack Overflow"><a target=_blank rel=noopener href=https://stackoverflow.com/questions/tagged/apache-kafka aria-label="Stack Overflow"><i class="fab fa-stack-overflow"></i></a></li></ul></div><div class="td-footer__right col-6 col-sm-4 order-sm-3"><ul class=td-footer__links-list><li class=td-footer__links-item data-bs-toggle=tooltip title=GitHub aria-label=GitHub><a target=_blank rel=noopener href=https://github.com/apache/kafka aria-label=GitHub><i class="fab fa-github"></i></a></li><li class=td-footer__links-item data-bs-toggle=tooltip title="Developer mailing list" aria-label="Developer mailing list"><a target=_blank rel=noopener href=mailto:dev@kafka.apache.org aria-label="Developer mailing list"><i class="fa fa-envelope"></i></a></li></ul></div><div class="td-footer__center col-12 col-sm-4 py-2 order-sm-2"><span class=td-footer__copyright>&copy;
2014&ndash;2025
<span class=td-footer__authors>By <a href=https://www.apache.org/>Apache Software Foundation</a> under the terms of the <a href=https://www.apache.org/licenses/LICENSE-2.0>Apache License v2</a></span></span><span class=td-footer__all_rights_reserved>All Rights Reserved</span><span class=ms-2><a href=https://privacy.apache.org/policies/privacy-policy-public.html target=_blank rel=noopener>Privacy Policy</a></span></div></div></div></footer></div><script src=/js/main.min.dc2c0119076a0df855e55a8044ce0de74b7b9033c20e853e22d7ec7e9bdde965.js integrity="sha256-3CwBGQdqDfhV5VqARM4N50t7kDPCDoU+Itfsfpvd6WU=" crossorigin=anonymous></script><script defer src=/js/click-to-copy.min.73478a7d4807698aed7e355eb23f9890ca18fea3158604c8471746d046702bad.js integrity="sha256-c0eKfUgHaYrtfjVesj+YkMoY/qMVhgTIRxdG0EZwK60=" crossorigin=anonymous></script><script src=/js/tabpane-persist.js></script></body></html>